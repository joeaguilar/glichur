/*! videoglitcher -v1.0.0-Glitches video using canvas and socket.io -2016-03-18 */
function blendsCode(){"use strict";function a(){var a=new Uint8Array([255,0]);return 255===new Uint16Array(a,a.buffer)[0]}function b(a){var b={};return b.r=parseInt(a.slice(4,6),16),b.g=parseInt(a.slice(2,4),16),b.b=parseInt(a.slice(0,2),16),b}function c(a){if(0===a.length)return new Uint8Array(4);if(4===a.length)return a;for(var b=new Uint8Array(4),c=0,d=0,e=0,f=0,g=0;g<a.length;g+=4)c+=a[g],d+=a[g+1],e+=a[g+2],f+=a[g+3];return b[0]=c/(a.length/4)>>>0,b[1]=d/(a.length/4)>>>0,b[2]=e/(a.length/4)>>>0,b[3]=f/(a.length/4)>>>0,b}function d(a){var b,c,d,e;return b=255&a,c=a>>8&255,d=a>>16&255,e=b,c>e&&(e=c),d>e&&(e=d),e}function e(a){var b,c,d,e;return d=a>>8&255,c=a>>16&255,b=a>>24&255,e=b,c>e&&(e=c),d>e&&(e=d),e}var f=f||{};return f.copy=function(a,b,c){for(var d=0,e=a.length;e>d;++d)b[d]=a[d]},f.crunch=function(a,b,c){for(var d=c.threshold||50,e=4*d,f=0,g=b.length;g>f;f++)f&e?b[f]=b[f]:b[f]=a[f]},f.voijami=function(a,b,c){function d(){this.chain=[],this.oldChain=[],this._ether=100,Object.defineProperty(this,"ether",{get:function(){return this._ether=this._ether-1,this._ether},set:function(a){this._ether=this._ether+a}})}var e=(c.color||{r:0,g:0,b:0},c.swing||{r:0,g:0,b:0},parseInt(c.threshold)||40),f=c.height,g=c.width;d.prototype.spin=function(){return this._ether>10&&this.oldChain.length>0?(this._ether--,this.oldChain.shift()):-1},d.prototype.chagrox=function(a,b,c,d){var a=a||10,c=c||0,d=d||0,e=[];this._ether=a*a;for(var f=0;a>f;f++)for(var g=0;a>g;g++){var h=f*a*4+4*g,i=c*a*4+4*d;e[h+0]=b[i+0],e[h+1]=b[i+1],e[h+2]=b[i+2]}this.chain=e};for(var h=new d,i=0;f>i;i++)for(var j=0;g>j;j++){var k=i*g*4+4*j;h.ether<25&&h.chagrox(h.ether-10,a,i,j);var l=[];b[k+0]=(h.ether<e&&(l[0]=h.spin()),l>-1?l[0]:a[k+0]),b[k+1]=(h.ether<e&&(l[1]=h.spin()),l>-1?l[1]:a[k+1]),b[k+2]=(h.ether<e&&(l[2]=h.spin()),l>-1?l[2]:a[k+2])}},f.mastervoijami=function(a,b,c){for(var d,e,f,g,h=c.height,i=c.width,j=c.xspace||10,k=c.yspace||1,l=c.weight||5,m=c.stroke||5,n=new Uint32Array(a.buffer),o=new Uint32Array(b.buffer),d=0;h>d;d+=j)for(var e=0;i>e;e+=k){var p=d*i+e,q=n[p];o[p]=q;for(var f=0;l>f;f++)for(var g=0;m>g;g++)o[p+i*f+g]=q}},f.voijamileft=function(a,b,c){for(var d=c.height,e=c.width,f=c.threshold||4,g=4*f,h=0;d>h;h++)if(!(h&g))for(var i=0;e>i;i++){var j=4*(h*e+i);b[j+0]=a[j+0],b[j+1]=a[j+1],b[j+2]=a[j+2],b[j+3]=a[j+3]}},f.voijamiup=function(a,b,c){for(var d=c.height,e=c.width,f=c.threshold||4,g=4*f,h=0;e>h;h++)if(!(h&g))for(var i=0;d>i;i++){var j=4*(i*e+h);b[j]=a[j],b[j+1]=a[j+1],b[j+2]=a[j+2],b[j+3]=a[j+3]}},f.voijamisizzle=function(a,b,c){for(var d=c.height,e=c.width,f=c.threshold||4,g=4*f,h=0;d>h;h++)if(!(h&g))for(var i=0;e>i;i++){var j=4*(i*d+h);b[j]=a[j],b[j+1]=a[j+1],b[j+2]=a[j+2],b[j+3]=a[j+3]}},f.fastervoijami=function(a,b,c,d){for(var e=c.threshold||50,f=(c.height,c.width,c.numel||4),g=e*f,h=0,i=a.length;i>h;h++)if(h&g)b[h]=a[h];else{if(h%4===0)continue;b[h]=0}},f.strangevoijamisizzle=function(a,b,c,d){for(var e=c.height,f=c.width,g=c.threshold||4,h=4*g,i=0;e>i;++i)if(!(i&h))for(var j=0;f>j;++j){var k=4*(j*e+i);b[k]=a[k],b[k+1]=a[k+1],b[k+2]=a[k+2],b[k+3]=255}},f.inversevoijami=function(a,b,c,d){for(var e=c.height,f=c.width,g=c.threshold||4,h=new Uint32Array(a.buffer),i=new Uint32Array(b.buffer),j=g,k=0;f>k;k++)if(0!=(k&j))for(var l=0;e>l;l++){var m=l*f+k;i[m]=h[m]}},f.strangevoijami=function(a,b,c,d){for(var e=c.height,f=c.width,g=c.threshold||4,h=new Uint32Array(a.buffer),i=new Uint32Array(b.buffer),j=g,k=0;f>k;k++)if(!(k&j))for(var l=0;e>l;l++){var m=k*f+l;i[m]=h[m]}},f.strangevoijamileft=function(a,b,c,d){for(var e=c.height,f=c.width,g=c.threshold||4,h=new Uint32Array(a.buffer),i=new Uint32Array(b.buffer),j=g,k=0;e>k;k++)if(!(k&j))for(var l=0;f>l;l++){var m=k*f+l;i[m]=h[m]}},f.commin_etra=function(b,c,f){function g(a,b,c,d,e){var f=Number(a),g=Number(c),h=Number(b),i=Number(d),j=Math.abs(g-f),k=Math.abs(i-h),l=g>f?1:-1,n=i>h?1:-1,o=j-k,q=0,s=f*m+h;r[s]=e;for(var t=0;p>t;t++)r[s+m*t]=e;for(;f!=g||h!=i;){var u=o<<1;if(q>100)break;u>-k&&(o-=k,f+=l),j>u&&(o+=j,h+=n),q++,s=f*m*h;for(var t=0;p>t;t++)r[s+m*t]=e}}var h,i,j,k,l=f.height,m=f.width,n=f.xspace||10,o=f.yspace||1,p=f.weight||5,q=f.depth||.9,r=new Uint32Array(c.buffer),s=new Uint32Array(b.buffer),t=[],u=0,v=0;if(a())for(var h=0;l>h;h+=n)for(var i=0;m>i;i+=o){var w=h*m+i,x=s[w],y=d(x);t.push([h,i,Math.abs(parseInt(q*y/25,10)),x])}else for(var h=0;l>h;h+=n)for(var i=0;m>i;i+=o){var w=h*m+i,x=s[w],y=e(x);t.push([h,i,Math.abs(parseInt(q*y/25,10)),x])}for(var z=0,A=t.length;A>z;z++){var B=t[z],h=B[0],i=B[1],C=B[2],D=B[3],E=parseInt(C/2,10);j=h+E,k=i,g(u,v,j,k,D),u=j,v=k}},f.mendalpha=function(c,d,e){var f=b(e.color),g=f.r||255,h=f.g||255,i=f.b||255,j=new Uint32Array(c.buffer),k=new Uint32Array(d.buffer),l=j.length,m=a();if(m)for(var n=0;l>n;n++){var o=j[n],p=o>>24&255;255>p&&(k[n]=255<<24|i<<16|h<<8|g)}else for(var n=0;l>n;n++){var o=j[n],p=255&o;255>p&&(k[n]=g<<24|h<<16|i<<8|255)}},f.blend_source_add=function(a,b,c){for(var d=new Uint8ClampedArray(b.buffer),e=0,f=1,g=(c.height,c.height-1);g>f;e++,f++)for(var h=0,i=1,j=c.width,k=c.width-1;k>i;h++,i++){for(var l=4*(f*j+i),m=9,n=3,o=0,p=0,q=0,r=0;n>r;++r)for(var s=0;n>s;++s){var t=(e+r)*j+4*(h+s);o+=a[t]-b[t],p+=a[t+1]-b[t+1],q+=a[t+2]-b[t+2]}d[l]=a[l]+Math.round(o/m),d[l+1]=a[l+1]+Math.round(p/m),d[l+2]=a[l+2]+Math.round(q/m)}},f.blend_source_subtract=function(a,b,c){for(var d=new Uint8ClampedArray(b.buffer),e=0,f=1,g=(c.height,c.height-1);g>f;e++,f++)for(var h=0,i=1,j=c.width,k=c.width-1;k>i;h++,i++){for(var l=4*(f*j+i),m=9,n=3,o=0,p=0,q=0,r=0;n>r;++r)for(var s=0;n>s;++s){var t=(e+r)*j+4*(h+s);o+=a[t]-b[t],p+=a[t+1]-b[t+1],q+=a[t+2]-b[t+2]}d[l]=a[l]-Math.round(o/m),d[l+1]=a[l+1]-Math.round(p/m),d[l+2]=a[l+2]-Math.round(q/m)}},f.digifire=function(a,b,c){for(var d=new Uint8ClampedArray(b.buffer),e=0,f=1,g=(c.height,c.height-1);g>f;e++,f++)for(var h=0,i=1,j=c.width,k=c.width-1;k>i;h++,i++){for(var l=4*(f*j+i),m=9,n=3,o=0,p=0,q=0,r=0;n>r;++r)for(var s=0;n>s;++s){var t=(e+r)*j+4*(h+s);o+=a[t]-b[t],p+=a[t+1]-b[t+1],q+=a[t+2]-b[t+2]}d[l]=b[l]+Math.round(o/m),d[l+1]=b[l+1]+Math.round(p/m),d[l+2]=b[l+2]+Math.round(q/m)}},f.digiice=function(a,b,c){for(var d=new Uint8ClampedArray(b.buffer),e=0,f=1,g=(c.height,c.height-1);g>f;e++,f++)for(var h=0,i=1,j=c.width,k=c.width-1;k>i;h++,i++){for(var l=4*(f*j+i),m=9,n=3,o=0,p=0,q=0,r=0;n>r;++r)for(var s=0;n>s;++s){var t=(e+r)*j+4*(h+s);o+=a[t]-b[t],p+=a[t+1]-b[t+1],q+=a[t+2]-b[t+2]}d[l]=b[l]-Math.round(o/m),d[l+1]=b[l+1]-Math.round(p/m),d[l+2]=b[l+2]-Math.round(q/m)}},f.contrast_point=function(a,b,c){for(var d,e,f,g=new Uint8ClampedArray(b.buffer),h=Math.log(255),i=0,j=1,k=(c.height,c.height-1);k>j;i++,j++)for(var l=0,m=1,n=c.width,o=c.width-1;o>m;l++,m++){for(var p=4*(j*n+m),q=9,r=3,s=0,t=0,u=0,v=0;r>v;++v)for(var w=0;r>w;++w){var x=(i+v)*n+4*(l+w);s+=a[x]-b[x],t+=a[x+1]-b[x+1],u+=a[x+2]-b[x+2]}d=b[p+0]+s/q,e=b[p+1]+t/q,f=b[p+2]+u/q,g[p]=Math.round(a[p]*Math.log(d)/h),g[p+1]=Math.round(a[p+1]*Math.log(d)/h),g[p+2]=Math.round(a[p+2]*Math.log(d)/h)}},f.black_point=function(a,b,c){for(var d,e,f,g=new Uint8ClampedArray(b.buffer),h=Math.log(255),i=0,j=1,k=(c.height,c.height-1);k>j;i++,j++)for(var l=0,m=1,n=c.width,o=c.width-1;o>m;l++,m++){for(var p=4*(j*n+m),q=9,r=3,s=0,t=0,u=0,v=0;r>v;++v)for(var w=0;r>w;++w){var x=(i+v)*n+4*(l+w);s+=a[x]-b[x],t+=a[x+1]-b[x+1],u+=a[x+2]-b[x+2]}d=b[p+0]-s/q,e=b[p+1]-t/q,f=b[p+2]-u/q,g[p]=Math.round(a[p]*Math.log(d)/h),g[p+1]=Math.round(a[p+1]*Math.log(d)/h),g[p+2]=Math.round(a[p+2]*Math.log(d)/h)}},f.streak_1995_add=function(a,b,c){for(var d=0,e=1,f=(c.height,c.height-1);f>e;d++,e++)for(var g=0,h=1,i=c.width,j=c.width-1;j>h;g++,h++){for(var k=4*(e*i+h),l=9,m=3,n=0,o=0,p=0,q=0;m>q;++q)for(var r=0;m>r;++r){var s=(d+q)*i+4*(g+r);n+=a[s]-b[s],o+=a[s+1]-b[s+1],p+=a[s+2]-b[s+2]}b[k]=a[k]+Math.round(n/l),b[k+1]=a[k+1]+Math.round(o/l),b[k+2]=a[k+2]+Math.round(p/l)}},f.blend_1995_subtract=function(a,b,c){for(var d=0,e=1,f=(c.height,c.height-1);f>e;d++,e++)for(var g=0,h=1,i=c.width,j=c.width-1;j>h;g++,h++){for(var k=4*(e*i+h),l=9,m=3,n=0,o=0,p=0,q=0;m>q;++q)for(var r=0;m>r;++r){var s=(d+q)*i+4*(g+r);n+=a[s]-b[s],o+=a[s+1]-b[s+1],p+=a[s+2]-b[s+2]}b[k]=a[k]-Math.round(n/l),b[k+1]=a[k+1]-Math.round(o/l),b[k+2]=a[k+2]-Math.round(p/l)}},f.streak_1995_add=function(a,b,c){for(var d=0,e=1,f=(c.height,c.height-1);f>e;d++,e++)for(var g=0,h=1,i=c.width,j=c.width-1;j>h;g++,h++){for(var k=4*(e*i+h),l=9,m=3,n=0,o=0,p=0,q=0;m>q;++q)for(var r=0;m>r;++r){var s=(d+q)*i+4*(g+r);n+=a[s]-b[s],o+=a[s+1]-b[s+1],p+=a[s+2]-b[s+2]}b[k]=b[k]+Math.round(n/l),b[k+1]=b[k+1]+Math.round(o/l),b[k+2]=b[k+2]+Math.round(p/l)}},f.streak_1995_subtract=function(a,b,c){for(var d=0,e=1,f=(c.height,c.height-1);f>e;d++,e++)for(var g=0,h=1,i=c.width,j=c.width-1;j>h;g++,h++){for(var k=4*(e*i+h),l=9,m=3,n=0,o=0,p=0,q=0;m>q;++q)for(var r=0;m>r;++r){var s=(d+q)*i+4*(g+r);n+=a[s]-b[s],o+=a[s+1]-b[s+1],p+=a[s+2]-b[s+2]}b[k]=b[k]-Math.round(n/l),b[k+1]=b[k+1]-Math.round(o/l),b[k+2]=b[k+2]-Math.round(p/l)}},f.releif_blend=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,e=0;h>e;e++)for(var f=0;g>f;f++){var i=4*(e*g+f),j=4*((e+1)*g+(f+1)),k=Math.round((a[i]+b[i])/2),l=Math.round((a[i+1]+b[i+1])/2),m=Math.round((a[i+2]+b[i+2])/2);b[i]=k+(127.5-a[j]),b[i+1]=l+(127.5-a[j+1]),b[i+2]=m+(127.5-a[j+2]),b[i+3]=255}},f.archez_mix_clamped=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,i=new Uint8ClampedArray(b.buffer),e=0;g>e;e++)for(var f=0;h>f;f++){var j=4*(e*h+f),k=a[j],l=k*Math.abs(f%Math.sin(e))>10?0:255;i[j]=l-b[j],i[j+1]=l-b[j+1],i[j+2]=l-b[j+2],i[j+3]=255}},f.archez_mix_overflow=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,e=0;g>e;e++)for(var f=0;h>f;f++){var i=4*(e*h+f),j=a[i],k=j*Math.abs(f%Math.sin(e))>10?0:255;b[i]=k-b[i],b[i+1]=k-b[i+1],b[i+2]=k-b[i+2],b[i+3]=255}},f.contrast_blend_sub_dest=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,e=0;g>e;e++)for(var f=0;h>f;f++){var i=4*(e*h+f);b[i]=Math.round(Math.atan(e-g,f-h)*a[i]/360)-b[i],b[i+1]=Math.round(Math.atan(e-g,f-h)*a[i+1]/360)-b[i+1],b[i+2]=Math.round(Math.atan(e-g,f-h)*a[i+2]/360)-b[i+2],b[i+3]=255}},f.contrast_blend_add_dest=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,e=0;g>e;e++)for(var f=0;h>f;f++){var i=4*(e*h+f);b[i]=Math.round(Math.atan(e-g,f-h)*a[i]/360)+b[i],b[i+1]=Math.round(Math.atan(e-g,f-h)*a[i+1]/360)+b[i+1],b[i+2]=Math.round(Math.atan(e-g,f-h)*a[i+2]/360)+b[i+2],b[i+3]=255}},f.contrast_blend_clamped_add_dest=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,i=new Uint8ClampedArray(b.buffer),e=0;g>e;e++)for(var f=0;h>f;f++){var j=4*(e*h+f);i[j]=Math.round(Math.atan(e-g,f-h)*a[j]/360)+b[j],i[j+1]=Math.round(Math.atan(e-g,f-h)*a[j+1]/360)+b[j+1],i[j+2]=Math.round(Math.atan(e-g,f-h)*a[j+2]/360)+b[j+2],i[j+3]=255}},f.contrast_blend_sub_src=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,e=0;g>e;e++)for(var f=0;h>f;f++){var i=4*(e*h+f);b[i]=Math.round(Math.atan(e-g,f-h)*a[i]/360)-a[i],b[i+1]=Math.round(Math.atan(e-g,f-h)*a[i+1]/360)-a[i+1],b[i+2]=Math.round(Math.atan(e-g,f-h)*a[i+2]/360)-a[i+2],b[i+3]=255}},f.contrast_blend_add_src=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,e=0;g>e;e++)for(var f=0;h>f;f++){var i=4*(e*h+f);b[i]=Math.round(Math.atan(e-g,f-h)*a[i]/360)+a[i],b[i+1]=Math.round(Math.atan(e-g,f-h)*a[i+1]/360)+a[i+1],b[i+2]=Math.round(Math.atan(e-g,f-h)*a[i+2]/360)+a[i+2],b[i+3]=255}},f.contrast_blend_clamped_add_src=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,i=new Uint8ClampedArray(b.buffer),e=0;g>e;e++)for(var f=0;h>f;f++){var j=4*(e*h+f);i[j]=Math.round(Math.atan(e-g,f-h)*a[j]/360)+a[j],i[j+1]=Math.round(Math.atan(e-g,f-h)*a[j+1]/360)+a[j+1],i[j+2]=Math.round(Math.atan(e-g,f-h)*a[j+2]/360)+a[j+2],i[j+3]=255}},f.shifter=function(a,b,c){function d(a,b){return a+4*b}function e(c,e,f){function g(b,c,e,f){var g=a[d(b,c)+e]?a[d(b,c)+e]*h:f*h;return g}var i=c.r+c.g+c.b;i>f.clip[0]?(b[e]=g(e,f.swing[0],f.thresh[0],f.def[0]),b[e+1]=g(e,f.swing[1],f.thresh[1],f.def[0]),b[e+2]=g(e,f.swing[2],f.thresh[2],f.def[0]),b[e+3]=255):i>f.clip[1]?(b[e]=g(e,f.swing[3],f.thresh[3],f.def[1]),b[e+1]=g(e,f.swing[4],f.thresh[4],f.def[1]),b[e+2]=g(e,f.swing[5],f.thresh[5],f.def[1]),b[e+3]=255):i>f.clip[2]?(b[e]=g(e,f.swing[6],f.thresh[6],f.def[2]),b[e+1]=g(e,f.swing[7],f.thresh[7],f.def[2]),b[e+2]=g(e,f.swing[8],f.thresh[8],f.def[2]),b[e+3]=255):(b[e]=g(e,f.swing[9],f.thresh[9],f.def[3]),b[e+1]=g(e,f.swing[10],f.thresh[10],f.def[3]),b[e+2]=g(e,f.swing[11],f.thresh[11],f.def[3]),b[e+3]=255)}var f=c.height,g=c.width,h=c.depth,i={thresh:[0,1,2,0,1,2,0,1,2,0,1,2],swing:[5,5,5,5,5,5,10,10,10,10,10,10],clip:[150,300,500],def:[100,200,15,15]},j=0,k=0;for(j=0;f>j;++j)for(k=0;g>k;++k){var l=4*(j*g+k),m={r:a[l],g:a[l+1],b:a[l+2],a:a[l+3]};e(m,l,i),b[l+0]=(b[l+0]+m.r)/2,b[l+1]=(b[l+1]+m.g)/2,b[l+2]=(b[l+2]+m.b)/2,b[l+3]=255}},f.swingdistortfuzz=function(a,b,c){function d(a,b){return a+4*b}function e(c,e,g){function h(b,c,e,g){var h=a[d(b,c)+e]?a[d(b,c)+e]*f:g*f;return h}var i=c.r+c.g+c.b;i>g.clip[0]?(b[e]=h(e,g.swing[0],g.thresh[0],g.def[0]),b[e+1]=h(e,g.swing[1],g.thresh[1],g.def[0]),b[e+2]=h(e,g.swing[2],g.thresh[2],g.def[0]),b[e+3]=255):i>g.clip[1]?(b[e]=h(e,g.swing[3],g.thresh[3],g.def[1]),b[e+1]=h(e,g.swing[4],g.thresh[4],g.def[1]),b[e+2]=h(e,g.swing[5],g.thresh[5],g.def[1]),b[e+3]=255):i>g.clip[2]?(b[e]=h(e,g.swing[6],g.thresh[6],g.def[2]),b[e+1]=h(e,g.swing[7],g.thresh[7],g.def[2]),b[e+2]=h(e,g.swing[8],g.thresh[8],g.def[2]),b[e+3]=255):(b[e]=h(e,g.swing[9],g.thresh[9],g.def[3]),b[e+1]=h(e,g.swing[10],g.thresh[10],g.def[3]),b[e+2]=h(e,g.swing[11],g.thresh[11],g.def[3]),b[e+3]=255)}for(var f=c.depth||1,g=c.height,h=c.width,i={thresh:[0,1,2,0,1,2,0,1,2,0,1,2],swing:[5,5,5,10,10,10,-10,-10,-10,-5,-5,-5],clip:[150,300,500],def:[150,150,150,150]},j=0,k=0,l=Math.floor(g/2),j=0;g>j;j++){if(l>j)var m=l+j,n=l+2*j,o=l+3*j,p=l+4*j;else var m=l-j,n=l-j/2,o=l-j/3,p=l-j/4;i.swing[0]=i.swing[1]=i.swing[2]=m,i.swing[3]=i.swing[4]=i.swing[5]=n,i.swing[6]=i.swing[7]=i.swing[8]=o,i.swing[9]=i.swing[10]=i.swing[11]=p;for(var k=0;h>k;k++){var q=4*(j*h+k),r={r:a[q],g:a[q+1],b:a[q+2],a:a[q+3]};e(r,q,i),b[q+0]=(b[q+0]+r.r)/2,b[q+1]=(b[q+1]+r.g)/2,b[q+2]=(b[q+2]+r.b)/2,b[q+3]=255}}},f.slish=function(a,b,c){function d(a,b){return a+4*b}function e(c,e,g){function h(b,c,e,g){var h=a[d(b,c)+e]?a[d(b,c)+e]*f:g*f;return h}var i=c.r+c.g+c.b;i>g.clip[0]?(b[e]=h(e,g.swing[0],g.thresh[0],g.def[0]),b[e+1]=h(e,g.swing[1],g.thresh[1],g.def[0]),b[e+2]=h(e,g.swing[2],g.thresh[2],g.def[0]),b[e+3]=255):i>g.clip[1]?(b[e]=h(e,g.swing[3],g.thresh[3],g.def[1]),b[e+1]=h(e,g.swing[4],g.thresh[4],g.def[1]),b[e+2]=h(e,g.swing[5],g.thresh[5],g.def[1]),b[e+3]=255):i>g.clip[2]?(b[e]=h(e,g.swing[6],g.thresh[6],g.def[2]),b[e+1]=h(e,g.swing[7],g.thresh[7],g.def[2]),b[e+2]=h(e,g.swing[8],g.thresh[8],g.def[2]),b[e+3]=255):(b[e]=h(e,g.swing[9],g.thresh[9],g.def[3]),b[e+1]=h(e,g.swing[10],g.thresh[10],g.def[3]),b[e+2]=h(e,g.swing[11],g.thresh[11],g.def[3]),b[e+3]=255)}for(var f=c.depth||1,g=c.height,h=c.width,i={thresh:[0,1,2,0,1,2,0,1,2,0,1,2],swing:[5,5,5,10,10,10,-10,-10,-10,-5,-5,-5],clip:[150,300,500],def:[150,150,150,150]},j=0,k=0,l=Math.floor(g/2),j=0;g>j;++j){if(l>j)var m=l+j,n=l+2*j,o=l+3*j,p=l+4*j;else var m=l-j,n=l-j/2,o=l-j/3,p=l-j/4;i.swing[0]=i.swing[1]=i.swing[2]=m,i.swing[3]=i.swing[4]=i.swing[5]=n,i.swing[6]=i.swing[7]=i.swing[8]=o,i.swing[9]=i.swing[10]=i.swing[11]=p;for(var k=0;h>k;++k){var q=4*(j*h+k),r={r:a[q],g:a[q+1],b:a[q+2],a:a[q+3]};e(r,q,i),b[q+0]=(b[q+0]+r.r)/2,b[q+1]=(b[q+1]+r.g)/2,b[q+2]=(b[q+2]+r.b)/2,b[q+3]=255}}},f.kernelblend=function(a,b,c){for(var d={height:3,width:3,data:[-1,-1,-1,-1,11,-1,-1,-1,-1]},e=d.height*d.width,f=Math.sqrt(e),g=d.data,h=0,i=1,j=(c.height,c.height-1);j>i;h++,i++)for(var k=0,l=1,m=c.width,n=c.width-1;n>l;k++,l++){for(var o=4*(i*m+l),p=0,q=0,r=0,s=0;f>s;++s)for(var t=0;f>t;++t){var u=(h+s)*m+4*(k+t),v=g[s*f+t];p+=v*a[u]-b[u],q+=v*a[u+1]-b[u+1],r+=v*a[u+2]-b[u+2]}b[o]=b[o]+Math.round(p/e),b[o+1]=b[o+1]+Math.round(q/e),b[o+2]=b[o+2]+Math.round(r/e)}},f.kernelblaze=function(a,b,c){for(var d={height:3,width:3,data:[-1,-1,-1,-1,11,-1,-1,-1,-1]},e=d.height*d.width,f=Math.sqrt(e),g=d.data,h=0,i=1,j=(c.height,c.height-1);j>i;h++,i++)for(var k=0,l=1,m=c.width,n=c.width-1;n>l;k++,l++){for(var o=4*(i*m+l),p=0,q=0,r=0,s=0;f>s;++s)for(var t=0;f>t;++t){var u=(h+s)*m+4*(k+t),v=g[s*f+t];p+=v*a[u],q+=v*a[u+1],r+=v*a[u+2]}b[o]=a[o]+Math.round(p/e),b[o+1]=a[o+1]+Math.round(q/e),b[o+2]=a[o+2]+Math.round(r/e)}},f.clipped=function(a,b,c){for(var d=0,e=b.length;e>d;)b[++d]=a[d]>=245?b[d]:a[d]},f.notclipped=function(a,b,c){for(var d=0,e=b.length;e>d;)b[++d]=a[d]>=245?a[d]:b[d]},f.mean=function(a,b,d){for(var e=0,f=b.length,g=c(b);f>e;)b[++e]=b[e]<=g[0]+10&&b[e]>=g[0]-10?b[e]:a[e],b[++e]=b[e]<=g[1]+10&&b[e]>=g[1]-10?b[e]:a[e],b[++e]=b[e]<=g[2]+10&&b[e]>=g[2]-10?b[e]:a[e],b[e++]=255},f.notmean=function(a,b,d){for(var e=0,f=b.length,g=c(b);f>e;)b[++e]=b[e]<=g[0]+10&&b[e]>=g[0]-10?a[e]:b[e],b[++e]=b[e]<=g[1]+10&&b[e]>=g[1]-10?a[e]:b[e],b[++e]=b[e]<=g[2]+10&&b[e]>=g[2]-10?a[e]:b[e],b[e++]=255},f.color=function(a,c,d){for(var e=d.threshold||1,f=b(d.color),g=f.r||150,h=f.g||150,i=f.b||150,j=0,k=d.height;k>j;j++)for(var l=0,m=d.width;m>l;l++){var n=4*(j*m+l);c[n+0]<=g+e&&c[n+0]>=g-e&&c[n+1]<=h+e&&c[n+1]>=h-e&&c[n+2]<=i+e&&c[n+2]>=i-e&&(c[n+0]=a[n+0],c[n+1]=a[n+1],c[n+2]=a[n+2])}},f.light=function(a,b,c){for(var d=c.threshold||50,e=0,f=c.height;f>e;e++)for(var g=0,h=c.width;h>g;g++){var i=4*(e*h+g);b[i+0]<=220+d&&b[i+0]>=220-d&&b[i+1]<=220+d&&b[i+1]>=220-d&&b[i+2]<=220+d&&b[i+2]>=220-d&&(b[i+0]=a[i+0],b[i+1]=a[i+1],b[i+2]=a[i+2])}},f.dark=function(a,b,c){for(var d=c.threshold||50,e=0,f=c.height;f>e;e++)for(var g=0,h=c.width;h>g;g++){var i=4*(e*h+g);b[i+0]<=20+d&&b[i+0]>=20-d&&b[i+1]<=20+d&&b[i+1]>=20-d&&b[i+2]<=20+d&&b[i+2]>=20-d&&(b[i+0]=a[i+0],b[i+1]=a[i+1],b[i+2]=a[i+2])}},f.mid=function(a,b,c){for(var d=c.threshold||50,e=0,f=c.height;f>e;e++)for(var g=0,h=c.width;h>g;g++){var i=4*(e*h+g);b[i+0]<=100+d&&b[i+0]>=100-d&&b[i+1]<=100+d&&b[i+1]>=100-d&&b[i+2]<=100+d&&b[i+2]>=100-d&&(b[i+0]=a[i+0],b[i+1]=a[i+1],b[i+2]=a[i+2])}},f.red=function(a,b,c){for(var d=c.threshold||50,e=0,f=c.height;f>e;e++)for(var g=0,h=c.width;h>g;g++){var i=4*(e*h+g);b[i]<=200+d&&b[i]>=200-d&&(b[i+0]=a[i+0],b[i+1]=a[i+1],b[i+2]=a[i+2])}},f.green=function(a,b,c){for(var d=c.threshold||50,e=0,f=c.height;f>e;e++)for(var g=0,h=c.width;h>g;g++){var i=4*(e*h+g);b[i+1]<=200+d&&b[i+1]>=200-d&&(b[i+0]=a[i+0],b[i+1]=a[i+1],b[i+2]=a[i+2])}},f.blue=function(a,b,c){for(var d=c.threshold||50,e=0,f=c.height;f>e;e++)for(var g=0,h=c.width;h>g;g++){var i=4*(e*h+g);b[i+2]<=200+d&&b[i+2]>=200-d&&(b[i+0]=a[i+0],b[i+1]=a[i+1],b[i+2]=a[i+2])}},f.source_poisson_add=function(a,b,c){for(var d=new Uint8ClampedArray(b.buffer),e=0,f=1,g=(c.height,c.height-1);g>f;e++,f++)for(var h=0,i=1,j=c.width,k=c.width-1;k>i;h++,i++){for(var l=4*(f*j+i),m=[l-(4*j+4),l-4*j,l-4*j+4,l-4,l,l+4,l+(4*j-4),l+4*j,l+4*j+4],n=m.length,o=0,p=0,q=0,r=0;n>r;r++)o+=b[m[r]+0]-a[m[r]+0],p+=b[m[r]+1]-a[m[r]+1],q+=b[m[r]+2]-a[m[r]+2];d[l+0]=b[l+0]+o/n,d[l+1]=b[l+1]+p/n,d[l+2]=b[l+2]+q/n}},f.source_poisson_subtract=function(a,b,c){for(var d=new Uint8ClampedArray(b.buffer),e=0,f=1,g=(c.height,c.height-1);g>f;e++,f++)for(var h=0,i=1,j=c.width,k=c.width-1;k>i;h++,i++){for(var l=4*(f*j+i),m=[l-(4*j+4),l-4*j,l-4*j+4,l-4,l,l+4,l+(4*j-4),l+4*j,l+4*j+4],n=m.length,o=0,p=0,q=0,r=0;n>r;r++)o+=b[m[r]+0]-a[m[r]+0],p+=b[m[r]+1]-a[m[r]+1],q+=b[m[r]+2]-a[m[r]+2];d[l+0]=b[l+0]-o/n,d[l+1]=b[l+1]-p/n,d[l+2]=b[l+2]-q/n}},f.sample_poisson_add=function(a,b,c){for(var d=new Uint8ClampedArray(b.buffer),e=0,f=1,g=(c.height,c.height-1);g>f;e++,f++)for(var h=0,i=1,j=c.width,k=c.width-1;k>i;h++,i++){for(var l=4*(f*j+i),m=[l-(4*j+4),l-4*j,l-4*j+4,l-4,l,l+4,l+(4*j-4),l+4*j,l+4*j+4],n=m.length,o=0,p=0,q=0,r=0;n>r;r++)o+=b[m[r]+0]-a[m[r]+0],p+=b[m[r]+1]-a[m[r]+1],q+=b[m[r]+2]-a[m[r]+2];d[l+0]=a[l+0]+o/n,d[l+1]=a[l+1]+p/n,d[l+2]=a[l+2]+q/n}},f.sample_poisson_subtract=function(a,b,c){for(var d=new Uint8ClampedArray(b.buffer),e=0,f=1,g=(c.height,c.height-1);g>f;e++,f++)for(var h=0,i=1,j=c.width,k=c.width-1;k>i;h++,i++){for(var l=4*(f*j+i),m=[l-(4*j+4),l-4*j,l-4*j+4,l-4,l,l+4,l+(4*j-4),l+4*j,l+4*j+4],n=m.length,o=0,p=0,q=0,r=0;n>r;r++)o+=b[m[r]+0]-a[m[r]+0],p+=b[m[r]+1]-a[m[r]+1],q+=b[m[r]+2]-a[m[r]+2];d[l+0]=a[l+0]-o/n,d[l+1]=a[l+1]-p/n,d[l+2]=a[l+2]-q/n}},f.source_overflow_add=function(a,b,c){for(var d=0,e=1,f=(c.height,c.height-1);f>e;d++,e++)for(var g=0,h=1,i=c.width,j=c.width-1;j>h;g++,h++){for(var k=4*(e*i+h),l=[k-(4*i+4),k-4*i,k-4*i+4,k-4,k,k+4,k+(4*i-4),k+4*i,k+4*i+4],m=l.length,n=0,o=0,p=0,q=0;m>q;q++)n+=b[l[q]+0]-a[l[q]+0],o+=b[l[q]+1]-a[l[q]+1],p+=b[l[q]+2]-a[l[q]+2];b[k+0]=b[k+0]+n/m,b[k+1]=b[k+1]+o/m,b[k+2]=b[k+2]+p/m}},f.source_overflow_subtract=function(a,b,c){for(var d=0,e=1,f=(c.height,c.height-1);f>e;d++,e++)for(var g=0,h=1,i=c.width,j=c.width-1;j>h;g++,h++){for(var k=4*(e*i+h),l=[k-(4*i+4),k-4*i,k-4*i+4,k-4,k,k+4,k+(4*i-4),k+4*i,k+4*i+4],m=l.length,n=0,o=0,p=0,q=0;m>q;q++)n+=b[l[q]+0]-a[l[q]+0],o+=b[l[q]+1]-a[l[q]+1],p+=b[l[q]+2]-a[l[q]+2];b[k+0]=b[k+0]-n/m,b[k+1]=b[k+1]-o/m,b[k+2]=b[k+2]-p/m}},f.sample_overflow_add=function(a,b,c){for(var d=0,e=1,f=(c.height,c.height-1);f>e;d++,e++)for(var g=0,h=1,i=c.width,j=c.width-1;j>h;g++,h++){for(var k=4*(e*i+h),l=[k-(4*i+4),k-4*i,k-4*i+4,k-4,k,k+4,k+(4*i-4),k+4*i,k+4*i+4],m=l.length,n=0,o=0,p=0,q=0;m>q;q++)n+=b[l[q]+0]-a[l[q]+0],o+=b[l[q]+1]-a[l[q]+1],p+=b[l[q]+2]-a[l[q]+2];b[k+0]=a[k+0]+n/m,b[k+1]=a[k+1]+o/m,b[k+2]=a[k+2]+p/m}},f.sample_overflow_subtract=function(a,b,c){for(var d=0,e=1,f=(c.height,c.height-1);f>e;d++,e++)for(var g=0,h=1,i=c.width,j=c.width-1;j>h;g++,h++){for(var k=4*(e*i+h),l=[k-(4*i+4),k-4*i,k-4*i+4,k-4,k,k+4,k+(4*i-4),k+4*i,k+4*i+4],m=l.length,n=0,o=0,p=0,q=0;m>q;q++)n+=b[l[q]+0]-a[l[q]+0],o+=b[l[q]+1]-a[l[q]+1],p+=b[l[q]+2]-a[l[q]+2];b[k+0]=a[k+0]-n/m,b[k+1]=a[k+1]-o/m,b[k+2]=a[k+2]-p/m}},f.boost=function(a,b,c,d){for(var e=(c.height,c.width,0),f=a.length;f>e;e+=4)b[e]=Math.round(255*Math.log(a[e])/Math.log(255)),b[e+1]=Math.round(255*Math.log(a[e+1])/Math.log(255)),b[e+2]=Math.round(255*Math.log(a[e+2])/Math.log(255)),b[e+3]=255},f.solarization=function(a,b,c,d){for(var e=(c.height,c.width,0),f=a.length;f>e;e+=4)b[e]=a[e]<127.5?255-a[e]:a[e],b[e+1]=a[e+1]<127.5?255-a[e+1]:a[e+1],b[e+2]=a[e+2]<127.5?255-a[e+2]:a[e+2],b[e+3]=255},f.solar_gradient=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,e=0;h>e;e++)for(var f=0;g>f;f++){var i=4*(e*g+f),j=a[i],k=a[i+1],l=a[i+2];b[i]=j>255*e/(2*h)?j:255-j,b[i+1]=k>255*e/(2*h)?k:255-k,b[i+2]=l>255*e/(2*h)?l:255-l,b[i+3]=255}},f.solar_gradient_map=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,d=d||a,e=0;h>e;e++)for(var f=0;g>f;f++){var i=4*(e*g+f),j=a[i],k=a[i+1],l=a[i+2],m=d[i],n=d[i+1],o=d[i+2];b[i]=m>255*e/(2*h)?j:255-j,b[i+1]=n>255*e/(2*h)?k:255-k,b[i+2]=o>255*e/(2*h)?l:255-l,b[i+3]=255}},f.deplacement=function(a,b,c,d){var e,f,g,h,i,j,k=c.threshold||50,l=c.width,m=c.height,n=l-1,o=m-1,p=50,q=120,r=0,s=0;for(r+=Math.cos(p)>0?2*Math.cos(p):Math.abs(Math.cos(p)),s+=Math.sin(q)>0?2*Math.sin(q):Math.abs(Math.sin(q)),h=0;m>h;++h)for(g=0;l>g;++g)e=h*l+g<<2,i=g+a[e]/255*-r*k>>0,j=h+a[e]/255*-s*k>>0,0>i?i=0:i>n&&(i=n),0>j?j=0:j>o&&(j=o),f=j*l+i<<2,b[e]=a[f],b[e+1]=a[f+1],b[e+2]=a[f+2]},f.deplacementup=function(a,b,c,d){var e,f,g,h,i,j,k=c.threshold||50,l=c.width,m=c.height,n=l-1,o=m-1,p=50,q=120,r=0,s=0;for(r+=Math.cos(p)>0?2*Math.cos(p):Math.abs(Math.cos(p)),s+=Math.sin(q)>0?2*Math.sin(q):Math.abs(Math.sin(q)),h=0;l>h;++h)for(g=0;m>g;++g)e=h*m+g<<2,i=g+a[e]/255*-r*k>>0,j=h+a[e]/255*-s*k>>0,0>i?i=0:i>o&&(i=o),0>j?j=0:j>n&&(j=n),f=j*m+i<<2,b[e]=a[f],b[e+1]=a[f+1],b[e+2]=a[f+2]},f.displacement_map=function(a,b,c,d){var e,f,g,h,i,j,k=c.threshold||50,l=c.width,m=c.height,n=0,o=0,p=l-1,q=m-1,r=50,s=50,d=d||a;n+=Math.cos(r)>0?2*Math.cos(r):Math.abs(Math.cos(r)),o+=Math.sin(s)>0?2*Math.sin(s):Math.abs(Math.sin(s));for(h=0;m>h;++h)for(g=0;l>g;++g)e=h*l+g<<2,i=g+d[e]/255*-n*k>>0,j=h+d[e]/255*-o*k>>0,0>i?i=g:i>p&&(i=p),0>j?j=h:j>q&&(j=q),f=j*l+i<<2,b[e]=a[f],b[e+1]=a[f+1],b[e+2]=a[f+2]},f.bwdisplacement_map=function(a,b,c,d){var e,f,g,h,i,j,k=c.threshold||50,l=c.width,m=c.height,n=l-1,o=m-1,p=0,q=0,d=d||a,r=l/4/window.innerWidth*2-1,s=m/4/window.innerHeight*2-1;for(p+=.05*(r-p),q+=.05*(s-q),h=0;m>h;++h)for(g=0;l>g;++g)e=h*l+g<<2,i=g+d[e]/255*-p*k>>0,j=h+d[e]/255*-q*k>>0,0>i?i=0:i>n&&(i=n),0>j?j=0:j>o&&(j=o),f=j*l+i<<2,b[e]=a[f],b[e+1]=a[f+1],b[e+2]=a[f+2]},f.glichurdisplacement_map=function(a,b,c,d){var e,f,g,h,i,j,k=c.threshold||50,l=c.width,m=c.height,n=l-1,o=m-1,d=d||a;for(h=0;m>h;++h)for(g=0;l>g;++g)e=h*l+g<<2,i=g+d[e]/255*20*k>>0,j=h+d[e]/255*20*k>>0,0>i?i=0:i>n&&(i=n),0>j?j=0:j>o&&(j=o),f=j*m+i<<2,b[e]=a[f],b[e+1]=a[f+1],b[e+2]=a[f+2]},f.deplace=function(a,b,c){var d,e,f,g,h,i,j=c.threshold||50,k=c.width,l=c.height,m=c.xspace||50,n=c.yspace||120,o=k-1,p=l-1,q=0,r=0;for(q+=Math.cos(m)>0?2*Math.cos(m):Math.abs(Math.cos(m)),r+=Math.sin(n)>0?2*Math.sin(n):Math.abs(Math.sin(n)),g=0;l>g;g++)for(f=0;k>f;f++)d=g*k+f<<2,h=f+b[d]/255*-q*j>>0,i=g+b[d]/255*-r*j>>0,0>h?h=0:h>o&&(h=o),0>i?i=0:i>p&&(i=p),e=i*k+h<<2,b[d]=a[e],b[d+1]=a[e+1],b[d+2]=a[e+2]},f.deplace_sin=function(a,b,c){var d,e,f,g,h,i,j=c.threshold||50,k=c.width,l=c.height,m=c.xspace||50,n=c.yspace||120,o=k-1,p=l-1,q=0,r=0;for(q+=Math.sin(m)>0?2*Math.sin(m):Math.abs(Math.sin(m)),r+=Math.sin(n)>0?2*Math.sin(n):Math.abs(Math.sin(n)),g=0;l>g;g++)for(f=0;k>f;f++)d=g*k+f<<2,h=f+b[d]/255*-q*j>>0,i=g+b[d]/255*-r*j>>0,0>h?h=0:h>o&&(h=o),0>i?i=0:i>p&&(i=p),e=i*k+h<<2,b[d]=a[e],b[d+1]=a[e+1],b[d+2]=a[e+2]},f.deplace_cos=function(a,b,c){var d,e,f,g,h,i,j=c.threshold||50,k=c.width,l=c.height,m=c.xspace||50,n=c.yspace||120,o=k-1,p=l-1,q=0,r=0;for(q+=Math.cos(m)>0?2*Math.cos(m):Math.abs(Math.cos(m)),r+=Math.cos(n)>0?2*Math.cos(n):Math.abs(Math.cos(n)),g=0;l>g;g++)for(f=0;k>f;f++)d=g*k+f<<2,h=f+b[d]/255*-q*j>>0,i=g+b[d]/255*-r*j>>0,0>h?h=0:h>o&&(h=o),0>i?i=0:i>p&&(i=p),e=i*k+h<<2,b[d]=a[e],b[d+1]=a[e+1],b[d+2]=a[e+2]},f.deplace_tan=function(a,b,c){var d,e,f,g,h,i,j=c.threshold||50,k=c.width,l=c.height,m=c.xspace||50,n=c.yspace||120,o=k-1,p=l-1,q=0,r=0;for(q+=Math.tan(m)>0?2*Math.tan(m):Math.abs(Math.tan(m)),r+=Math.tan(n)>0?2*Math.tan(n):Math.abs(Math.tan(n)),g=0;l>g;g++)for(f=0;k>f;f++)d=g*k+f<<2,h=f+b[d]/255*-q*j>>0,i=g+b[d]/255*-r*j>>0,0>h?h=0:h>o&&(h=o),0>i?i=0:i>p&&(i=p),e=i*k+h<<2,b[d]=a[e],b[d+1]=a[e+1],b[d+2]=a[e+2]},f.deplace_atan=function(a,b,c){var d,e,f,g,h,i,j=c.threshold||50,k=c.width,l=c.height,m=c.xspace||50,n=c.yspace||120,o=k-1,p=l-1,q=0,r=0;for(q+=Math.atan(m)>0?2*Math.atan(m):Math.abs(Math.atan(m)),r+=Math.atan(n)>0?2*Math.atan(n):Math.abs(Math.atan(n)),g=0;l>g;g++)for(f=0;k>f;f++)d=g*k+f<<2,h=f+b[d]/255*-q*j>>0,i=g+b[d]/255*-r*j>>0,0>h?h=0:h>o&&(h=o),0>i?i=0:i>p&&(i=p),e=i*k+h<<2,b[d]=a[e],b[d+1]=a[e+1],b[d+2]=a[e+2]},f.deplace_red=function(a,b,c){var d,e,f,g,h,i,j=c.threshold||50,k=c.width,l=c.height,m=c.xspace||50,n=c.yspace||120,o=k-1,p=l-1,q=0,r=0;for(q+=Math.cos(m)>0?2*Math.cos(m):Math.abs(Math.cos(m)),r+=Math.sin(n)>0?2*Math.sin(n):Math.abs(Math.sin(n)),g=0;l>g;g++)for(f=0;k>f;f++)d=g*k+f<<2,h=f+b[d]/255*-q*j>>0,i=g+b[d]/255*-r*j>>0,0>h?h=0:h>o&&(h=o),0>i?i=0:i>p&&(i=p),e=i*k+h<<2,b[d]=(b[d]+a[e])/2,b[d+1]=b[d+1],b[d+2]=b[d+2]},f.deplace_green=function(a,b,c){var d,e,f,g,h,i,j=c.threshold||50,k=c.width,l=c.height,m=c.xspace||50,n=c.yspace||120,o=k-1,p=l-1,q=0,r=0;for(q+=Math.cos(m)>0?2*Math.cos(m):Math.abs(Math.cos(m)),r+=Math.sin(n)>0?2*Math.sin(n):Math.abs(Math.sin(n)),g=0;l>g;g++)for(f=0;k>f;f++)d=g*k+f<<2,h=f+b[d]/255*-q*j>>0,i=g+b[d]/255*-r*j>>0,0>h?h=0:h>o&&(h=o),0>i?i=0:i>p&&(i=p),e=i*k+h<<2,b[d]=b[d],b[d+1]=(b[d+1]+a[e+1])/2,b[d+2]=b[d+2]},f.deplace_blue=function(a,b,c){var d,e,f,g,h,i,j=c.threshold||50,k=c.width,l=c.height,m=c.xspace||50,n=c.yspace||120,o=k-1,p=l-1,q=0,r=0;for(q+=Math.cos(m)>0?2*Math.cos(m):Math.abs(Math.cos(m)),r+=Math.sin(n)>0?2*Math.sin(n):Math.abs(Math.sin(n)),g=0;l>g;g++)for(f=0;k>f;f++)d=g*k+f<<2,h=f+b[d]/255*-q*j>>0,i=g+b[d]/255*-r*j>>0,0>h?h=0:h>o&&(h=o),0>i?i=0:i>p&&(i=p),e=i*k+h<<2,b[d]=b[d],b[d+1]=b[d+1],b[d+2]=(b[d+2]+a[e+2])/2},f.destruct=function(a,b,c){var d,e,f,g,h,i,j=c.threshold||50,k=c.width,l=c.height,m=k-1,n=l-1,o=50,p=120,q=0,r=0;for(q+=Math.cos(o)>0?2*Math.cos(o):Math.abs(Math.cos(o)),r+=Math.sin(p)>0?2*Math.sin(p):Math.abs(Math.sin(p)),g=0;l>g;g++)for(f=0;k>f;f++)d=g*k+f<<2,h=f+b[d]/255*-q*j>>0,i=g+b[d]/255*-r*j>>0,0>h?h=0:h>m&&(h=m),0>i?i=0:i>n&&(i=n),e=i*l+h<<2,b[d]=a[e],b[d+1]=a[e+1],b[d+2]=a[e+2]},f.deplace_from_old_affect_new=function(a,b,c){var d,e,f,g,h,i,j=c.threshold||50,k=c.width,l=c.height,m=k-1,n=l-1,o=50,p=120,q=0,r=0;for(q+=Math.cos(o)>0?2*Math.cos(o):Math.abs(Math.cos(o)),r+=Math.sin(p)>0?2*Math.sin(p):Math.abs(Math.sin(p)),g=0;l>g;g++)for(f=0;k>f;f++)d=g*k+f<<2,h=f+b[d]/255*-q*j>>0,i=g+b[d]/255*-r*j>>0,0>h?h=0:h>m&&(h=m),0>i?i=0:i>n&&(i=n),e=i*k+h<<2,b[d]=a[e],b[d+1]=a[e+1],b[d+2]=a[e+2]},f.deplace_blur_new_old=function(a,b,c){var d,e,f,g,h,i,j=c.threshold||50,k=c.width,l=c.height,m=k-1,n=l-1,o=50,p=120,q=0,r=0;for(q+=Math.cos(o)>0?2*Math.cos(o):Math.abs(Math.cos(o)),r+=Math.sin(p)>0?2*Math.sin(p):Math.abs(Math.sin(p)),g=0;l>g;g++)for(f=0;k>f;f++)d=g*k+f<<2,h=f+a[d]/255*-q*j>>0,i=g+a[d]/255*-r*j>>0,0>h?h=0:h>m&&(h=m),0>i?i=0:i>n&&(i=n),e=i*k+h<<2,b[d]=(b[e]+a[d])/2,b[d+1]=(b[e+1]+a[d+1])/2,b[d+2]=(b[e+2]+a[d+2])/2},f.deplace_blur_old_old=function(a,b,c){var d,e,f,g,h,i,j=c.threshold||50,k=c.width,l=c.height,m=k-1,n=l-1,o=50,p=120,q=0,r=0;for(q+=Math.cos(o)>0?2*Math.cos(o):Math.abs(Math.cos(o)),r+=Math.sin(p)>0?2*Math.sin(p):Math.abs(Math.sin(p)),g=0;l>g;g++)for(f=0;k>f;f++)d=g*k+f<<2,h=f+b[d]/255*-q*j>>0,i=g+b[d]/255*-r*j>>0,0>h?h=0:h>m&&(h=m),0>i?i=0:i>n&&(i=n),e=i*k+h<<2,b[d]=(b[e]+a[d])/2,b[d+1]=(b[e+1]+a[d+1])/2,b[d+2]=(b[e+2]+a[d+2])/2},f.deplace_from_old_blend_old_bw=function(a,b,c){var d,e,f,g,h,i,j=c.threshold||50,k=c.width,l=c.height,m=k-1,n=l-1,o=50,p=120,q=0,r=0;for(q+=Math.cos(o)>0?2*Math.cos(o):Math.abs(Math.cos(o)),r+=Math.sin(p)>0?2*Math.sin(p):Math.abs(Math.sin(p)),g=0;l>g;g++)for(f=0;k>f;f++)d=g*k+f<<2,h=f+b[d]/255*-q*j>>0,i=g+b[d]/255*-r*j>>0,0>h?h=0:h>m&&(h=m),0>i?i=0:i>n&&(i=n),e=i*k+h<<2,b[d]=(b[e]+a[d])/2,b[d+1]=(b[e]+a[d])/2,b[d+2]=(b[e]+a[d])/2},f.deplace_from_old_blend_old_mix=function(a,b,c){var d,e,f,g,h,i,j=c.threshold||50,k=c.width,l=c.height,m=k-1,n=l-1,o=50,p=120,q=0,r=0;for(q+=Math.cos(o)>0?2*Math.cos(o):Math.abs(Math.cos(o)),r+=Math.sin(p)>0?2*Math.sin(p):Math.abs(Math.sin(p)),g=0;l>g;g++)for(f=0;k>f;f++)d=g*k+f<<2,h=f+b[d]/255*-q*j>>0,i=g+b[d]/255*-r*j>>0,0>h?h=0:h>m&&(h=m),0>i?i=0:i>n&&(i=n),e!=d?(e=i*k+h<<2,b[d]=(b[e]+a[d])/2,b[d+1]=(b[e]+a[d+1])/2,b[d+2]=(b[e]+a[d+2])/2):(b[d]=b[e+0],b[d+1]=b[e+1],b[d+2]=b[e+2])},f.deplace_from_old_blend_new=function(a,b,c){var d,e,f,g,h,i,j=c.threshold||50,k=c.width,l=c.height,m=k-1,n=l-1,o=50,p=120,q=0,r=0;for(q+=Math.cos(o)>0?2*Math.cos(o):Math.abs(Math.cos(o)),r+=Math.sin(p)>0?2*Math.sin(p):Math.abs(Math.sin(p)),g=0;l>g;g++)for(f=0;k>f;f++)d=g*k+f<<2,h=f+b[d]/255*-q*j>>0,i=g+b[d]/255*-r*j>>0,0>h?h=0:h>m&&(h=m),0>i?i=0:i>n&&(i=n),e=i*k+h<<2,b[d]=(b[e]+a[d])/2,b[d+1]=(b[e+1]+a[d+1])/2,b[d+2]=(b[e+2]+a[d+2])/2},f.deplace_from_new_blend_new=function(a,b,c){var d,e,f,g,h,i,j=c.threshold||50,k=c.width,l=c.height,m=k-1,n=l-1,o=50,p=120,q=0,r=0;for(q+=Math.cos(o)>0?2*Math.cos(o):Math.abs(Math.cos(o)),r+=Math.sin(p)>0?2*Math.sin(p):Math.abs(Math.sin(p)),g=0;l>g;g++)for(f=0;k>f;f++)d=g*k+f<<2,h=f+a[d]/255*-q*j>>0,i=g+a[d]/255*-r*j>>0,0>h?h=0:h>m&&(h=m),0>i?i=0:i>n&&(i=n),e=i*k+h<<2,b[d]=(b[e]+a[d])/2,b[d+1]=(b[e+1]+a[d+1])/2,b[d+2]=(b[e+2]+a[d+2])/2},f.deplace_from_new_blend_new_bw=function(a,b,c){var d,e,f,g,h,i,j=c.threshold||50,k=c.width,l=c.height,m=k-1,n=l-1,o=50,p=120,q=0,r=0;for(q+=Math.cos(o)>0?2*Math.cos(o):Math.abs(Math.cos(o)),r+=Math.sin(p)>0?2*Math.sin(p):Math.abs(Math.sin(p)),g=0;l>g;g++)for(f=0;k>f;f++)d=g*k+f<<2,h=f+a[d]/255*-q*j>>0,i=g+a[d]/255*-r*j>>0,0>h?h=0:h>m&&(h=m),0>i?i=0:i>n&&(i=n),e=i*k+h<<2,b[d]=(b[e]+a[d])/2,b[d+1]=(b[e]+a[d])/2,b[d+2]=(b[e]+a[d])/2},f.deplace_from_new_blend_new_mix=function(a,b,c){var d,e,f,g,h,i,j=c.threshold||50,k=c.width,l=c.height,m=k-1,n=l-1,o=50,p=120,q=0,r=0;
for(q+=Math.cos(o)>0?2*Math.cos(o):Math.abs(Math.cos(o)),r+=Math.sin(p)>0?2*Math.sin(p):Math.abs(Math.sin(p)),g=0;l>g;g++)for(f=0;k>f;f++)d=g*k+f<<2,h=f+a[d]/255*-q*j>>0,i=g+a[d]/255*-r*j>>0,0>h?h=0:h>m&&(h=m),0>i?i=0:i>n&&(i=n),e=i*k+h<<2,b[d]=(b[e]+a[d])/2,b[d+1]=(b[e]+a[d+1])/2,b[d+2]=(b[e]+a[d+2])/2},f.triangular=function(a,b,c){for(var d,e,f=c.width,g=c.height,h=f/2,i=g/2,j=0,k=0;g>k;k++){var l=k*f*4+4*h-1;i>k?(d=l-4*k,e=l+4*k):(d=l-(4*k-(1+2*j*4)),e=l+(4*k-(1+2*j*4)),j+=1);for(var m=0;f>m;m++){var n=4*(k*f+m);n>=d&&e>=n?(b[n+0]=a[n+0],b[n+1]=a[n+1],b[n+2]=a[n+2],b[n+3]=a[n+3]):(b[n+0]=b[n+0],b[n+1]=b[n+1],b[n+2]=b[n+2],b[n+3]=b[n+3])}}},f.triangular_outside=function(a,b,c){for(var d,e,f=c.width,g=c.height,h=f/2,i=g/2,j=0,k=0;g>k;k++){var l=k*f*4+4*h-1;i>k?(d=l-4*k,e=l+4*k):(d=l-(4*k-(1+2*j*4)),e=l+(4*k-(1+2*j*4)),j+=1);for(var m=0;f>m;m++){var n=4*(k*f+m);n>=d&&e>=n?(b[n+0]=b[n+0],b[n+1]=b[n+1],b[n+2]=b[n+2],b[n+3]=b[n+3]):(b[n+0]=a[n+0],b[n+1]=a[n+1],b[n+2]=a[n+2],b[n+3]=a[n+3])}}},f.horizontal_drift=function(a,c,d){function e(a,b){return a.r>=b.r-h&&a.r<=b.r+h?(b.swap=!b.swap,1):a.g>=b.g-h&&a.g<=b.g+h?(b.swap=!b.swap,1):a.b>=b.b-h&&a.b<=b.b+h?(b.swap=!b.swap,1):b.swap===!0?-1:0}var f=d.width,g=d.height,h=d.threshold||50,i=b(d.color);i.swap=!1;for(var j=0;f>j;j++){for(var k=[],l={},m={},n=0;g>n;n++){var o=j*g*4+4*n,p={r:c[o+0],g:c[o+1],b:c[o+2]};k[n]=e(p,i)}m={r:0,g:0,b:0},l={r:0,g:0,b:0};for(var n=0;g>n;n++){var o=j*g*4+4*n,q=k[n];switch(q){case 1:l.r=a[o+0],m.r=l.r,l.g=a[o+1],m.g=l.g,l.b=a[o+2],m.b=l.b;break;case-1:m.r=a[o+0],m.g=a[o+1],m.b=a[o+2];break;case 0:m.r=c[o+0],m.g=c[o+1],m.b=c[o+2]}n%g!==0?(c[o+0]=m.r,c[o+1]=m.g,c[o+2]=m.b,c[o+3]=255):(c[o+0]=c[o+0],c[o+1]=c[o+1],c[o+2]=c[o+2],c[o+3]=255)}}},f.vertical_drift=function(a,c,d){function e(a,b){return a.r>=b.r-h&&a.r<=b.r+h?(b.swap=!b.swap,1):a.g>=b.g-h&&a.g<=b.g+h?(b.swap=!b.swap,1):a.b>=b.b-h&&a.b<=b.b+h?(b.swap=!b.swap,1):b.swap===!0?-1:0}var f=d.width,g=d.height,h=d.threshold||50,i=b(d.color);i.swap=!1;for(var j=0;f>j;j++){for(var k=[],l={},m={},n=0;g>n;n++){var o=n*f*4+4*j,p={r:c[o+0],g:c[o+1],b:c[o+2]};k[n]=e(p,i)}for(var n=0;g>n;n++){var o=n*f*4+4*j,q=k[n];switch(q){case 1:l.r=a[o+0],m.r=l.r,l.g=a[o+1],m.g=l.g,l.b=a[o+2],m.b=l.b;break;case-1:m.r=a[o+0],m.g=a[o+1],m.b=a[o+2];break;case 0:m.r=c[o+0],m.g=c[o+1],m.b=c[o+2]}n%g!==0?(c[o+0]=m.r,c[o+1]=m.g,c[o+2]=m.b,c[o+3]=255):(c[o+0]=c[o+0],c[o+1]=c[o+1],c[o+2]=c[o+2],c[o+3]=255)}}},f}function effectsCode(){"use strict";function a(){var a=new Uint8Array([255,0]);return 255===new Uint16Array(a,a.buffer)[0]}function b(a){var b={};return b.r=parseInt(a.slice(4,6),16),b.g=parseInt(a.slice(2,4),16),b.b=parseInt(a.slice(0,2),16),b}function c(a){var b=[];return a.length<3?a:(a[0]<a[1]&&a[0]<a[2]?(b[0]=a[0],b[1]=a[0],b[2]=a[0],b[3]=255):a[1]<a[0]&&a[1]<a[2]?(b[0]=a[1],b[1]=a[1],b[2]=a[1],b[3]=255):a[2]<a[0]&&a[2]<a[1]&&(b[0]=a[2],b[1]=a[2],b[2]=a[2],b[3]=255),b)}function d(a){if(0===a.length)return new Uint8Array(4);if(4===a.length)return a;for(var b=new Uint8Array(4),c=0,d=0,e=0,f=0,g=0;g<a.length;g+=4)c+=a[g],d+=a[g+1],e+=a[g+2],f+=a[g+3];return b[0]=c/(a.length/4)>>>0,b[1]=d/(a.length/4)>>>0,b[2]=e/(a.length/4)>>>0,b[3]=f/(a.length/4)>>>0,b}function e(a){var b,c,d,e;return b=255&a,c=a>>8&255,d=a>>16&255,e=b,c>e&&(e=c),d>e&&(e=d),e}function f(a){var b,c,d,e;return d=a>>8&255,c=a>>16&255,b=a>>24&255,e=b,c>e&&(e=c),d>e&&(e=d),e}function g(a){this.type=a.type,this._refill=a.refill,this._amount=a.amount}function h(){this.chain=[],this.oldChain=[],this._ether=1e5,Object.defineProperty(this,"ether",{get:function(){return this._ether=this._ether-1,this._ether},set:function(a){this._ether=this._ether+a}})}g.prototype.drink=function(){return this._amount},h.prototype.sear=function(a){for(var b={r:0,g:0,b:0},c=[[0,15,50],[1,45,90],[2,95,120],[3,125,190],[4,165,205],[5,215,215],[6,256,250]],d=[[0,14,36],[1,56,75],[2,85,154],[3,119,174],[4,171,196],[5,215,245],[6,256,230]],e=[[5,0,14],[5,42,78],[5,114,152],[5,151,172],[5,176,194],[5,215,210],[6,256,220]],f=0;c[f][1]<a.r;)f++;return b.r=c[f][2],b.g=a.g+d[f][2]/2,b.b=a.b+e[f][2]/2,b},h.prototype.freeze=function(a){for(var b={r:0,g:0,b:0},c=[[5,0,14],[5,42,58],[5,114,92],[5,151,132],[5,176,174],[5,215,190],[6,256,210]],d=[[0,14,36],[1,56,75],[2,85,154],[3,119,174],[4,171,196],[5,215,215],[6,256,220]],e=[[0,15,50],[1,45,90],[2,95,120],[3,125,190],[4,165,205],[5,215,235],[6,256,250]],f=0;c[f][1]<a.r;)f++;return b.r=c[f][2],b.g=a.g+d[f][2]/2,b.b=a.b+e[f][2]/2,b},h.prototype.froze=function(a){for(var b={r:0,g:0,b:0},c=[[5,0,14],[5,42,58],[5,114,92],[5,151,132],[5,176,174],[5,215,190],[6,256,210]],d=[[0,14,36],[1,56,75],[2,85,154],[3,119,174],[4,171,196],[5,215,215],[6,256,220]],e=[[0,15,50],[1,45,90],[2,95,120],[3,125,190],[4,165,205],[5,215,235],[6,256,250]],f=0;c[f][1]<a.r;)f++;return b.r=a.r&c[f][2],b.g=a.g&d[f][2],b.b=e[f][2],b},h.prototype.soar=function(a){for(var b={r:0,g:0,b:0},c=[[0,15,50],[1,45,90],[2,95,120],[3,125,190],[4,165,205],[5,215,215],[6,256,250]],d=[[0,14,36],[1,56,75],[2,85,154],[3,119,174],[4,171,196],[5,215,245],[6,256,230]],e=[[5,0,14],[5,42,78],[5,114,152],[5,151,172],[5,176,194],[5,215,210],[6,256,220]],f=0;c[f][1]<a.r;)f++;return b.r=a.r&c[f][2],b.g=a.g&d[f][2],b.b=a.b&e[f][2],b},h.prototype.spin=function(){return this._ether>10&&this.oldChain.length>0?(this._ether--,this.oldChain.shift()):-1},h.prototype.etherPot=function(a){"ether"===a.type&&(this._ether+=a.drink())},h.prototype.chagrox=function(a,b,c,d){this._ether=a*a;for(var a=a||10,c=c||0,d=d||0,e=[],f=0;a>f;f++)for(var g=0;a>g;g++){var h=f*a*4+4*g,i=c*a*4+4*d;e[h+0]=b[i+0],e[h+1]=b[i+1],e[h+2]=b[i+2]}this.chain=e};var i={};return i.noop=function(){},i.copy=function(a,b,c){for(var d=0,e=a.length;e>d;++d)b[d]=a[d]},i.ghettoize=function(a,b,c,d){function e(a,b,c){return a.r>=c.r&&a.r<=b.r&&a.g>=c.g&&a.g<=b.g&&a.b>=c.b&&a.b<=b.b}var f,g,d=(parseInt(c.threshold)||50,d||a);c.values=c.values||"white";for(var f=c.height,g=c.width,h=a,i={r:6,g:2,b:0},j={r:252,g:165,b:243},k={r:230,g:213,b:67},l={r:0,g:250,b:249},m={r:250,g:245,b:250},j={r:252,g:165,b:243},n={r:193,g:0,b:67},o={r:122,g:199,b:123},p={r:19,g:18,b:20},q={r:93,g:91,b:95},r={r:11,g:13,b:16},s={r:238,g:151,b:143},t={r:207,g:107,b:102},u={r:254,g:225,b:200},v={r:123,g:77,b:55},w={r:255,g:254,b:255},x={r:200,g:199,b:200},y={r:175,g:185,b:177},z={r:93,g:91,b:93},A={r:253,g:255,b:250},B={r:184,g:172,b:165},C=0;f>C;C++)for(var D=0;g>D;D++){var E=C*g*4+4*D,F={r:d[E+0],g:d[E+1],b:d[E+2]},G=(F.r+F.g+F.b,{});switch(!0){case F.r-4>=F.g&&F.g+8>=F.r:G=k;break;case e(F,w,x):G=l;break;case e(F,u,v):e(F,s,t)?G=n:(G.r=((j.r+h[E+0])/2>>>0)-15,G.g=((j.b+h[E+1])/2>>>0)-15,G.b=((j.g+h[E+2])/2>>>0)-15);break;case e(F,q,r):e(F,o,p)?(G.r=((k.r+h[E+0])/2>>>0)-15,G.g=((k.b+h[E+1])/2>>>0)-15,G.b=((k.g+h[E+2])/2>>>0)-15):G=k;break;case e(F,A,B):G=m;break;case e(F,y,z):G=i}b[E+0]=G.r,b[E+1]=G.g,b[E+2]=G.b}},i.warhol=function(a,b,c,d){function e(a){if(0===a.length)return new Uint8Array(4);if(4===a.length)return a;for(var b={count:0,r:0,g:0,b:0},c={count:0,r:0,g:0,b:0},d={count:0,r:0,g:0,b:0},e=0;e<a.length;e+=4){var f=a[e]+a[e+1]+a[e+2];f>600?(b.count++,b.r+=a[e],b.g+=a[e+1],b.b+=a[e+2]):f>400?(c.count++,c.r+=a[e],c.g+=a[e+1],c.b+=a[e+2]):(d.count++,d.r+=a[e],d.g+=a[e+1],d.b+=a[e+2])}return b.r=b.r/b.count>>>0,b.g=b.g/b.count>>>0,b.b=b.b/b.count>>>0,b.totalvalue=b.r+b.g+b.b,c.r=c.r/c.count>>>0,c.g=c.g/c.count>>>0,c.b=c.b/c.count>>>0,c.totalvalue=c.r+c.g+c.b,d.r=d.r/d.count>>>0,d.g=d.g/d.count>>>0,d.b=d.b/d.count>>>0,d.totalvalue=d.r+d.g+d.b,{highs:b,mids:c,lows:d}}var f,g,d=(parseInt(c.threshold)||50,d||a);c.values=c.values||"white";for(var f=c.height,g=c.width,h=a,i=e(a),j={r:6,g:2,b:0},k={r:20,g:30,b:184},l={r:252,g:165,b:243},m={r:193,g:0,b:67},n=0;f>n;n++)for(var o=0;g>o;o++){var p=n*g*4+4*o,q={r:d[p+0],g:d[p+1],b:d[p+2]},r=q.r+q.g+q.b,s={};switch(!0){case r>=i.highs.totalvalue-10:s=k;break;case r>=i.mids.totalvalue-10:s=l;break;case r>i.lows.totalvalue-10:s=m;break;default:s=j}b[p+0]=s.r,b[p+1]=s.g,b[p+2]=s.b}for(var t=(g/50>>>0)%4>0?(g/50>>>0)-(g/50>>>0)%4:g/50>>>0,n=0;f>n;n++)for(var o=0;g>o;o++){var p=n*g*4+4*o,q={r:d[p+0],g:d[p+1],b:d[p+2]};q.r===j.r&&q.g===j.g&&q.b===j.b&&(b[p-t-4]=j.r||h[p+0],b[p-t-3]=j.g||h[p+1],b[p-t-2]=j.b||h[p+2],b[p+0]=h[p+4],b[p+1]=h[p+5],b[p+2]=h[p+6])}},i.mettoizi=function(a,b,c,d){function e(a,b,c){return a.r>=c.r&&a.r<=b.r&&a.g>=c.g&&a.g<=b.g&&a.b>=c.b&&a.b<=b.b}var f,g,h,d=(parseInt(c.threshold)||50,d||a);c.values=c.values||"white";var f=c.height,g=c.width,i={r:6,g:2,b:0},j={r:0,g:250,b:249},k={r:250,g:245,b:250},l={r:193,g:0,b:67},m={r:122,g:199,b:123},n={r:19,g:18,b:20},o={r:93,g:91,b:95},p={r:11,g:13,b:16},q={r:238,g:151,b:143},r={r:207,g:107,b:102},s={r:254,g:225,b:200},t={r:123,g:77,b:55},u={r:255,g:254,b:255},v={r:200,g:199,b:200},w={r:175,g:185,b:177},x={r:93,g:91,b:93},y={r:253,g:255,b:250},z={r:184,g:172,b:165};h=a.length;for(var A=0;f>A;A++)for(var B=0;g>B;B++){var C=B*f*4+4*g,D=B*f*4+4*(g+1);D>h&&(D=C);var E={r:d[C+0],g:d[C+1],b:d[C+2]},F=(E.r+E.g+E.b,{});switch(!0){case E.r-4>=E.g&&E.g+8>=E.r:F={r:a[D+0],g:a[D+0],b:a[D+0]};break;case e(E,u,v):F={r:a[D+1],g:a[D+1],b:a[D+1]};break;case e(E,s,t):e(E,q,r)?(F.r=(l.r+a[D+0])/2,F.g=(l.g+a[D+1])/2,F.b=(l.b+a[D+2])/2):(F.r=(a[C+0]+a[D+0])/2,F.g=(a[C+1]+a[D+1])/2,F.b=(a[C+2]+a[D+2])/2);break;case e(E,o,p):e(E,m,n)?(F.r=a[D+0],F.g=a[D+1],F.b=a[D+2]):(F.r=(a[C+2]+j.r)/2,F.g=(a[C+2]+j.g)/2,F.b=(a[C+2]+j.b)/2);break;case e(E,y,z):F=k;break;case e(E,w,x):F=i}b[C+0]=F.r,b[C+1]=F.g,b[C+2]=F.b}},i.moire=function(b,c,d,e){var f,g,h=d.height,i=d.width,j=new Uint32Array(c.buffer);if(a())for(var g=0;h>g;++g)for(var f=0;i>f;++f){var k=f*g&255;j[g*i+f]=255<<24|k<<16|k<<8|k}else for(g=0;h>g;++g)for(f=0;i>f;++f)k=f*g&255,j[g*i+f]=k<<24|k<<16|k<<8|255},i.colorcrusher=function(b,c,d,e){var f=(d.height,d.width,5),g=a(),h=new Uint32Array(b.buffer),i=new Uint32Array(c.buffer),j=h.length;if(g)for(var k=0;j>k;k++)i[k]=h[k]*f;else for(var k=0;j>k;k++)i[k]=h[k]*f},i.linedrift_top=function(b,c,d,g){var h,i,j,k=d.height,l=d.width,m=d.threshold||20,n="top",o=(a(),new Uint32Array(b.buffer)),p=new Uint32Array(c.buffer);if(a()){for(var q=0;l-1>q;q++)for(var r=0;k-1>r;r++)if(i=o[q+r*l],h=o[q+(r+1)*l],e(i)>e(h)+m)switch(n){case"left":j=i,p[q+1+r*l]=j;break;case"top":j=i,p[q+(r+1)*l]=j}}else for(var q=0;l-1>q;q++)for(var r=0;k-1>r;r++)if(i=o[q+r*l],h=o[q+(r+1)*l],f(i)>f(h)+m)switch(n){case"left":j=i,p[q+1+r*l]=j;break;case"top":j=i,p[q+(r+1)*l]=j}},i.linedrift_left=function(b,c,d,g){var h,i,j,k=d.height,l=d.width,m=d.threshold||20,n="left",o=(a(),new Uint32Array(b.buffer)),p=new Uint32Array(c.buffer);if(a()){for(var q=0;l-1>q;q++)for(var r=0;k-1>r;r++)if(i=o[q+r*l],h=o[q+(r+1)*l],e(i)>e(h)+m)switch(n){case"left":j=i,p[q+1+r*l]=j;break;case"top":j=i,p[q+(r+1)*l]=j}}else for(var q=0;l-1>q;q++)for(var r=0;k-1>r;r++)if(i=o[q+r*l],h=o[q+(r+1)*l],f(i)>f(h)+m)switch(n){case"left":j=i,p[q+1+r*l]=j;break;case"top":j=i,p[q+(r+1)*l]=j}},i.randomblocks=function(a,b,c,d){function e(a,b,c,d,e,f,g,h){for(var l=0,m=new Uint32Array(c*d),n=0;d>n;n++)for(var o=0;c>o;o++){var p=(a+n)*i+(b+o);m[l++]=j[p]}for(var l=0,n=0;h>n;n++)for(var o=0;g>o;o++){var q=(e+n)*i+(f+o);k[q]=m[l++]}}for(var f,g,h=c.height,i=c.width,j=new Uint32Array(a.buffer),k=new Uint32Array(b.buffer),l=c.xspace*c.yspace||100,f=0;h>f;f+=l)for(var g=0;i>g;g+=l){var m=Math.round(Math.random()*h-1),n=Math.round(Math.random()*i-1);m+l>h&&(m=m-(m-h)-l),n+l>i&&(n=n-(n-h)-l),e(m,n,l,l,f,g,l,l)}},i.nin_dissapointed_effect=function(a,b,c,d){for(var e,f,g,h=c.height,i=c.width,j=5,k=10,l=c.depth||.9,m=new Uint32Array(a.buffer),n=new Uint32Array(b.buffer),e=(m.length,0);h>e;e+=j)for(var f=0;i>f;f+=j)for(var o=e*i+f,p=m[o],g=0;k>g;g++){var q=o+i*g;q=parseInt(q*l,10),n[q]=p}},i.rutt_etra=function(a,b,c,d){for(var e,f,g,h=c.height,i=c.width,j=5,k=10,l=(c.depth||.9,new Uint32Array(a.buffer)),m=new Uint32Array(b.buffer),e=(l.length,0);h>e;e+=j)for(var f=0;i>f;f+=j)for(var n=e*i+f,o=l[n],g=0;k>g;g++){var p=n+i*g;m[p]=o}},i.rutt_etra_blendud=function(b,c,d,e){for(var f,g,h,i=d.height,j=d.width,k=d.xspace||5,l=d.yspace||5,m=d.weight||10,n=d.depth||.9,o=(a(),new Uint32Array(b.buffer)),p=new Uint32Array(c.buffer),f=(o.length,0);i>f;f+=k)for(var g=0;j>g;g+=l)for(var q=f*j+g,r=o[q],h=0;m>h;++h){var s=q+j*h;s=parseInt(s*n,10),p[s]=r}},i.rutt_etra_blendlr=function(a,b,c,d){for(var e,f,g,h=c.height,i=c.width,j=c.xspace||5,k=c.yspace||5,l=c.weight||10,m=c.depth||.9,n=new Uint32Array(a.buffer),o=new Uint32Array(b.buffer),e=(n.length,0);i>e;e+=j)for(var f=0;h>f;f+=k)for(var p=f*h+e,q=n[p],g=0;l>g;g++){var r=p+h*g;r=parseInt(r*m,10),o[r]=q}},i.rutt_etra_bright_lr=function(b,c,d,g){function h(a,b,c,d,e){var f=Number(a),g=Number(c),h=Number(b),i=Number(d),j=Math.abs(g-f),k=Math.abs(i-h),l=g>f?1:-1,n=i>h?1:-1,o=j-k,q=0,r=f*m+h;s[r]=e;for(var t=0;p>t;t++)s[r+m*t]=e;for(;f!=g||h!=i;){var u=o<<1;if(q>100)break;for(u>-k&&(o-=k,f+=l),j>u&&(o+=j,h+=n),q++,r=f*m*h,t=0;p>t;t++)s[r+m*t]=e}}var i,j,k,l=d.height,m=d.width,n=d.xspace||5,o=d.yspace||5,p=d.weight||10,q=d.depth||.9,r=new Uint32Array(b.buffer),s=new Uint32Array(c.buffer),t=(r.length,[]);if(a())for(var i=0;l>i;i+=n)for(var j=0;m>j;j+=o){var u=i*m+j,v=r[u],w=e(v);t.push([i,j,Math.abs(parseInt(q*w/25,10)),v])}else for(var i=0;l>i;i+=n)for(var j=0;m>j;j+=o){var u=i*m+j,v=r[u],w=f(v);t.push([i,j,Math.abs(parseInt(q*w/25,10)),v])}for(var x,y,z=0,A=0,k=0,B=t.length;B>k;k++){var C=t[k],i=C[0],j=C[1],D=C[2],E=C[3],F=parseInt(D/2,10);x=i+F,y=j,h(z,A,x,y,E),z=x,A=y}},i.rutt_etra_bright_lr_map=function(b,c,d,g){function h(a,b,c,d,e){var f=Number(a),g=Number(c),h=Number(b),i=Number(d),j=Math.abs(g-f),k=Math.abs(i-h),l=g>f?1:-1,n=i>h?1:-1,o=j-k,q=0,r=f*m+h;t[r]=e;for(var s=0;p>s;s++)t[r+m*s]=e;for(;f!=g||h!=i;){var u=o<<1;if(q>100)break;for(u>-k&&(o-=k,f+=l),j>u&&(o+=j,h+=n),q++,r=f*m*h,s=0;p>s;s++)t[r+m*s]=e}}var i,j,k,g=g||b,l=d.height,m=d.width,n=d.xspace||5,o=d.yspace||5,p=d.weight||10,q=d.depth||.9,r=new Uint32Array(b.buffer),s=new Uint32Array(g.buffer),t=new Uint32Array(c.buffer),u=(r.length,[]);if(a())for(var i=0;l>i;i+=n)for(var j=0;m>j;j+=o){var v=i*m+j,w=r[v],x=e(s[v]);u.push([i,j,Math.abs(parseInt(q*x/25,10)),w])}else for(var i=0;l>i;i+=n)for(var j=0;m>j;j+=o){var v=i*m+j,w=r[v],x=f(s[v]);u.push([i,j,Math.abs(parseInt(q*x/25,10)),w])}for(var y,z,A=0,B=0,k=0,C=u.length;C>k;k++){var D=u[k],i=D[0],j=D[1],E=D[2],F=D[3],G=parseInt(E/2,10);y=i+G,z=j,h(A,B,y,z,F),A=y,B=z}},i.rgb_lights=function(b,c,d,g){var h,i,j=d.height,k=d.width,l=d.xspace||5,m=d.yspace||5,n=(d.weight||10,d.depth||.9,"r"),o=new Uint32Array(b.buffer),p=new Uint32Array(c.buffer);if(a())for(var h=0;j>h;h+=l)for(var i=0;k>i;i+=m){var q=h*k+i,r=o[q],s=e(r);switch(n){case"r":r=-16777216|s;break;case"g":r=-16777216|s<<8|0;break;case"b":r=255<<24|s<<16|0|0}for(var t=0;l>t;++t)for(var u=0;m>u;++u){var v=q+(t*k+u);p[v]=r}n="r"===n?"g":"g"===n?"b":"r"}else for(var h=0;j>h;h+=l)for(var i=0;k>i;i+=m){var q=h*k+i,r=o[q],s=f(r);switch(n){case"r":r=s<<24|0|0|255;break;case"g":r=255<<24|s<<16|0|255;break;case"b":r=0|s<<8|255}for(var t=0;l>t;++t)for(var u=0;m>u;++u){var v=q+(t*k+u);p[v]=r}n="r"===n?"g":"g"===n?"b":"r"}},i.rgb_lights_3d=function(b,c,d,f){var g,h,i=d.height,j=d.width,k=d.xspace||5,l=d.yspace||5,m=d.weight||10,n=(d.depth||.9,"r"),o=new Uint32Array(b.buffer),p=new Uint32Array(c.buffer);if(a())for(var g=0;i>g;g+=k+m)for(var h=0;j>h;h+=l+m){for(var q=g*j+h,r=o[q],s=e(r),t=0;m>t;++t)for(var u=0;k>u;++u)for(var v=0;l>v;++v){var w=Math.max(0,Math.min(255,Math.round(s*t)));switch(n){case"r":r=-16777216|w;break;case"g":r=-16777216|w<<8|0;break;case"b":r=255<<24|w<<16|0|0}var x=q+(u*j+v+(t*j+t));p[x]=r}n="r"===n?"g":"g"===n?"b":"r"}else for(var g=0;i>g;g+=k+m)for(var h=0;j>h;h+=l+m){for(var q=g*j+h,r=o[q],s=e(r),t=0;m>t;++t)for(var u=0;k>u;++u)for(var v=0;l>v;++v){var w=Math.max(0,Math.min(255,Math.round(s*t)));switch(n){case"r":r=w<<24|0|0|255;break;case"g":r=0|w<<16|0|255;break;case"b":r=0|w<<8|255}var x=q+(u*j+v+(t*j+t));p[x]=r}n="r"===n?"g":"g"===n?"b":"r"}},i.simple_3d_light=function(b,c,d,g){var h,i,j=d.xspace,k=d.yspace,l=(d.stroke,d.weight),m=d.height,n=d.width;10>j&&(j=10),10>k&&(k=10),l>5&&(l=5);var o=new Uint32Array(b.buffer),p=new Uint32Array(c.buffer);if(a())for(var h=0;m>h;h+=j+l)for(var i=0;n>i;i+=k+l)for(var q=h*n+i,r=o[q],s=e(r),t=0;l>t;t++)for(var u=0;j>u;u++)for(var v=0;k>v;v++){var w=Math.max(0,Math.min(255,Math.round(s*t)));r=255<<24|w<<16|w<<8|w;var x=q+(u*n+v+(t*n+t));p[x]=r}else for(var h=0;m>h;h+=j+l)for(var i=0;n>i;i+=k+l)for(var q=h*n+i,r=o[q],s=f(r),t=0;l>t;++t)for(var u=0;j>u;++u)for(var v=0;k>v;++v){var w=Math.max(0,Math.min(255,Math.round(s*t)));r=w<<24|w<<16|w<<8|255;var x=q+(u*n+v+(t*n+t));p[x]=r}},i.simple_3d_color=function(a,b,c,d){for(var e,f,g=c.xspace||10,h=c.yspace||10,i=c.weight||5,j=c.height,k=c.width,l=new Uint32Array(a.buffer),m=new Uint32Array(b.buffer),e=0;j>e;e+=g+i)for(var f=0;k>f;f+=h+i)for(var n=e*k+f,o=l[n],p=0;i>p;p++)for(var q=0;g>q;q++)for(var r=0;h>r;r++){var s=n+(q*k+r+(p*k+p));m[s]=o}},i.half_lights=function(b,c,d,e){var f,g,h=d.height,i=d.width,j=d.xspace||10,k=d.yspace||5,l="r",m=new Uint32Array(b.buffer),n=new Uint32Array(c.buffer);if(a())for(var f=0;h>f;f+=j)for(var g=0;i>g;g+=k){var o=f*i+g,p=m[o],q=255&p,r=p>>8&255,s=p>>16&255;switch(l){case"r":p=255<<24|Math.round(s/2)<<16|Math.round(r/2)<<8|q;break;case"g":p=255<<24|Math.round(s/2)<<16|r<<8|Math.round(q/2);break;case"b":p=255<<24|s<<16|Math.round(r/2)<<8|Math.round(q/2)}for(var t=0;j>t;++t)for(var u=0;k>u;++u){var v=o+(t*i+u);n[v]=p}l="r"===l?"g":"g"===l?"b":"r"}else for(var f=0;h>f;f+=j)for(var g=0;i>g;g+=k){var o=f*i+g,p=m[o],q=p>>24&255,r=p>>16&255,s=p>>8&255;switch(l){case"r":p=q<<24|Math.round(r/2)<<16|Math.round(s/2)<<8|255;break;case"g":p=Math.round(q/2)<<24|r<<16|Math.round(s/2)<<8|255;break;case"b":p=Math.round(q/2)<<24|Math.round(r/2)<<16|s<<8|255}for(var t=0;j>t;++t)for(var u=0;k>u;++u){var v=o+(t*i+u);n[v]=p}l="r"===l?"g":"g"===l?"b":"r"}},i.half_circle_lights=function(b,c,d,e){var f,g,h=d.height,i=d.width,j=d.xspace||15,k=d.yspace||15,l="r",m=new Uint32Array(b.buffer),n=new Uint32Array(c.buffer),o=Math.round(j/2),p=Math.round(k/2),q=j*k,r=Math.round(q/4/10),s=r*r;if(a())for(var f=0;h>f;f+=j)for(var g=0;i>g;g+=k){var t=f*i+g,u=m[t],v=255&u,w=u>>8&255,x=u>>16&255;switch(l){case"r":u=255<<24|Math.round(x/2)<<16|Math.round(w/2)<<8|v;break;case"g":u=255<<24|Math.round(x/2)<<16|w<<8|Math.round(v/2);break;case"b":u=255<<24|x<<16|Math.round(w/2)<<8|Math.round(v/2)}for(var y=0;j>y;++y)for(var z=0;k>z;++z){var A=o-y,B=p-z;if(s>=A*A+B*B){var C=t+(y*i+z);n[C]=u}}l="r"===l?"g":"g"===l?"b":"r"}else for(var f=0;h>f;f+=j)for(var g=0;i>g;g+=k){for(var u,t=f*i+g,y=0;j>y;++y)for(var z=0;k>z;++z){var D=t+(y*i+z);u+=m[D]}u=Math.round(u/q);var v=u>>24&255,w=u>>16&255,x=u>>8&255;switch(l){case"r":u=v<<24|Math.round(w/2)<<16|Math.round(x/2)<<8|255;break;case"g":u=Math.round(v/2)<<24|w<<16|Math.round(x/2)<<8|255;break;case"b":u=Math.round(v/2)<<24|Math.round(w/2)<<16|x<<8|255}for(var A=o-f,B=p-g,y=0;j>y;++y)for(var z=0;k>z;++z)if(s>=A*A+B*B){var C=t+(y*i+z);n[C]=u}l="r"===l?"g":"g"===l?"b":"r"}},i.half_circle_colors=function(b,c,d,e){var f,g,h=d.height,i=d.width,j=d.xspace||15,k=d.yspace||15,l=new Uint32Array(b.buffer),m=new Uint32Array(c.buffer),n=Math.round(j/2),o=Math.round(k/2),p=j*k,q=Math.round(p/4/10),r=q*q;if(a())for(var f=0;h>f;f+=j)for(var g=0;i>g;g+=k){var s=f*i+g,t=l[s],u=255&t,v=t>>8&255,w=t>>16&255;t=255<<24|w<<16|v<<8|u;for(var x=0;j>x;++x)for(var y=0;k>y;++y){var z=n-x,A=o-y;if(r>=z*z+A*A){var B=s+(x*i+y);m[B]=t}}}else for(var f=0;h>f;f+=j)for(var g=0;i>g;g+=k){for(var t,s=f*i+g,x=0;j>x;++x)for(var y=0;k>y;++y){var C=s+(x*i+y);t+=l[C]}t=Math.round(t/p);var u=t>>24&255,v=t>>16&255,w=t>>8&255;t=u<<24|v<<16|w<<8|255;for(var z=n-f,A=o-g,x=0;j>x;++x)for(var y=0;k>y;++y)if(r>=z*z+A*A){var B=s+(x*i+y);m[B]=t}}},i.blockbreaker=function(b,c,d,g){var h,i,j,k,l=d.height,m=d.width,n=d.xspace||5,o=d.yspace||5,p=new Uint32Array(b.buffer),q=new Uint32Array(c.buffer),r=Math.round(n/2),s=Math.round(o/2);if(a())for(var h=0;l>h;h+=n)for(var i=0;m>i;i+=o){var t=h*m+i,u=p[t],v=255-e(u),j=n*o/v;k=Math.round(j*j);for(var w=0;n>w;++w)for(var x=0;o>x;++x){var y=r-w,z=s-x;if(k>=y*y+z*z){var A=t+(w*m+x);q[A]=u}}}else for(var h=0;l>h;h+=n)for(var i=0;m>i;i+=o){var t=h*m+i,u=p[t],v=255-f(u),j=n*o/v;k=Math.round(j*j);for(var w=0;n>w;++w)for(var x=0;o>x;++x){var y=r-w,z=s-x;if(k>=y*y+z*z){var A=t+(w*m+x);q[A]=u}}}},i.fuzz_lights=function(b,c,d,e){var f,g,h=d.height,i=d.width,j=10,k=5,l="r",m=new Uint32Array(b.buffer),n=new Uint32Array(c.buffer),o=(m.length,a());if(o)for(var f=0;h>f;f+=j)for(var g=0;i>g;g+=k){var p,q=f*i+g,r=m[q],s=255&r,t=r>>8&255,u=r>>16&255;switch(l){case"r":p=255<<24|Math.round(u/2)<<16|Math.round(t/2)<<8|s;break;case"g":p=255<<24|Math.round(u/2)<<16|t<<8|Math.round(s/2);break;case"b":p=255<<24|u<<16|Math.round(t/2)<<8|Math.round(s/2)}for(var v=0;j>v;++v)for(var w=0;k>w;++w){var x=q+(v*i+w);n[x]=(m[x]+r)/2}l="r"===l?"g":"g"===l?"b":"r"}else for(var f=0;h>f;f+=j)for(var g=0;i>g;g+=k){var p,q=f*i+g,r=m[q],s=r>>24&255,t=r>>16&255,u=r>>8&255;switch(l){case"r":p=s<<24|Math.round(t/2)<<16|Math.round(u/2)<<8|255;break;case"g":p=Math.round(s/2)<<24|t<<16|Math.round(u/2)<<8|255;break;case"b":p=Math.round(s/2)<<24|Math.round(t/2)<<16|u<<8|255}for(var v=0;j>v;++v)for(var w=0;k>w;++w){var x=q+(v*i+w);n[x]=(m[x]+r)/2}l="r"===l?"g":"g"===l?"b":"r"}},i.pixelate=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,i=10,j=5,k=new Uint32Array(a.buffer),l=new Uint32Array(b.buffer),e=(k.length,0);g>e;e+=i)for(var f=0;h>f;f+=j)for(var m=e*h+f,n=k[m],o=0;i>o;++o)for(var p=0;j>p;++p){var q=m+(o*h+p);l[q]=n}},i.pandaize=function(b,c,d,e){var f,g,h,i,j=d.height,k=d.width,l=(b.length,new Uint32Array(b.buffer)),m=new Uint32Array(c.buffer),n=l.length,o=void 0===d.xspace||0===parseInt(d.xspace,10)?6:parseInt(d.xspace,10),p=2,q=void 0===d.yspace||0===parseInt(d.yspace,10)?20:parseInt(d.yspace,10),r=40,s=1,t=1.618,u=!1,v=!0;a?(h=-16777216,i=-1):(h=255,i=-1);for(var g=0;j>g;g++){g%r===0&&(s=-s);for(var f=0;k>f;f+=o)for(var w=0;o>w;w++)if(a){var x=f+s*g+w+g*k;if(x>=n)continue;var y=l[x],z=y>>16&255,A=y>>8&255,B=255&y;if(v)if(u&&(0+p>w||w>=o-p)||!u&&0+p>w){var C=Math.max.apply(null,[z,A,B]);C=Math.max(Math.min(255,q+C*t),0),m[x]=255<<24|C<<16|C<<8|C}else m[x]=i;else m[x]=h;w==o-1&&(v=!v)}else{var x=f+s*g+w+g*k;if(x>=n)continue;var y=l[x],z=y>>16&255,A=y>>8&255,B=255&y;if(v)m[x]=h;else{if(u&&(0+p>w||w>=o-p)||!u&&0+p>w){var C=Math.max.apply(null,[z,A,B]);C=Math.max(Math.min(255,q+C*t),0),m[x]=C<<24|C<<16|C<<8|255}else m[x]=i;w===o-1&&(v=!v)}}}},i.socanoawshift=function(b,c,d,e){var f,g,h,i,j,k=d.height,l=d.width,m=1,n=1,o=1*new Date,p=new Uint32Array(b.buffer),q=new Uint32Array(c.buffer);if(a())for(f=0;k>f;f+=m)for(g=0;l>g;g+=n){var r=f*l+g,s=p[r];h=255&s,i=s>>8&255,j=s>>16&255;var t=256*Math.sin(h+i+j)>>0,u=256*Math.cos(h+i+j)>>0,h=u-t*o*.1>>24,i=u-t*o*.1>>16,j=u-t*o*.1>>8;q[r]=255<<24|j<<16|i<<8|h|255}},i.pipes=function(a,b,c,d){function e(a){for(var b=0,c=0;c<a.length;c++)b+=a[c];if(b>0)for(var c=0;c<a.length;c++)a[c]/=b}function f(b,c,d){for(var e,f=0,g=0,h=0,i=0,j=0,k=d.x-1,l=d.y-1,m=d.w,n=k,o=b.height;o>i;++n,++i)for(var p=l,q=b.width;q>j;++p,++j){var e=Math.abs(n*m*4)+Math.abs(4*p);f+=(a[e+0]||1)*b.data[i+j],g+=(a[e+1]||1)*b.data[i+j],h+=(a[e+2]||1)*b.data[i+j]}return 0>f&&(f=Math.abs(f)),0>g&&(g=Math.abs(g)),0>h&&(h=Math.abs(h)),[Math.round(f),Math.round(g),Math.round(h)]}var g,h,i=c.height,j=c.width,k={height:3,width:3,data:[-1,-1,-1,-1,11,-1,-1,-1,-1]};e(k.data);for(var g=0;i>g;++g)for(var h=0;j>h;++h){var l=4*(g*j+h),m={w:j,h:i,x:g,y:h},n=f(k,l,m);b[l+0]=n[0],b[l+1]=n[1],b[l+2]=n[2]}},i.kernelizer_map=function(a,b,c,d){for(var e,f,g,h,c=void 0===c?{}:c,i=(a.length,c.height),j=c.width,k=[-1,-1,1,-1,1,2,-1,1,1],l=k.length,m=Math.round(Math.sqrt(l)),n=Math.floor(m/2),e=0;j>e;++e)for(var f=0;i>f;++f){for(var o=e,p=f,q=0,r=0,s=0,t=4*(e*i+f),g=0;m>g;g++)for(var h=0;m>h;h++){var u=o+g-n,v=p+h-n,w=4*(u*i+v),x=k[h*m+g];q+=a[w+0]*x,r+=a[w+1]*x,s+=a[w+2]*x}b[t+0]=q/k.length,b[t+1]=r/k.length,b[t+2]=s/k.length,b[t+3]=255}},i.convolute=function(a,b,c,d){for(var c=c||{},e=(c.numel||4,a.length,c.noise||0,{height:3,width:3,data:[0,-1,0,-1,5,-1,0,-1,0]}),f=e.data,g=Math.round(Math.sqrt(f.length)),h=Math.floor(g/2),i=c.height,j=c.width,k=j,l=i,m=0;l>m;++m)for(var n=0;k>n;++n){for(var o=n,p=m,q=4*(m*k+n),r=0,s=0,t=0,u=0,v=0;g>v;++v)for(var w=0;g>w;++w){var x=p+v-h,y=o+w-h;if(x>=0&&i>x&&y>=0&&j>y){var z=4*(x*j+y),A=f[v*g+w];r+=a[z]*A,s+=a[z+1]*A,t+=a[z+2]*A,u+=a[z+3]*A}}b[q]=r,b[q+1]=s,b[q+2]=t,b[q+3]=255}},i.stryp=function(a,b,c,d){for(var e,f,g,h,i,j,k,l,m,n,o,p=c.height,q=c.width,r=[-1,-1,1,-2,0,2,-1,1,1],s=Math.round(Math.sqrt(r.length)),t=Math.floor(s/2),e=0;q>e;++e)for(var f=0;p>f;++f){for(var k=e-t,l=f-t,m=0,n=0,o=0,u=4*(e*p+f),g=0;s>g;++g)for(var h=0;s>h;++h){var i=k+g,j=l+h,v=4*(i*p+j),w=r[h*s+g];m+=a[v+0]*w,n+=a[v+1]*w,o+=a[v+2]*w}b[u+0]=m,b[u+1]=n,b[u+2]=o,b[u+3]=255}},i.sheerator=function(a,b,c,d){for(var e={height:3,width:3,data:[-1,-1,1,-2,0,2,-1,1,1]},f=e.data,g=Math.round(Math.sqrt(f.length)),h=Math.floor(g/2),i=c.height,j=c.width,k=j,l=i,m=0;l>m;m++)for(var n=0;k>n;n++){for(var o=n,p=m,q=4*(m*k+n),r=0,s=0,t=0,u=0;g>u;u++)for(var v=0;g>v;v++){var w=p+u-h,x=o+v-h;if(w>=0&&i>w&&x>=0&&j>x){var y=4*(w*j+x),z=f[v*g+u];r+=a[y]*z,s+=a[y+1]*z,t+=a[y+2]*z}}b[q]=r,b[q+1]=s,b[q+2]=t,b[q+3]=255}},i.whoabro=function(a,b,c,d){function e(c){for(var d=c.start.h,e=c.start.w,f=c.end.h,g=c.end.w,i=d;f>i;i++)for(var j=e;g>j;j++){var k=4*(i*h+j);b[k+0]=a[k+0+4*i],b[k+1]=a[k+1+4*i],b[k+2]=a[k+2+4*i]}}function f(a){if(e(a),!(a.end.h>20||a.end.w>20)){var b=parseInt(a.end.h/2,10),c=parseInt(a.end.w/2,10),d=parseInt(a.end.h,10),g=parseInt(a.end.w,10);f({start:{h:0,w:0},end:{h:b,w:c}}),f({start:{h:0,w:c},end:{h:b,w:g}}),f({start:{h:b,w:0},end:{h:d,w:c}}),f({start:{h:b,w:c},end:{h:d,w:g}})}}for(var g=c.height,h=c.width,i=5;i;)f({start:{h:0,w:0},end:{h:g,w:h}}),i--},i.swingmapcustom=function(a,b,c){function d(a,b){return a+4*b}function e(c,e,g){function h(b,c,e,g){var h=a[d(b,c)+e]?a[d(b,c)+e]*f:g*f;return h}var i=c.r+c.g+c.b;i>g.clip[0]?(b[e]=h(e,g.swing[0],g.thresh[0],g.def[0]),b[e+1]=h(e,g.swing[1],g.thresh[1],g.def[0]),b[e+2]=h(e,g.swing[2],g.thresh[2],g.def[0]),b[e+3]=255):i>g.clip[1]?(b[e]=h(e,g.swing[3],g.thresh[3],g.def[1]),b[e+1]=h(e,g.swing[4],g.thresh[4],g.def[1]),b[e+2]=h(e,g.swing[5],g.thresh[5],g.def[1]),b[e+3]=255):i>g.clip[2]?(b[e]=h(e,g.swing[6],g.thresh[6],g.def[2]),b[e+1]=h(e,g.swing[7],g.thresh[7],g.def[2]),b[e+2]=h(e,g.swing[8],g.thresh[8],g.def[2]),b[e+3]=255):(b[e]=h(e,g.swing[9],g.thresh[9],g.def[3]),b[e+1]=h(e,g.swing[10],g.thresh[10],g.def[3]),b[e+2]=h(e,g.swing[11],g.thresh[11],g.def[3]),b[e+3]=255)}var f=c.depth||1,g=c.height,h=c.width,i={thresh:[0,1,2,0,1,2,0,1,2,0,1,2],swing:[5,5,5,10,10,10,15,15,15,20,20,20],clip:[100,200,400],def:[100,200,15,15]},j={thresh:[0,1,2,0,1,2,0,1,2,0,1,2],swing:[2,2,2,7,7,7,9,9,9,11,11,11],clip:[100,200,400],def:[100,200,15,15]},k={thresh:[0,1,2,0,1,2,0,1,2,0,1,2],swing:[-5,-5,-5,-10,-10,-10,-15,-15,-15,-20,-20,-20],clip:[100,200,400],def:[100,200,15,15]},l={thresh:[0,1,2,0,1,2,0,1,2,0,1,2],swing:[0,0,0,0,0,0,0,0,0,0,0,0],clip:[150,300,500],def:[150,150,150,150]},m=[1,1,0,0,0,0,0,0,3,0,1,1,0,0,0,0,3,0,0,0,1,1,0,0,3,0,0,0,0,0,1,1,3,0,0,0,0,0,0,3,1,3,0,0,0,0,0,0,3,1,1,0,0,0,0,0,3,3,3,1,1,0,0,0,0,3,0,0,0,1,1,0,0,3,0,0,0,0,0,1,1,3,0,0,0,0,0,0,0,1],n=7,o=0,p=0,q=0,r=0;for(p=0;g>p;p++,o++)for(o>n&&(o=0),q=0;h>q;q++,r++){var s=p*h*4+4*q,t={r:a[s],g:a[s+1],b:a[s+2],a:a[s+3]};r>n&&(r=0);var u=m[o+r];switch(u){case 3:e(t,s,k);break;case 2:e(t,s,j);break;case 1:e(t,s,i);break;case 0:e(t,s,l);break;default:e(t,s,k)}a[s+3]=255}},i.map_smosh=function(a,b,c,d){for(var c=c||{},e=c.height,f=c.width,d=d||a,g=(a.length,0);e>g;g++)for(var h=0;f>h;h++){var i=g*f*4+4*h,j={r:d[i],g:d[i+1],b:d[i+2]},k=j.r+j.b+j.b;h%(f-1)!==0?k>100?(b[i+0]=a[i-76+1]||255,b[i+1]=a[i+80+2]||0,b[i+2]=a[i-16+0]||255,b[i+3]=255):k>50?(b[i+0]=a[i-52+2]||255,b[i+1]=a[i+60+0]||255,b[i+2]=a[i+16+1]||0,b[i+3]=255):(b[i+0]=a[i+28+2]||0,b[i+1]=a[i+16+0]||255,b[i+2]=a[i-40+1]||255,b[i+3]=255):(b[i+0]=a[i+0],b[i+1]=a[i+1],b[i+2]=a[i+2],b[i+3]=255)}},i.map_drift=function(a,c,d,e){function f(a,b){return a.r>=b.r-i&&a.r<=b.r+i?(b.swap=!b.swap,1):a.g>=b.g-i&&a.g<=b.g+i?(b.swap=!b.swap,1):a.b>=b.b-i&&a.b<=b.b+i?(b.swap=!b.swap,1):b.swap===!0?-1:0}var g,h,i=(d.depth||1,parseInt(d.threshold)||50),e=e||a,g=d.height,h=d.width,j=b(d.color)||{r:200,g:200,b:200};j.swap=!1;for(var k=0;g>k;k++){for(var l=[],m={},n={},o=0;h>o;o++){var p=k*h*4+4*o,q={r:e[p+0],g:e[p+1],b:e[p+2]};l[o]=f(q,j)}for(var o=0;h>o;o++){var p=k*h*4+4*o,r=l[o];switch(r){case 1:m.r=a[p+0],n.r=m.r,m.g=a[p+1],n.g=m.g,m.b=a[p+2],n.b=m.b;break;case-1:n.r=m.r,n.g=m.g,n.b=m.b;break;case 0:n.r=a[p+0],n.g=a[p+1],n.b=a[p+2]}o%h!==0?(c[p+0]=n.r,c[p+1]=n.g,c[p+2]=n.b,c[p+3]=255):(c[p+0]=a[p+0],c[p+1]=a[p+1],c[p+2]=a[p+2],c[p+3]=255)}}},i.kodachromatic=function(a,b,c,d){for(var e,f=c.width,g=c.height,h=1,i=1,j=0;f>j;j+=h)for(var k=0;g>k;k+=i){e=4*(j*g+k);var l=1.5*a[e+0],m=.95*a[e+1],n=.35*a[e+2],o=Math.round((l+n+m)/3);b[e+0]=o,b[e+1]=o,b[e+2]=o}},i.panochromatic=function(a,b,c,d){for(var e,f=c.width,g=c.height,h=1,i=1,j=0;f>j;j+=h)for(var k=0;g>k;k+=i){e=4*(j*g+k);var l=.45*a[e+0],m=1.05*a[e+1],n=1.35*a[e+2],o=Math.round((l+n+m)/3);b[e+0]=o,b[e+1]=o,b[e+2]=o}},i.lithochromatic=function(a,b,c,d){for(var e,f=c.width,g=c.height,h=1,i=1,j=0;f>j;j+=h)for(var k=0;g>k;k+=i){e=4*(j*g+k);var l=0*a[e+0],m=1.05*a[e+1],n=1.45*a[e+2],o=Math.round((l+n+m)/3);b[e+0]=o,b[e+1]=o,b[e+2]=o}},i.orthochromatic=function(a,b,c,d){for(var e,f=c.width,g=c.height,h=1,i=1,j=0;f>j;j+=h)for(var k=0;g>k;k+=i){e=4*(j*g+k);var l=.1*a[e+0],m=1.05*a[e+1],n=1.45*a[e+2],o=Math.round((l+n+m)/3);b[e+0]=o,b[e+1]=o,b[e+2]=o}},i.blgle=function(a,b,c){for(var d,e=c.color||{r:0,g:0,b:0},f=c.height,g=c.width,h=0;f>h;h++)for(var i=0;g>i;i++)d=4*(h*g+i),b[d+0]=a[d+0]<<1&255+e.r%a[d+0],b[d+1]=a[d+1]<<1&255+e.r%a[d+1],b[d+2]=a[d+2]<<1&255+e.r%a[d+2],b[d+3]=4},i.twistocity=function(a,b,c){function d(a,b){return a*Math.cos(b)}function e(a,b){return a*Math.sin(b)}for(var f,g,h=c.height,i=c.width,j=new Uint32Array(a.buffer),k=new Uint32Array(b.buffer),f=0;h>f;f++)for(var g=0;i>g;g++){var l=Math.atan2(g,f),m=Math.sqrt(g*g+f*f),n=d(m,l),o=e(m,l+m/3),p=Math.round(f*i+g),q=Math.round(n*i+o);k[p]=j[q]}},i.spirility=function(a,b,c){function d(){return i[p++]}for(var e,f,g=c.height,h=c.width,i=new Uint32Array(a.buffer),j=new Uint32Array(b.buffer),e=(i.length,0),f=0,k=0,l=-1,m=Math.max(h,g),n=m*m,o=g*h,p=0,q=-g/2,r=g/2,s=-h/2,t=h/2,u=Math.round(g/2),v=Math.round(h/2),w=0;n>w;w++){if(e>=q&&r>=e&&f>=s&&t>=f){var x=(u+e)*h+(v+f);0>x||x>o?--w:j[x]=d()}(e==f||0>e&&e==-f||e>0&&e==1-f)&&(m=k,k=-l,l=m),e+=k,f+=l}},i.orbo=function(a,b,c,d){for(var f,g,h=c.height,i=c.width,j=new Uint32Array(a.buffer),f=0;h>f;f++)for(var g=0;i>g;g++){var k=4*(f*i+g),l=f*i+g,m=4*Math.round(l-e(j[l])/4);b[k]=a[m],b[k+1]=a[m+1],b[k+2]=a[m+2],b[k+3]=255}},i.disperse=function(a,b,c,d){for(var f,g,h=c.height,i=c.width,j=new Uint32Array(a.buffer),f=0;h>f;f++)for(var g=0;i>g;g++){var k=4*(f*i+g),l=f*i+g,m=4*Math.round(l-e(j[l])/4);b[m]=a[k],b[m+1]=a[k+1],b[m+2]=a[k+2],b[k+3]=255}},i.polarice=function(a,b,c,d){function e(a,b){return a*Math.cos(b)}function f(a,b){return a*Math.sin(b)}function g(a){return a*Math.PI/180}for(var h,i,j=c.height,k=c.width,l=g(36),m=400,h=0;j>h;h++)for(var i=0;k>i;i++){var l=Math.atan2(i,h),m=Math.sqrt(i*i+h*h),n=e(Math.sqrt(400*m),l),o=f(Math.sqrt(400*m),l),p=4*(h*k+i),q=4*(Math.round(n)*k+Math.round(o));b[p]=a[q],b[p+1]=a[q+1],b[p+2]=a[q+2],b[p+3]=255}},i.polarslice=function(a,b,c,d){function e(a,b){return a*Math.cos(b)}function f(a,b){return a*Math.sin(b)}function g(a){return a*Math.PI/180}for(var h,i,j=c.height,k=c.width,l=g(36),m=400,n=Math.round(j/2),o=Math.round(k/2),h=0;j>h;h++)for(var i=0;k>i;i++){var l=Math.atan2(i,h),m=Math.sqrt(i*i+h*h),p=e(Math.sqrt(400*m),l),q=f(Math.sqrt(400*m),l),r=4*(h*k+i),s=4*(Math.round(p+n)*k+Math.round(q+o));
b[r]=a[s],b[r+1]=a[s+1],b[r+2]=a[s+2],b[r+3]=255}},i.shrink=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,e=0;g>e;e++)for(var f=0;h>f;f++){var i=4*(e*h+f),j=4*(2*e%(g+1)*h+2*f%(h+1));a[i],a[i+1],a[i+2];b[i]=a[j],b[i+1]=a[j+1],b[i+2]=a[j+2],b[i+3]=255}},i.stretch=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,b=new Uint8Array(a.length),e=0;g>e;e++)for(var f=0;h>f;f++){var i=4*(e*h+f),j=4*(Math.round(e/2)*h+f);a[i],a[i+1],a[i+2];b[i]=a[j],b[i+1]=a[j+1],b[i+2]=a[j+2],b[i+3]=255}},i.boost=function(a,b,c,d){for(var e=(c.height,c.width,0),f=a.length;f>e;e+=4)b[e]=Math.round(255*Math.log(a[e])/Math.log(255)),b[e+1]=Math.round(255*Math.log(a[e+1])/Math.log(255)),b[e+2]=Math.round(255*Math.log(a[e+2])/Math.log(255)),b[e+3]=255},i.solarization=function(a,b,c,d){for(var e=(c.height,c.width,0),f=a.length;f>e;e+=4)b[e]=a[e]<127.5?255-a[e]:a[e],b[e+1]=a[e+1]<127.5?255-a[e+1]:a[e+1],b[e+2]=a[e+2]<127.5?255-a[e+2]:a[e+2],b[e+3]=255},i.solar_gradient=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,e=0;h>e;e++)for(var f=0;g>f;f++){var i=4*(e*g+f),j=a[i],k=a[i+1],l=a[i+2];b[i]=j>255*e/(2*h)?j:255-j,b[i+1]=k>255*e/(2*h)?k:255-k,b[i+2]=l>255*e/(2*h)?l:255-l,b[i+3]=255}},i.solar_gradient_map=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,d=d||a,e=0;h>e;e++)for(var f=0;g>f;f++){var i=4*(e*g+f),j=a[i],k=a[i+1],l=a[i+2],m=d[i],n=d[i+1],o=d[i+2];b[i]=m>255*e/(2*h)?j:255-j,b[i+1]=n>255*e/(2*h)?k:255-k,b[i+2]=o>255*e/(2*h)?l:255-l,b[i+3]=255}},i.releif=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,e=0;h>e;e++)for(var f=0;g>f;f++){var i=4*(e*g+f),j=4*((e+1)*g+(f+1)),k=a[i],l=a[i+1],m=a[i+2];b[i]=k+(127.5-a[j]),b[i+1]=l+(127.5-a[j+1]),b[i+2]=m+(127.5-a[j+2]),b[i+3]=255}},i.archez_horizontal=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,e=0;g>e;e++)for(var f=0;h>f;f++){var i=4*(e*h+f),j=a[i],k=j*Math.abs(e%Math.sin(f))>10?0:255;b[i]=k,b[i+1]=k,b[i+2]=k,b[i+3]=255}},i.archez_diagonal=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,e=0;g>e;e++)for(var f=0;h>f;f++){var i=4*(e*h+f),j=a[i],k=j*Math.abs(f%Math.sin(e))>10?0:255;b[i]=k,b[i+1]=k,b[i+2]=k,b[i+3]=255}},i.lazer_horizontal=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,e=0;g>e;e++)for(var f=0;h>f;f++){var i=4*(e*h+f),j=f%(5+f/25)>5?0:255;b[i]=j,b[i+1]=j,b[i+2]=j,b[i+3]=255}},i.lazer_diagonal=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,e=0;g>e;e++)for(var f=0;h>f;f++){var i=4*(e*h+f),j=e%(5+f/25)>5?0:255;b[i]=j,b[i+1]=j,b[i+2]=j,b[i+3]=255}},i.trig_contrast=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,e=0;g>e;e++)for(var f=0;h>f;f++){var i=4*(e*h+f);b[i]=Math.round(Math.atan(e-g,f-h)*a[i]/360),b[i+1]=Math.round(Math.atan(e-g,f-h)*a[i+1]/360),b[i+2]=Math.round(Math.atan(e-g,f-h)*a[i+2]/360),b[i+3]=255}},i.ridges=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,e=0;g>e;e++)for(var f=0;h>f;f++){var i=4*(e*h+f);b[i]=f+Math.round(255*Math.sin(e)/2),b[i+1]=f+Math.round(255*Math.sin(e)/2),b[i+2]=f+Math.round(255*Math.sin(e)/2),b[i+3]=255}},i.risged=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,e=0;g>e;e++)for(var f=0;h>f;f++){var i=4*(e*h+f);b[i]=f+Math.sin(e)*a[i]/2,b[i+1]=f+Math.sin(e)*a[i]/2,b[i+2]=f+Math.sin(e)*a[i]/2,b[i+3]=255}},i.moire=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,e=0;g>e;e++)for(var f=0;h>f;f++){var i=4*(e*h+f);b[i]=e*f%(a[i]+1),b[i+1]=e*f%(a[i+1]+1),b[i+2]=e*f%(a[i+2]+1),b[i+3]=255}},i.moire_static_rgb=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,e=0;g>e;e++)for(var f=0;h>f;f++){var i=4*(e*h+f);b[i]=a[i]*e*f/(g-1)*(h-1),b[i+1]=a[i+1]*e*f/(g-1)*(h-1),b[i+2]=a[i+2]*e*f/(g-1)*(h-1),b[i+3]=255}},i.moire_static_bw=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,e=0;g>e;e++)for(var f=0;h>f;f++){var i=4*(e*h+f);b[i]=a[i]*e*f/(g-1)*(h-1),b[i+1]=a[i]*e*f/(g-1)*(h-1),b[i+2]=a[i]*e*f/(g-1)*(h-1),b[i+3]=255}},i.shape_blade=function(a,b,c,d){var e,f,g,h,i,j=c.height,k=c.width;g=j,h=k,i=255;for(var e=0;j>e;e++)for(var f=0;k>f;f++){var l=4*(e*k+f);b[l]=e%f,b[l+1]=e%f,b[l+2]=e%f,b[l+3]=i}},i.signal_interference=function(b,c,d,e){var f=d.height,g=d.width,h=new Uint32Array(b.buffer),i=new Uint32Array(c.buffer),j=new Float64Array(i.buffer),k=h.length,l=j.length;if(a()){for(var m=0;l>m;m++){var n=h[2*m];j[m]=g*f/n}for(var m=0;k>m;m++){n=i[m];var o=255&n,p=n>>8&255,q=n>>16&255;i[m]=255<<24|q<<16|p<<8|o}}else for(var m=0;k>m;m++){n=i[m];var o=n>>24&255,p=n>>16&255,q=n>>8&255;i[m]=o<<24|p<<16|q<<8|255}},i.funkyjunk=function(b,c,d,e){var f,g,h,i,j,k=d.height,l=d.width,m=new Uint32Array(b.buffer),n=new Uint32Array(c.buffer);if(a())for(var f=0;k>f;f++)for(var g=0;l>g;g++){var o=f*l+g,p=m[o];h=32*Math.log((255&p)+1)>>0,i=32*Math.log((p>>8&255)+1)>>0,j=32*Math.log((p>>16&255)+1)>>0,n[o]=255<<24|j<<16|i<<8|h}else for(var f=0;k>f;f++)for(var g=0;l>g;g++){var o=f*l+g,p=m[o];h=32*Math.log((p>>24&255)+1)>>0,i=32*Math.log((p>>16&255)+1)>>0,j=32*Math.log((p>>8&255)+1)>>0,n[o]=h<<24|i<<16|j<<8|255}},i.junkyfunk=function(b,c,d,e){var f,g,h,i,j,k=d.height,l=d.width,m=new Uint32Array(b.buffer),n=new Uint32Array(c.buffer);if(a())for(var f=0;k>f;f++)for(var g=0;l>g;g++){var o=f*l+g,p=m[o];h=32*Math.log10((255&p)+1)>>0,i=32*Math.log10((p>>8&255)+1)>>0,j=32*Math.log10((p>>16&255)+1)>>0,n[o]=255<<24|j<<16|i<<8|h}else for(var f=0;k>f;f++)for(var g=0;l>g;g++){var o=f*l+g,p=m[o];h=(32*Math.log10((p>>24&255)+1)>>0)-1,i=32*Math.log10((p>>16&255)+1)>>0,j=32*Math.log10((p>>8&255)+1)>>0,n[o]=h<<24|i<<16|j<<8|255}},i.eightbit=function(b,c,d,e){var f,g,h,i,j,k=d.height,l=d.width,m=new Uint32Array(b.buffer),n=new Uint32Array(c.buffer),o=[50,60,70,90,120,145,200,250];if(a())for(var f=0;k>f;f++)for(var g=0;l>g;g++){var p=f*l+g,q=m[p];h=o[Math.log2((255&q)+1)>>0],i=o[Math.log2((q>>8&255)+1)>>0],j=o[Math.log2((q>>16&255)+1)>>0],n[p]=255<<24|j<<16|i<<8|h}else for(var f=0;k>f;f++)for(var g=0;l>g;g++){var p=f*l+g,q=m[p];h=o[Math.log2((q>>24&255)+1)>>0],i=o[Math.log2((q>>16&255)+1)>>0],j=o[Math.log2((q>>8&255)+1)>>0],n[p]=h<<24|i<<16|j<<8|255}},i.log10_bits_contrast=function(b,c,d,e){var f,g,h,i,j,k=d.height,l=d.width,m=new Uint32Array(b.buffer),n=new Uint32Array(c.buffer),o=[50,60,70,90,120,145,200,250];if(a())for(var f=0;k>f;f++)for(var g=0;l>g;g++){var p=f*l+g,q=m[p];h=o[Math.log10((255&q)+1)>>0],i=o[Math.log10((q>>8&255)+1)>>0],j=o[Math.log10((q>>16&255)+1)>>0],n[p]=255<<24|j<<16|i<<8|h}else for(var f=0;k>f;f++)for(var g=0;l>g;g++){var p=f*l+g,q=m[p];h=o[Math.log10((q>>24&255)+1)>>0],i=o[Math.log10((q>>16&255)+1)>>0],j=o[Math.log10((q>>8&255)+1)>>0],n[p]=h<<24|i<<16|j<<8|255}},i.log2_bits_collapse=function(b,c,d,e){var f,g,h,i,j,k=d.height,l=d.width,m=new Uint32Array(b.buffer),n=new Uint32Array(c.buffer),o=[50,60,70,90,120,145,200,250];if(a())for(var f=0;k>f;f++)for(var g=0;l>g;g++){var p=f*l+g,q=m[p];h=o[Math.log2((255&q)+1)>>0],i=o[Math.log2((q>>8&255)+1)>>0],j=o[Math.log2((q>>16&255)+1)>>0],n[p]=255<<24|j<<16|i<<8|h}else for(var f=0;k>f;f++)for(var g=0;l>g;g++){var p=f*l+g,q=m[p];h=o[Math.log2((q>>24&255)+1)>>0],i=o[Math.log2((q>>16&255)+1)>>0],j=o[Math.log2((q>>8&255)+1)>>0],n[p]=h<<24|i<<16|j<<8|255}},i.log_bits_short=function(b,c,d,e){var f,g,h,i,j,k=d.height,l=d.width,m=new Uint32Array(b.buffer),n=new Uint32Array(c.buffer),o=[50,60,70,90,120,145,200,250];if(a())for(var f=0;k>f;f++)for(var g=0;l>g;g++){var p=f*l+g,q=m[p];h=o[Math.log((255&q)+1)>>0],i=o[Math.log((q>>8&255)+1)>>0],j=o[Math.log((q>>16&255)+1)>>0],n[p]=255<<24|j<<16|i<<8|h}else for(var f=0;k>f;f++)for(var g=0;l>g;g++){var p=f*l+g,q=m[p];h=o[Math.log((q>>24&255)+1)>>0],i=o[Math.log((q>>16&255)+1)>>0],j=o[Math.log((q>>8&255)+1)>>0],n[p]=h<<24|i<<16|j<<8|255}},i.zoomth=function(b,c,d,e){var f=new Uint32Array(b.buffer),g=f.length-1,h=new Uint32Array(c.buffer),i=1,j=1;if(a())for(;g>j;){var k=f[i],l=f[i+1],m=f[i-1],n=255&k,o=k>>8&255,p=k>>16&255,q=255&l,r=l>>8&255,s=l>>16&255,t=255&m,u=m>>8&255,v=m>>16&255,w=(n+q+t)/Math.log2(n+q+t)>>0,x=(o+r+u)/Math.log2(o+r+u)>>0,y=(p+s+v)/Math.log2(p+s+v)>>0,z=255<<24|y<<16|x<<8|w;h[j]=k,h[j+1]=z,h[j+2]=m,h[j+3]=k,++i,j+=4}else for(;g>j;){var k=f[i],l=f[i+1],m=f[i-1],n=k>>24&255,o=k>>16&255,p=k>>8&255,q=l>>24&255,r=l>>16&255,s=l>>8&255,t=m>>24&255,u=m>>16&255,v=m>>8&255,w=(n+q+t)/Math.log2(n+q+t)>>0,x=(o+r+u)/Math.log2(o+r+u)>>0,y=(p+s+v)/Math.log2(p+s+v)>>0;h[j]=k,h[j+1]=z,h[j+2]=m,h[j+3]=k,++i,j+=4}},i.zoomp=function(b,c,d,e){function f(a){var b=255&a,c=a>>8&255,d=a>>16&255;return b=Math.max(b-127,0),c=Math.min(c-Math.floor(c/2),255),d=Math.min(d+Math.floor(d/2),255),255<<24|d<<16|c<<8|b}function g(a){var b=255&a,c=a>>8&255,d=a>>16&255;return b=Math.max(b-127,0),c=Math.min(c-Math.floor(d/2),255),d=Math.min(d-Math.floor(d/2),255),255<<24|d<<16|c<<8|b}function h(a){var b=a>>24&255,c=a>>16&255,d=a>>8&255;return b-=127,c-=Math.floor(c/2),d+=Math.floor(d/2),b<<24|c<<16|d<<8|255}function i(a){var b=a>>24&255,c=a>>16&255,d=a>>8&255;return b-=127,c-=Math.floor(d/2),d+=Math.floor(d/2),b<<24|c<<16|d<<8|255}var j=new Uint32Array(b.buffer),k=j.length,l=new Uint32Array(c.buffer),m=0,n=0;if(a())for(;k>n;)l[n++]=j[m],l[n++]=f(j[m]),l[n++]=g(j[m]),m++;else for(;k>n;)l[n++]=j[m],l[n++]=h(j[m]),l[n++]=i(j[m]),m++},i.rgb_bgr=function(b,c,d){var e,f=new Uint32Array(b.buffer),g=new Uint32Array(c.buffer),h=f.length;if(a())for(var e=0;h>e;e++){var i=f[e],j=i>>16&255,k=i>>8&255,l=255&i;g[e]=255<<24|l<<16|k<<8|j}else for(var e=0;h>e;e++){var i=f[e],l=i>>24&255,k=i>>16&255,j=i>>8&255;g[e]=j<<24|k<<16|l<<8|255}},i.rgb_grb=function(b,c,d){var e,f=new Uint32Array(b.buffer),g=new Uint32Array(c.buffer),h=f.length;if(a())for(var e=0;h>e;e++){var i=f[e],j=i>>16&255,k=i>>8&255,l=255&i;g[e]=255<<24|j<<16|l<<8|k}else for(var e=0;h>e;e++){var i=f[e],l=i>>24&255,k=i>>16&255,j=i>>8&255;g[e]=k<<24|l<<16|j<<8|255}},i.rgb_brg=function(b,c,d){var e,f=new Uint32Array(b.buffer),g=new Uint32Array(c.buffer),h=f.length;if(a())for(var e=0;h>e;e++){var i=f[e],j=i>>16&255,k=i>>8&255,l=255&i;g[e]=255<<24|k<<16|l<<8|j}else for(var e=0;h>e;e++){var i=f[e],l=i>>24&255,k=i>>16&255,j=i>>8&255;g[e]=j<<24|l<<16|k<<8|255}},i.floatsort_distortion=function(a,b,c,d){function e(a,b){return a-b}for(var f,g,h,i,j,k,l=c.height,m=c.width,h=new Uint32Array(a.buffer),n=new Uint32Array(b.buffer),i=a.byteLength+a.byteLength%8,j=new ArrayBuffer(i),k=(new Uint8Array(j),new Uint32Array(j)),o=(new Float64Array(j),0),p=h.length;p>o;o++)k[o]=h[o];for(var q=new Float64Array(k.buffer),r=(parseInt(c.threshold,10)||50,Math.round(l/2)),f=(Math.round(m/2),0);m>f;f++){for(var s=new Float64Array(r),t=new Float64Array(r),g=0;r>g;g++){var u=f*r+g;s[g]=q[u]}t.set(s.sort(e));for(var g=0;r>g;g++){var u=f*r+g;q[u]=t[g]}}for(var o=0,p=n.length;p>o;o++)n[o]=k[o]},i.floatsort=function(a,b,c,d){function e(a,b){return a-b}for(var f,g,h,i,j,k,l=c.height,m=c.width,h=new Uint32Array(a.buffer),n=new Uint32Array(b.buffer),i=a.byteLength+a.byteLength%8,j=new ArrayBuffer(i),k=(new Uint8Array(j),new Uint32Array(j)),o=(new Float64Array(j),0),p=h.length;p>o;o++)k[o]=h[o];for(var q=new Float64Array(k.buffer),r=(parseInt(c.threshold,10)||50,Math.round(l/2),Math.round(m/2)),f=0;l>f;f++){for(var s=new Float64Array(r),t=new Float64Array(r),g=0;r>g;g++){var u=f*r+g;s[g]=q[u]}t.set(s.sort(e));for(var g=0;r>g;g++){var u=f*r+g;q[u]=t[g]}}for(var o=0,p=n.length;p>o;o++)n[o]=k[o]},i.fisher_yates_shuffle=function(a,b,c,d){for(var e=c.height,f=c.width,g=e*f*4,h={r:0,g:0,b:0},i=g-1;i--;){var j=Math.floor(Math.random()*(i+1)),h={r:a[i+0],g:a[i+1],b:a[i+2]};b[i+0]=a[j+0],b[i+1]=a[j+1],b[i+2]=a[j+2],b[j+0]=h.r,b[j+1]=h.g,b[j+2]=h.b}},i.fisher_yates_shuffle_horizontal=function(a,b,c,d){for(var e=c.height,f=c.width,g=0;e>g;g++)for(var h=f-1;h--;){var i=Math.floor(Math.random()*(h+1)),j=g*f*4+4*h,k=g*f*4+4*i,l={r:a[j+0],g:a[j+1],b:a[j+2]};b[j+0]=a[k+0],b[j+1]=a[k+1],b[j+2]=a[k+2],b[k+0]=l.r,b[k+1]=l.g,b[k+2]=l.b}},i.fisher_yates_shuffle_vertical=function(a,b,c,d){for(var e=c.height,f=c.width,g=0;f>g;g++)for(var h=e-1;h--;){var i=Math.floor(Math.random()*(h+1)),j=h*e*4+4*g,k=i*e*4+4*g,l={r:a[j+0],g:a[j+1],b:a[j+2]};b[j+0]=a[k+0],b[j+1]=a[k+1],b[j+2]=a[k+2],b[k+0]=l.r,b[k+1]=l.g,b[k+2]=l.b}},i.fisher_yates_deluxe=function(a,b,c,d){for(var e=c.height,f=c.width,g=0;f>g;g++)for(var h=e-1;h--;){var i=Math.floor(Math.random()*(h+1)),j=g*e*4+4*h,k=g*e*4+4*i,l={r:a[j+0],g:a[j+1],b:a[j+2]};b[j+0]=a[k+0],b[j+1]=a[k+1],b[j+2]=a[k+2],b[k+0]=l.r,b[k+1]=l.g,b[k+2]=l.b}for(var g=0;e>g;g++)for(var h=f-1;h--;){var i=Math.floor(Math.random()*(h+1)),j=h*f*4+4*g,k=i*f*4+4*g,l={r:b[j+0],g:b[j+1],b:b[j+2]};b[j+0]=b[k+0],b[j+1]=b[k+1],b[j+2]=b[k+2],b[k+0]=l.r,b[k+1]=l.g,b[k+2]=l.b}},i.pixelsort_lr=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,i=new Uint32Array(a.buffer),j=new Uint32Array(b.buffer),e=0;g>e;e++){for(var k=new Uint32Array(h),l=new Uint32Array(h),f=0;h>f;f++){var m=e*h+f;k[f]=i[m]}l.set(k.sort());for(var f=0;h>f;f++){var m=e*h+f;j[m]=l[f]}}},i.pixelsort_rl=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,i=new Uint32Array(a.buffer),j=new Uint32Array(b.buffer),e=0;g>e;e++){for(var k=new Uint32Array(h),l=new Uint32Array(h),f=0;h>f;f++){var m=e*h+f;k[f]=i[m]}l.set(k.sort()),l=l.reverse();for(var f=0;h>f;f++){var m=e*h+f;j[m]=l[f]}}},i.pixelsort_ud=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,i=new Uint32Array(a.buffer),j=new Uint32Array(b.buffer),e=0;h>e;e++){for(var k=new Uint32Array(g),l=new Uint32Array(g),f=0;g>f;f++){var m=f*h+e;k[f]=i[m]}l.set(k.sort());for(var f=0;g>f;f++){var m=f*h+e;j[m]=l[f]}}},i.pixelsort_du=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,i=new Uint32Array(a.buffer),j=new Uint32Array(b.buffer),e=0;h>e;e++){for(var k=new Uint32Array(g),l=new Uint32Array(g),f=0;g>f;f++){var m=f*h+e;k[f]=i[m]}l.set(k.sort()),l=l.reverse();for(var f=0;g>f;f++){var m=f*h+e;j[m]=l[f]}}},i.float_swing=function(a,b,c,d){var e,f,g,h,i=c.height,j=c.width,k=(new Uint32Array(a.buffer),new Uint32Array(b.buffer));if(i*j%8===0){g=new Float64Array(a.buffer),h=new Float64Array(k.buffer);for(var l=(parseInt(c.threshold,10)||50,Math.round(i/2)),e=(Math.round(j/2),0);j>e;e++)for(var f=0;l>f;f++){var m=e*l+f,n=g[m],o=g[m+1];o>n&&(h[m]=o,h[m+1]=n)}}},i.float_distortion=function(a,b,c,d){var e,f,g,h,i,j=c.height,k=c.width,l=parseInt(c.threshold,10)||50;0>l&&(l=-l);var e=new Uint32Array(a.buffer),m=new Uint32Array(b.buffer),f=a.byteLength+a.byteLength%8,g=new ArrayBuffer(f),h=(new Uint8Array(g),new Uint32Array(g)),i=new Float64Array(g);for(o=0,p=e.length;p>o;++o)h[o]=e[o];for(var n=(Math.round(j/2),Math.round(k/2),Math.floor(Math.sqrt(l))),o=(Math.round(n/2),0),p=i.length;p>o;o+=l)for(var q=i[o],r=0;n>r;++r)for(var s=0;n>s;++s){var t=r*o+s;t>p||(i[t]=q)}for(o=0,p=m.length;p>o;++o)m[o]=h[o]},i.outta_shape=function(a,b,c,d){function e(a,b,c,d,e,f,g,h){for(var i=0,j=new Uint32Array(c*d),k=0;d>k;k++)for(var l=0;c>l;l++){var p=(a+k)*m+(b+l);j[i++]=n[p]}for(var i=0,k=0;h>k;k++)for(var l=0;g>l;l++){var q=(e+k)*m+(f+l);o[q]=j[i++]}}function f(a,b,c,d,e,f,g,h,i){for(var j=0,k=i*i,l=new Uint32Array(d*c),p=Math.round(d/2),q=Math.round(c/2),r=0;d>r;r++)for(var s=0;c>s;s++){var t=p-r,u=q-s;if(k>=t*t+u*u){var v=(a+r)*m+(b+s);l[j++]=n[v]}}for(var j=0,r=0;h>r;r++)for(var s=0;g>s;s++){var t=p-r,u=q-s;if(k>=t*t+u*u){var w=(e+r)*m+(f+s);o[w]=l[j++]}}}function g(a,b,c,d,e,f,g,h){for(var i=0,j=Math.round(.5*d*c),k=new Uint32Array(j),l=Math.round(d/2),p=(Math.round(c/2),0);d>p;p++)for(var q=Math.ceil(p/2),r=l-q,s=l+q,t=0;c>t;t++)if(t>r&&s>t){var u=(a+p)*m+(b+t);k[i++]=n[u]}for(var i=0,p=0;h>p;p++)for(var q=Math.ceil(p/2),r=l-q,s=l+q,t=0;g>t;t++)if(t>r&&s>t){var v=(e+p)*m+(f+t);o[v]=k[i++]}}for(var h,i,j=c.xspace||10,k=c.yspace||10,l=(c.stroke||10,c.weight||10,c.height),m=c.width,n=new Uint32Array(a.buffer),o=new Uint32Array(b.buffer),p=j*k,h=0;l>h;h+=p)for(var i=0;m>i;i+=p){var q=Math.round(Math.random()*l-1),r=Math.round(Math.random()*m-1);q+p>l&&(q=q-(q-l)-p),r+p>m&&(r=r-(r-l)-p),e(q,r,p,p,h,i,p,p)}for(var h=0;l>h;h+=p)for(var i=0;m>i;i+=p){var q=Math.round(Math.random()*l-1),r=Math.round(Math.random()*m-1);q+p>l&&(q=q-(q-l)-p),r+p>m&&(r=r-(r-l)-p),f(q,r,p,p,h,i,p,p,Math.round(p/2))}for(var h=0;l>h;h+=p)for(var i=0;m>i;i+=p){var q=Math.round(Math.random()*l-1),r=Math.round(Math.random()*m-1);q+p>l&&(q=q-(q-l)-p),r+p>m&&(r=r-(r-l)-p),g(q,r,p,p,h,i,p,p)}},i.asdf_pixelsort_lr_map=function(a,c,d,e){function f(a,b){return a-b}function g(a,b){return a.r>=b.r-l&&a.r<=b.r+l&&a.g>=b.g-l&&a.g<=b.g+l&&a.b>=b.b-l&&a.b<=b.b+l?(b.swap=!b.swap,1):b.swap===!0?-1:0}var h,i,j=d.height,k=d.width,l=parseInt(d.threshold)||50,e=e||a,m=b(d.color)||{r:200,g:200,b:200};m.swap=!1;for(var h=0;j>h;++h){for(var n=[],o=[],p=[],q=[],r={r:0,g:0,b:0},s={r:0,g:0,b:0},i=0;k>i;++i){var t=4*(h*k+i);n[i]=a[t+0],o[i]=a[t+1],p[i]=a[t+2],q[i]=g({r:e[t],g:e[t+1],b:e[t+2]},m)}n.sort(f),o.sort(f),p.sort(f);for(var i=0;k>i;i++){var t=4*(h*k+i),u=q[i];switch(u){case 1:s.r=r.r=n.pop(),s.g=r.g=o.pop(),s.b=r.b=p.pop();break;case-1:s.r=r.r,s.g=r.g,s.b=r.b;break;case 0:s.r=a[t+0],s.g=a[t+1],s.b=a[t+2]}i%k!==0?(c[t+0]=s.r,c[t+1]=s.g,c[t+2]=s.b,c[t+3]=255):(c[t+0]=a[t+0],c[t+1]=a[t+1],c[t+2]=a[t+2],c[t+3]=255)}}},i.asdf_pixelsort_ud_map=function(a,c,d,e){function f(a,b){return a-b}function g(a,b){return a.r>=b.r-l&&a.r<=b.r+l&&a.g>=b.g-l&&a.g<=b.g+l&&a.b>=b.b-l&&a.b<=b.b+l?(b.swap=!b.swap,1):b.swap===!0?-1:0}var h,i,e=e||a,j=d.height,k=d.width,l=parseInt(d.threshold)||50,m=b(d.color)||{r:200,g:200,b:200};m.swap=!1;for(var h=j;h--;){for(var n=[],o=[],p=[],q=[],r={r:0,g:0,b:0},s={r:0,g:0,b:0},i=k;i--;){var t=4*(i*j+h);n[i]=a[t+0],o[i]=a[t+1],p[i]=a[t+2],q[i]=g({r:e[t],g:e[t+1],b:e[t+2]},m)}n.sort(f),o.sort(f),p.sort(f);for(var i=k;i--;){var t=4*(i*j+h),u=q[i];switch(u){case 1:s.r=r.r=n.pop(),s.g=r.g=o.pop(),s.b=r.b=p.pop();break;case-1:s.r=r.r,s.g=r.g,s.b=r.b;break;case 0:s.r=a[t+0],s.g=a[t+1],s.b=a[t+2]}i%k!==0?(c[t+0]=s.r,c[t+1]=s.g,c[t+2]=s.b,c[t+3]=255):(c[t+0]=a[t+0],c[t+1]=a[t+1],c[t+2]=a[t+2],c[t+3]=255)}}},i.pixelcrunch_map=function(a,c,d,e){function f(a,b){return a-b}function g(a){var b=a.r+a.g+a.b;return b>100?0:b>50?-1:1}var h,i,j=d.height,k=d.width,e=e||a,l=(parseInt(d.threshold)||50,b(d.color)||{r:200,g:200,b:200});l.swap=!1;for(var h=0;j>h;++h){for(var m=[],n=[],o=[],p=[],q={r:0,g:0,b:0},r={r:0,g:0,b:0},i=0;k>i;++i){var s=4*(h*k+i);m[i]=a[s+0],n[i]=a[s+1],o[i]=a[s+2],p[i]=g({r:e[s],g:e[s+1],b:e[s+2]},l)}m.sort(f),n.sort(f),o.sort(f);for(var i=0;k>i;++i){var s=4*(h*k+i),t=p[i];switch(t){case 1:r.r=q.r=m.pop(),r.g=q.g=n.pop(),r.b=q.b=o.pop();break;case-1:r.r=q.r,r.g=q.g,r.b=q.b;break;case 0:r.r=a[s+0],r.g=a[s+1],r.b=a[s+2]}i%k!==0?(c[s+0]=r.r,c[s+1]=r.g,c[s+2]=r.b,c[s+3]=255):(c[s+0]=a[s+0],c[s+1]=a[s+1],c[s+2]=a[s+2],c[s+3]=255)}}},i.drift_lr=function(a,c,d){function e(a,b){return a.r>=b.r-h&&a.r<=b.r+h?(b.swap=!b.swap,1):a.g>=b.g-h&&a.g<=b.g+h?(b.swap=!b.swap,1):a.b>=b.b-h&&a.b<=b.b+h?(b.swap=!b.swap,1):b.swap===!0?-1:0}var f=d.height,g=d.width,h=parseInt(d.threshold)||50,i=b(d.color)||{r:200,g:200,b:200};i.swap=!1;for(var j=0;f>j;j++){for(var k=[],l={},m={},n=0;g>n;n++){var o=j*g*4+4*n,p={r:a[o+0],g:a[o+1],b:a[o+2]};k[n]=e(p,i)}for(var n=0;g>n;n++){var o=j*g*4+4*n,q=k[n];switch(q){case 1:l.r=a[o+0],m.r=l.r,l.g=a[o+1],m.g=l.g,l.b=a[o+2],m.b=l.b;break;case-1:m.r=l.r,m.g=l.g,m.b=l.b;break;case 0:m.r=a[o+0],m.g=a[o+1],m.b=a[o+2]}n%g!==0?(c[o+0]=m.r,c[o+1]=m.g,c[o+2]=m.b,c[o+3]=255):(c[o+0]=a[o+0],c[o+1]=a[o+1],c[o+2]=a[o+2],c[o+3]=255)}}},i.drift_rl=function(a,c,d,e){function f(a,b){return a.r>=b.r-g&&a.r<=b.r+g?(b.swap=!b.swap,1):a.g>=b.g-g&&a.g<=b.g+g?(b.swap=!b.swap,1):a.b>=b.b-g&&a.b<=b.b+g?(b.swap=!b.swap,1):b.swap===!0?-1:0}var g=parseInt(d.threshold)||50,h=d.height,i=d.width,j=b(d.color)||{r:200,g:200,b:200};j.swap=!1;for(var k=h;k--;){for(var l=[],m={},n={},o=i;o--;){var p=4*(k*i+o),q={r:a[p+0],g:a[p+1],b:a[p+2]};l[o]=f(q,j)}for(var o=i;o--;){var p=4*(k*i+o),r=l[o];switch(r){case 1:m.r=a[p+0],n.r=m.r,m.g=a[p+1],n.g=m.g,m.b=a[p+2],n.b=m.b;break;case-1:n.r=m.r,n.g=m.g,n.b=m.b;break;case 0:n.r=a[p+0],n.g=a[p+1],n.b=a[p+2]}o%i!==0?(c[p+0]=n.r,c[p+1]=n.g,c[p+2]=n.b,c[p+3]=255):(c[p+0]=a[p+0],c[p+1]=a[p+1],c[p+2]=a[p+2],c[p+3]=255)}}},i.drift_ud=function(a,c,d,e){function f(a,b){return a.r>=b.r-g&&a.r<=b.r+g?(b.swap=!b.swap,1):a.g>=b.g-g&&a.g<=b.g+g?(b.swap=!b.swap,1):a.b>=b.b-g&&a.b<=b.b+g?(b.swap=!b.swap,1):b.swap===!0?-1:0}var g=parseInt(d.threshold)||50,h=d.width,i=d.height,j=b(d.color)||{r:200,g:200,b:200};j.swap=!1;for(var k=0;h>k;k++){for(var l=[],m={},n={},o=0;i>o;o++){var p=4*(o*h+k),q={r:a[p+0],g:a[p+1],b:a[p+2]};l[o]=f(q,j)}for(var o=0;i>o;o++){var p=4*(o*h+k),r=l[o];switch(r){case 1:m.r=a[p+0],n.r=m.r,m.g=a[p+1],n.g=m.g,m.b=a[p+2],n.b=m.b;break;case-1:n.r=m.r,n.g=m.g,n.b=m.b;break;case 0:n.r=a[p+0],n.g=a[p+1],n.b=a[p+2]}o%i!==0?(c[p+0]=n.r,c[p+1]=n.g,c[p+2]=n.b,c[p+3]=255):(c[p+0]=a[p+0],c[p+1]=a[p+1],c[p+2]=a[p+2],c[p+3]=255)}}},i.drift_du=function(a,c,d,e){function f(a,b){return a.r>=b.r-i&&a.r<=b.r+i?(b.swap=!b.swap,1):a.g>=b.g-i&&a.g<=b.g+i?(b.swap=!b.swap,1):a.b>=b.b-i&&a.b<=b.b+i?(b.swap=!b.swap,1):b.swap===!0?-1:0}var g=d.width,h=d.height,i=parseInt(d.threshold)||50,j=b(d.color)||{r:200,g:200,b:200};j.swap=!1;for(var k=g;k--;){for(var l=[],m={},n={},o=h;o--;){var p=4*(o*g+k),q={r:a[p+0],g:a[p+1],b:a[p+2]};l[o]=f(q,j)}for(var o=h;o--;){var p=4*(o*g+k),r=l[o];switch(r){case 1:m.r=a[p+0],n.r=m.r,m.g=a[p+1],n.g=m.g,m.b=a[p+2],n.b=m.b;break;case-1:n.r=m.r,n.g=m.g,n.b=m.b;break;case 0:n.r=a[p+0],n.g=a[p+1],n.b=a[p+2]}o%h!==0?(a[p+0]=n.r,a[p+1]=n.g,a[p+2]=n.b,a[p+3]=255):(a[p+0]=a[p+0],a[p+1]=a[p+1],a[p+2]=a[p+2],a[p+3]=255)}}},i.step_drift=function(a,b,c){function e(b){var c={r:a[b+0]?a[b+0]:0,g:a[b+1]?a[b+1]:0,b:a[b+2]?a[b+2]:0};return c}function f(a,b){var c=0;return c=a>b-g&&b+g>a?a:b}var g=20,h=d(a),i={r:0,g:0,b:0},j=c.height,k=c.width,l=0,m=0;for(l=0;j>l;l++)for(m=0;k>m;m++){var n=l*k*4+4*m;i=e(n),h=e(n+4),b[n+0]=f(i.r,h.r),b[n+1]=f(i.g,h.g),b[n+2]=f(i.b,h.b),b[n+3]=255}},i.shadow_drift=function(a,c,d){function e(a,b){return a+4*b}function f(b,d,f){function g(b,c,d,f){var g=a[e(b,c)+d]?a[e(b,c)+d]*k:f*k;return g}var h=b.r+b.g+b.b;h>f.clip[0]?(c[d]=g(d,f.swing[0],f.thresh[0],f.def[0]),c[d+1]=g(d,f.swing[1],f.thresh[1],f.def[0]),c[d+2]=g(d,f.swing[2],f.thresh[2],f.def[0]),c[d+3]=255):h>f.clip[1]?(c[d]=g(d,f.swing[3],f.thresh[3],f.def[1]),c[d+1]=g(d,f.swing[4],f.thresh[4],f.def[1]),c[d+2]=g(d,f.swing[5],f.thresh[5],f.def[1]),c[d+3]=255):h>f.clip[2]?(c[d]=g(d,f.swing[6],f.thresh[6],f.def[2]),c[d+1]=g(d,f.swing[7],f.thresh[7],f.def[2]),c[d+2]=g(d,f.swing[8],f.thresh[8],f.def[2]),c[d+3]=255):(c[d]=g(d,f.swing[9],f.thresh[9],f.def[3]),c[d+1]=g(d,f.swing[10],f.thresh[10],f.def[3]),c[d+2]=g(d,f.swing[11],f.thresh[11],f.def[3]),c[d+3]=255)}function g(a,b){return a.r>=b.r-j&&a.r<=b.r+j?(b.swap=!b.swap,1):a.g>=b.g-j&&a.g<=b.g+j?(b.swap=!b.swap,1):a.b>=b.b-j&&a.b<=b.b+j?(b.swap=!b.swap,1):b.swap===!0?-1:0}var h,i,j=50,k=d.depth,h=d.height,i=d.width,l=b(d.color)||{r:200,g:200,b:200};l.swap=!1;for(var m={thresh:[0,1,2,0,1,2,0,1,2,0,1,2],swing:[5,5,5,10,10,10,15,15,15,20,20,20],clip:[100,200,400],def:[100,200,15,15]},n={thresh:[0,1,2,0,1,2,0,1,2,0,1,2],swing:[-5,-5,-5,-10,-10,-10,-15,-15,-15,-20,-20,-20],clip:[100,200,400],def:[100,200,15,15]},o={thresh:[0,1,2,0,1,2,0,1,2,0,1,2],swing:[0,0,0,0,0,0,0,0,0,0,0,0],clip:[150,300,500],def:[150,150,150,150]},p=0;h>p;p++){for(var q=[],r=0;i>r;r++){var s=p*i*4+4*r,t={r:a[s+0],g:a[s+1],b:a[s+2]};q[r]=g(t,l)}for(var r=0;i>r;r++){var s=p*i*4+4*r,u=q[r],v={r:a[s],g:a[s+1],b:a[s+2],a:a[s+3]};switch(u){case 1:f(v,s,m);break;case 0:f(v,s,o);break;case-1:f(v,s,n)}a[s+3]=255}}},i.random_drift=function(a,b,c){function d(a,b){return a+4*b}function e(c,e,f){function g(b,c,e,f){var g=a[d(b,c)+e]?a[d(b,c)+e]*h:f*h;return g}var i=c.r+c.g+c.b;i>f.clip[0]?(b[e]=g(e,f.swing[0],f.thresh[0],f.def[0]),b[e+1]=g(e,f.swing[1],f.thresh[1],f.def[0]),b[e+2]=g(e,f.swing[2],f.thresh[2],f.def[0]),b[e+3]=255):i>f.clip[1]?(b[e]=g(e,f.swing[3],f.thresh[3],f.def[1]),b[e+1]=g(e,f.swing[4],f.thresh[4],f.def[1]),b[e+2]=g(e,f.swing[5],f.thresh[5],f.def[1]),b[e+3]=255):i>f.clip[2]?(b[e]=g(e,f.swing[6],f.thresh[6],f.def[2]),b[e+1]=g(e,f.swing[7],f.thresh[7],f.def[2]),b[e+2]=g(e,f.swing[8],f.thresh[8],f.def[2]),b[e+3]=255):(b[e]=g(e,f.swing[9],f.thresh[9],f.def[3]),b[e+1]=g(e,f.swing[10],f.thresh[10],f.def[3]),b[e+2]=g(e,f.swing[11],f.thresh[11],f.def[3]),b[e+3]=255)}var f=c.height,g=c.width,h=c.depth,i={thresh:[0,1,2,0,1,2,0,1,2,0,1,2],swing:[5,5,5,10,10,10,15,15,15,20,20,20],clip:[100,200,400],def:[100,200,15,15]},j={thresh:[0,1,2,0,1,2,0,1,2,0,1,2],swing:[2,2,2,7,7,7,9,9,9,11,11,11],clip:[100,200,400],def:[100,200,15,15]},k={thresh:[0,1,2,0,1,2,0,1,2,0,1,2],swing:[-5,-5,-5,-10,-10,-10,-15,-15,-15,-20,-20,-20],clip:[100,200,400],def:[100,200,15,15]},l={thresh:[0,1,2,0,1,2,0,1,2,0,1,2],swing:[0,0,0,0,0,0,0,0,0,0,0,0],clip:[150,300,500],def:[150,150,150,150]},m=[[2,2,2,1,1,2,2,2,0,0,0,1,1,0,0,0,1,1,0,1,1,0,1,1,2,2,0,1,1,0,2,2,2,2,0,1,1,0,2,2,1,1,0,1,1,0,1,1,0,0,0,1,1,0,0,0,2,2,2,1,1,2,2,2],[2,2,1,1,1,1,2,2,0,0,1,1,1,1,0,0,1,1,0,1,1,0,1,1,2,2,0,1,1,0,2,2,2,2,0,1,1,0,2,2,1,1,0,1,1,0,1,1,0,0,1,1,1,1,0,0,2,2,1,1,1,1,2,2],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0],[0,0,0,1,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,1,0,0,0]],n=7,o=0,p=m.length-1,q=0,r=0,s=0,t=0;for(q=0;f>q;q++,o++)for(o>n&&(o=0),r=0;g>r;r++,s++){var u=q*g*4+4*r,v={r:a[u],g:a[u+1],b:a[u+2],a:a[u+3]};s>n&&(s=0);var w=m[t][o+s];switch(t=Math.floor(Math.random()*p),w){case 2:e(v,u,j);break;case 1:e(v,u,i);break;case 0:e(v,u,l);break;default:e(v,u,k)}}},i.ice=function(a,b,c){function d(a,b){return a+4*b}function e(c,e,g){function h(b,c,e,g){var h=a[d(b,c)+e]?a[d(b,c)+e]*f:g*f;return h}var i=c.r+c.g+c.b;i>g.clip[0]?(b[e]=h(e,g.swing[0],g.thresh[0],g.def[0]),b[e+1]=h(e,g.swing[1],g.thresh[1],g.def[0]),b[e+2]=h(e,g.swing[2],g.thresh[2],g.def[0]),b[e+3]=255):i>g.clip[1]?(b[e]=h(e,g.swing[3],g.thresh[3],g.def[1]),b[e+1]=h(e,g.swing[4],g.thresh[4],g.def[1]),b[e+2]=h(e,g.swing[5],g.thresh[5],g.def[1]),b[e+3]=255):i>g.clip[2]?(b[e]=h(e,g.swing[6],g.thresh[6],g.def[2]),b[e+1]=h(e,g.swing[7],g.thresh[7],g.def[2]),b[e+2]=h(e,g.swing[8],g.thresh[8],g.def[2]),b[e+3]=255):(b[e]=h(e,g.swing[9],g.thresh[9],g.def[3]),b[e+1]=h(e,g.swing[10],g.thresh[10],g.def[3]),b[e+2]=h(e,g.swing[11],g.thresh[11],g.def[3]),b[e+3]=255)}var f=c.depth,g=c.height,h=c.width,i={thresh:[0,1,2,0,1,2,0,1,2,0,1,2],swing:[5,5,5,10,10,10,15,15,15,20,20,20],clip:[100,200,400],def:[100,200,15,15]},j={thresh:[0,1,2,0,1,2,0,1,2,0,1,2],swing:[2,2,2,7,7,7,9,9,9,11,11,11],clip:[100,200,400],def:[100,200,15,15]},k={thresh:[0,1,2,0,1,2,0,1,2,0,1,2],swing:[-5,-5,-5,-10,-10,-10,-15,-15,-15,-20,-20,-20],clip:[100,200,400],def:[100,200,15,15]},l={thresh:[0,1,2,0,1,2,0,1,2,0,1,2],swing:[-3,-3,-3,-8,-8,-8,-11,-11,-11,-14,-14,-14],clip:[150,300,500],def:[150,150,150,150]},m={thresh:[0,1,2,0,1,2,0,1,2,0,1,2],swing:[0,0,0,0,0,0,0,0,0,0,0,0],clip:[150,300,500],def:[150,150,150,150]},n={thresh:[0,1,2,0,1,2,0,1,2,0,1,2],swing:[10,10,10,10,10,10,10,10,10,10,10,10],clip:[150,300,500],def:[150,150,150,150]},o=7,p=0,q=0,r=0,s=0,t=0;for(q=0;g>q;++q,++p)for(p>o&&(p=0),r=0;h>r;++r,++s){var u=4*(q*h+r),v={r:a[u],g:a[u+1],b:a[u+2],a:a[u+3]};s>o&&(s=0);var w=t=Math.floor(7*Math.random());switch(w){case 4:e(v,u,k);break;case 3:e(v,u,l);break;case 2:e(v,u,j);break;case 1:e(v,u,i);break;case 0:e(v,u,m);break;default:e(v,u,n)}}},i.chosh=function(a,b,c){function d(a,b){return a+4*b}function e(c,e,g){function h(b,c,e,g){var h=a[d(b,c)+e]?a[d(b,c)+e]*f:g*f;return h}var i=c.r+c.g+c.b;i>g.clip[0]?(b[e]=h(e,g.swing[0],g.thresh[0],g.def[0]),b[e+1]=h(e,g.swing[1],g.thresh[1],g.def[0]),b[e+2]=h(e,g.swing[2],g.thresh[2],g.def[0]),b[e+3]=255):i>g.clip[1]?(b[e]=h(e,g.swing[3],g.thresh[3],g.def[1]),b[e+1]=h(e,g.swing[4],g.thresh[4],g.def[1]),b[e+2]=h(e,g.swing[5],g.thresh[5],g.def[1]),b[e+3]=255):i>g.clip[2]?(b[e]=h(e,g.swing[6],g.thresh[6],g.def[2]),b[e+1]=h(e,g.swing[7],g.thresh[7],g.def[2]),b[e+2]=h(e,g.swing[8],g.thresh[8],g.def[2]),b[e+3]=255):(b[e]=h(e,g.swing[9],g.thresh[9],g.def[3]),b[e+1]=h(e,g.swing[10],g.thresh[10],g.def[3]),b[e+2]=h(e,g.swing[11],g.thresh[11],g.def[3]),b[e+3]=255)}var f=c.depth||1,g=c.height,h=c.width,i={thresh:[1,2,0,1,2,0,2,0,1,2,0,2],swing:[7,4,1,5,2,1,3,5,9,7,4,1],clip:[100,200,400],def:[100,200,15,15]},j=0,k=0;for(j=0;g>j;j++)for(k=0;h>k;k++){var l=j*h*4+4*k,m={r:a[l],g:a[l+1],b:a[l+2],a:a[l+3]};e(m,l,i)}},i.swish=function(a,b,c){function d(a,b){return a+4*b}function e(c,e,g){function h(b,c,e,g){var h=a[d(b,c)+e]?a[d(b,c)+e]*f:g*f;return h}var i=c.r+c.g+c.b;i>g.clip[0]?(b[e]=h(e,g.swing[0],g.thresh[0],g.def[0]),b[e+1]=h(e,g.swing[1],g.thresh[1],g.def[0]),b[e+2]=h(e,g.swing[2],g.thresh[2],g.def[0]),b[e+3]=255):i>g.clip[1]?(b[e]=h(e,g.swing[3],g.thresh[3],g.def[1]),b[e+1]=h(e,g.swing[4],g.thresh[4],g.def[1]),b[e+2]=h(e,g.swing[5],g.thresh[5],g.def[1]),b[e+3]=255):i>g.clip[2]?(b[e]=h(e,g.swing[6],g.thresh[6],g.def[2]),b[e+1]=h(e,g.swing[7],g.thresh[7],g.def[2]),b[e+2]=h(e,g.swing[8],g.thresh[8],g.def[2]),b[e+3]=255):(b[e]=h(e,g.swing[9],g.thresh[9],g.def[3]),b[e+1]=h(e,g.swing[10],g.thresh[10],g.def[3]),b[e+2]=h(e,g.swing[11],g.thresh[11],g.def[3]),b[e+3]=255)}for(var f=c.depth||1,g=c.height,h=c.width,i={thresh:[0,1,2,0,1,2,0,1,2,0,1,2],swing:[5,5,5,10,10,10,-10,-10,-10,-5,-5,-5],clip:[150,300,500],def:[150,150,150,150]},j=0,k=0,j=0;g>j;j++){var l=Math.floor(c.height/c.width*j),m=Math.floor(c.height/c.width*(2*j)),n=Math.floor(c.height/c.width*(4*j)),o=Math.floor(c.height/c.width*(8*j));i.swing[0]=i.swing[1]=i.swing[2]=Math.max(l,c.width),i.swing[3]=i.swing[4]=i.swing[5]=Math.max(m,c.width),i.swing[6]=i.swing[7]=i.swing[8]=Math.max(n,c.width),i.swing[9]=i.swing[10]=i.swing[11]=Math.max(o,c.width);for(var k=0;h>k;k++){var p=j*h*4+4*k,q={r:a[p],g:a[p+1],b:a[p+2],a:a[p+3]};e(q,p,i)}}},i.gradient_blur=function(a,b,c){function d(a,b,c,d,e,f,g,h,i){return{r:(a.r+b.r+c.r+d.r+e.r+f.r+g.r+h.r+i.r)/9,g:(a.g+b.g+c.g+d.g+e.g+f.g+g.g+h.g+i.g)/9,b:(a.b+b.b+c.b+d.b+e.b+f.b+g.b+h.b+i.b)/9}}function e(b){var c={r:a[b-4],g:a[b-3],b:a[b-2]},e={r:a[b+0],g:a[b+1],b:a[b+2]},f={r:a[b+4],g:a[b+5],b:a[b+6]},h={r:a[b-4+4*g],g:a[b-3+4*g],b:a[b-2+4*g]},i={r:a[b+0+4*g],g:a[b+1+4*g],b:a[b+2+4*g]},j={r:a[b+4+4*g],g:a[b+5+4*g],b:a[b+6+4*g]},k={r:a[b-4-4*g],g:a[b-3-4*g],b:a[b-2-4*g]},l={r:a[b+0-4*g],g:a[b+1-4*g],b:a[b+2-4*g]},m={r:a[b+4-4*g],g:a[b+5-4*g],b:a[b+6-4*g]};return d(c,e,f,h,i,j,k,l,m)}var f=c.height,g=c.width,h=0,i=0;for(h=0;f>h;h++)for(i=0;g>i;i++){var j=4*(h*g+i),k=e(j);b[j+0]=k.r?k.r:a[j+0],b[j+1]=k.g?k.g:a[j+1],b[j+2]=k.b?k.b:a[j+2],b[j+3]=255}},i.bubblegum=function(a,b,c){for(var d=2,e=0;e<a.length;)b[e++]=a[e]>245?a[e]:(a[e]+153)/2>>>0,b[e++]=a[e+d]>55?a[e+d]+0:(a[e+d]+85)/2>>>0,b[e++]=a[e+d]>125?a[e+d]+0:(a[e+d]+102)/2>>>0,b[e++]=255;for(var e=0;e<a.length;)b[e++]=b[e]>245?b[e]+0:b[e]+2457,b[e++]=b[e+d]>55?b[e+d]+0:b[e+d]+1365,b[e++]=b[e+d]>125?b[e+d]+0:b[e+d]+1638,b[e++]=255},i.artefact=function(a,b,c){for(var d,e=a.length,f=3,g=0;e>g;)d=a[g]+a[g+1]+a[g+2],1&d?d>300?(b[g++]=1&a[g]?a[g]^a[g]*f:a[g]*f,b[g++]=1&a[g]?a[g]^a[g]*f:a[g]*f,b[g++]=1&a[g]?a[g]^a[g]*f:a[g]*f,b[g++]=255):(b[g++]=1&a[g]?a[g]^a[g]*f:a[g]*f,b[g++]=1&a[g]?a[g]^a[g]*f:a[g]*f,b[g++]=1&a[g]?a[g]^a[g]*f:a[g]*f,b[g++]=255):(b[g++]=~a[g]*f,b[g++]=~a[g-1]*f,b[g++]=~a[g-2]*f,b[g++]=255)},i.draw=function(a,b,c,e){for(var e=e||a,f=a.length,g=0,h=d(e);f>g;)b[++g]=e[++g]>h[0]?a[g++]>>a[g+1]:a[g],b[++g]=e[++g]>h[1]?a[g++]>>a[g+1]:a[g],b[++g]=e[++g]>h[2]?a[g++]>>a[g+1]:a[g],b[++g]=255},i.draws=function(a,c,e,f){for(var e=e||{},g=(e.depth||1,b(e.color)),h=g.r||255,i=g.g||255,j=g.b||255,f=f||a,k=0,l=0,m=a.length,n=d(a);m>k;)c[l++]=f[++k]>n[0]?a[++k]>>a[k+1]:a[k++]||h,c[l++]=f[++k]>n[1]?a[++k]>>a[k+1]:a[k++]||i,c[l++]=f[++k]>n[2]?a[++k]>>a[k+1]:a[k++]||j,c[l++]=255,k>l&&(k=l)},i.daw=function(a,c,e){for(var e=e||{},f=(e.depth||1,b(e.color)),g=(f.r||255,f.g||255,f.b||255,0),h=a.length,i=d(a);h>g;)c[g++]=a[g]>i[0]?a[g]>>a[g+1]:a[g],c[g++]=a[g]>i[1]?a[g]>>a[g+1]:a[g],c[g++]=a[g]>i[2]?a[g]>>a[g-1]:a[g],c[g++]=255},
i.colorsplash=function(a,b,c){for(var c=c||{},d=c.depth||1,e=c.noise||!1,f=a.length,g=0;f>g;)a[g]+a[g+1]+a[g+2]&1?(b[g++]=1&a[g]?a[g]^a[g]:a[g]*d,b[g++]=1&a[g]?a[g]^a[g]:a[g]*d,b[g++]=1&a[g]?a[g]^a[g]:a[g]*d,b[g++]=255):e?(b[g++]=a[g],b[g++]=a[g-1],b[g++]=a[g-2],b[g++]=255):(b[g++]=a[g]+1&1?a[g]^a[g]:Math.floor(a[g]*d),b[g++]=a[g]+1&1?a[g]^a[g]:Math.floor(a[g]*d),b[g++]=a[g]+1&1?a[g]^a[g]:Math.floor(a[g]*d),b[g++]=255)},i.deteriorate=function(a,b,c){for(var c=c||{},d=c.depth||1,e=c.noise||!1,f=a.length,g=0;f>g;)a[g]+a[g+1]+a[g+2]&!1?(b[g++]=void 0!==a[4*g]?a[g]^a[g]:a[g]*d,b[g++]=void 0!==a[8*g]?a[g]^a[g]:a[g]*d,b[g++]=void 0!==a[16*g]?a[g]^a[g]:a[g]*d,b[g++]=255):e?(b[g++]=a[g],b[g++]=a[g-1],b[g++]=a[g-2],b[g++]=255):(b[g++]=a[g]+1&1?a[g]^a[g]:Math.floor(a[g]*d),b[g++]=a[g]+1&1?a[g]^a[g]:Math.floor(a[g]*d),b[g++]=a[g]+1&1?a[g]^a[g]:Math.floor(a[g]*d),b[g++]=255)},i.lope=function(a,c,d){for(var d=d||{},e=(d.depth||1,b(d.color)),f=e.r||255,g=e.g||255,h=e.b||255,i=[],j=0;j<a.length;)i.push([a[j+0],a[j+1],a[j+2],a[j+3]]),j+=4;var k=0;i.forEach(function(b,c,d){b[0]+b[1]+b[2]>100?(a[k++]=d[c+7]&&d[c+7][1]||100,a[k++]=d[c+4]&&d[c+4][2]||100,a[k++]=d[c+1]&&d[c+1][0]||100,a[k++]=255):b[0]+b[1]+b[2]>200?(a[k++]=d[c+5]&&d[c+5][1]||200,a[k++]=d[c+2]&&d[c+2][2]||200,a[k++]=d[c+1]&&d[c+1][0]||200,a[k++]=255):b[0]+b[1]+b[2]<50&&b[0]+b[1]+b[2]>400?(a[k++]=d[c+3]&&d[c+3][2]||15,a[k++]=d[c+5]&&d[c+5][0]||15,a[k++]=d[c+9]&&d[c+9][1]||15,a[k++]=255):(a[k++]=d[c+7]&&d[c+7][2]||15,a[k++]=d[c+4]&&d[c+4][0]||15,a[k++]=d[c+1]&&d[c+1][2]||15,a[k++]=255)});var k=0;i.forEach(function(b,c,d){b[0]+b[1]+b[2]>600?(a[++k]=b[0],a[++k]=b[1],a[++k]=b[2]):b[0]+b[1]+b[2]>400?(a[++k]=(b[0]+f)/2,a[++k]=(b[1]+g)/2,a[++k]=(b[2]+h)/2,a[++k]=255):b[0]+b[1]+b[2]>200?(a[k++]=a[k-11]+5,a[k++]=a[k-10]+5,a[k++]=a[k-9]+5,a[k++]=255):(a[++k]=a[k+0],a[++k]=a[k+0],a[++k]=a[k+0],a[++k]=255)})},i.xopeblend=function(a,b,c,d){for(var c=c||{},e=c.noise||!1,f=c.height,g=c.width,d=d||a,h=0;f>h;h++)for(var i=0;g>i;i++){var j=h*g*4+4*i,k={r:d[j],g:d[j+1],b:d[j+2]},l=k.r+k.b+k.b;i%(g-1)!==0&&(l>600?(b[j+0]=a[j+0],b[j+1]=a[j+1],b[j+2]=a[j+2],b[j+3]=255):l>400?(b[j+0]=a[j+0-8]||a[j+4],b[j+1]=a[j+1-8]||a[j+5],b[j+2]=a[j+2-8]||a[j+6],b[j+3]=255):l>200?(b[j+0]=a[j+0-8]||a[j+0],b[j+1]=a[j+1-8]||a[j+1],b[j+2]=a[j+2-8]||a[j+2],b[j+3]=255):1==e?(b[j+0]=255-a[j+4],b[j+1]=255-a[j+5],b[j+2]=255-a[j+6],b[j+3]=255):(b[j+0]=a[j+4],b[j+1]=a[j+5],b[j+2]=a[j+6],b[j+3]=255))}},i.drot=function(a,c,d,e){for(var d=d||{},f=d.depth||1,e=e||a,g=b(d.color),h=g.r||255,i=g.g||255,j=g.b||255,k=a.length,l=0;k>l;l++){var m=4*l,n=[e[m+0],e[m+1],e[m+2],e[m+3]];n[0]+n[1]+n[2]>600?(c[m+0]=0*f,c[m+1]=0*f,c[m+2]=0*f,c[m+3]=255):n[0]+n[1]+n[2]>400?(c[m+0]=h*f,c[m+1]=i*f,c[m+2]=j*f,c[m+3]=255):n[0]+n[1]+n[2]>200?(c[m+0]=a[m-4]+5*f,c[m+1]=a[m-4]+5*f,c[m+2]=a[m-4]+5*f,c[m+3]=255):(c[m+0]=a[m]+1*f,c[m+1]=a[m]+1*f,c[m+2]=a[m]+1*f,c[m+3]=255)}},i.minx=function(a,b,c){for(var c=c||{},d=c.depth||1,e=a.length,f=0;e>f;f++){var g=4*f,h=[a[g+0],a[g+1],a[g+2],a[g+3]];h[0]+h[1]+h[2]>100?(b[g+0]=(a[g+7*g]&&a[g*(7*g)+1])*d||100*d,b[g+1]=(a[g+4*g]&&a[g*(4*g)+2])*d||100*d,b[g+2]=(a[g+2*g]&&a[g*(1*g)+1])*d||100*d,b[g+3]=255):h[0]+h[1]+h[2]>200?(b[g+0]=(a[g+5*g]&&a[g+5*g+1])*d||200*d,b[g+1]=(a[g+2*g]&&a[g+2*g+2])*d||200*d,b[g+2]=(a[g+1*g]&&a[g+1*g+0])*d||200*d,b[g+3]=255):h[0]+h[1]+h[2]<50&&h[0]+h[1]+h[2]>400?(b[g+0]=(a[g+3*g]&&a[g+3*g+2])*d||15*d,b[g+1]=(a[g+5*g]&&a[g+5*g+0])*d||15*d,b[g+2]=(a[g+9*g]&&a[g+9*g+1])*d||15*d,b[g+3]=255):(b[g+0]=(a[g+7*g]&&a[g+7*g+2])*d||15*d,b[g+1]=(a[g+4*g]&&a[g+4*g+0])*d||15*d,b[g+2]=(a[g+1*g]&&a[g+1*g+2])*d||15*d,b[g+3]=255)}},i.highcontrast=function(a,c,d){for(var d=d||{},e=(d.gamma||1,d.offset||0,b(d.color)),f=e.r||255,g=e.g||204,h=e.b||255,i=d.height,j=d.width,k=0;i>k;k++)for(var l=0;j>l;l++){var m=k*j*4+4*l,n=[a[m+0],a[m+1],a[m+2]];n[0]+n[1]+n[2]>400?(c[m+0]=a[m+0]+f,c[m+1]=a[m+1]+g,c[m+2]=a[m+2]+h,c[m+3]=255):(c[m+0]=~a[m+0],c[m+1]=~a[m+1],c[m+2]=~a[m+2],c[m+3]=255)}},i.ranebowe=function(a,c,d){var e,f,g,d=d||{},h=(d.gamma||1,d.offset||0,b(d.color)),i=(h.r||255,h.g||255,h.b||255,d.height),j=d.width;e=2*Math.PI/255,g={r:0,g:0,b:0};for(var k=0;i>k;k++){f=0;for(var l=0;j>l;l++){var m=k*j*4+4*l,n={r:a[m],g:a[m+1],b:a[m+2],a:a[m+3]};g.r=k,g.g=Math.floor(255*(Math.sin(f)/2+.5)),g.b=Math.floor(255*(Math.cos(f)/2+.5)),c[m]=n.r+g.r&255,c[m+1]=n.g+g.g&255,c[m+2]=n.b+g.b&255,c[m+3]=255}}},i.olroloc=function(a,c,d){for(var d=d||{},e=d.depth||1,f=b(d.color),g=f.r||255,h=f.g||255,i=f.b||255,j=d.height,k=d.width,l=0;j>l;l++)for(var m=0;k>m;m++){var n=l*k*4+4*m;c[n+0]=a[n+0]/g*e*(l+m)>>>0,c[n+1]=a[n+1]/h*e*(l+m)>>>0,c[n+2]=a[n+2]/i*e*(l+m)>>>0,c[n+3]=255}},i.mixcolor=function(a,c,d){for(var e=b(d.color),f=e.r||255,g=e.g||255,h=e.b||255,i=d.height,j=d.width,k=0;i>k;++k)for(var l=0;j>l;++l){var m=4*(k*j+l);a[m]=Math.ceil((a[m]+f)/2),a[m+1]=Math.ceil((a[m+1]+g)/2),a[m+2]=Math.ceil((a[m+2]+h)/2),a[m+3]=255}},i.inverse=function(a,b,c){for(var d=0,e=a.length;e>d;d+=4)b[d]=255-a[d],b[d+1]=255-a[d+1],b[d+2]=255-a[d+2]},i.rever=function(a,c,d){for(var d=d||{},e=d.gamma||1,f=(d.offset||0,b(d.color)),g=(f.r||255,f.g||255,f.b||255,a.length),h=new Uint8Array(g),i=0;g>i;)h[g-i]=a[++i+5],h[g-i]=a[++i+3],h[g-i]=a[++i+3],h[g-i]=a[++i+3];for(var i=0;g>i;)c[i+2]=1&i?h[++i+1]*e:h[++i+1]*e,c[i]=1&i?h[++i+2]*e:h[++i-2]*e,c[i+2]=1&i?h[++i+3]*e:h[++i-4]*e,c[i+2]=1&i?h[++i+3]*e:h[++i-4]*e},i.reversi=function(a,b,c){for(var d=(c.depth||1,c.colorR||200,c.colorG||200,c.colorB||200,a.length),e=0;d>e;)b[d-e]=a[++e+4],b[d-e]=a[++e+2],b[d-e]=a[++e+3],b[d-e]=a[++e+2]},i.isreversi=function(a,b,c){for(var d=(c.depth||1,c.height),e=c.width,f=a.length,g=0;d>g;g++)for(var h=0;e>h;h++){var i=4*(g*e+h);b[--f]=a[i+3],b[--f]=a[i+2],b[--f]=a[i+1],b[--f]=a[i+0]}},i.mirror_top_to_bottom=function(a,b,c){for(var d=(a.length,c.height),e=c.width,f=Math.round(d/2),g=0;d>g;g++)for(var h=0;e>h;h++){var i=4*(g*e+h);g>f?(b[i+0]=a[(d-g)*e*4+4*h+0],b[i+1]=a[(d-g)*e*4+4*h+1],b[i+2]=a[(d-g)*e*4+4*h+2],b[i+3]=255):(b[i+0]=a[i+0],b[i+1]=a[i+1],b[i+2]=a[i+2],b[i+3]=255)}},i.mirror_bottom_to_top=function(a,b,c){for(var d=(a.length,c.height),e=c.width,f=Math.round(d/2),g=0;d>g;g++)for(var h=0;e>h;h++){var i=4*(g*e+h);f>g?(b[i+0]=a[(d-g)*e*4+4*h+0],b[i+1]=a[(d-g)*e*4+4*h+1],b[i+2]=a[(d-g)*e*4+4*h+2],b[i+3]=255):(b[i+0]=a[i+0],b[i+1]=a[i+1],b[i+2]=a[i+2],b[i+3]=255)}},i.mirror_left_to_right=function(a,b,c){for(var d=(a.length,c.height),e=c.width,f=e/2,g=0;d>g;g++)for(var h=0;e>h;h++){var i=4*(g*e+h);h>f?(b[i+0]=a[g*e*4+4*(e-h)+0],b[i+1]=a[g*e*4+4*(e-h)+1],b[i+2]=a[g*e*4+4*(e-h)+2],b[i+3]=255):(b[i+0]=a[i+0],b[i+1]=a[i+1],b[i+2]=a[i+2],b[i+3]=255)}},i.mirror_right_to_left=function(a,b,c){for(var d=(a.length,c.height),e=c.width,f=e/2,g=0;d>g;g++)for(var h=0;e>h;h++){var i=4*(g*e+h);h>f?(b[i+0]=a[g*e*4+4*(e-h)+0],b[i+1]=a[g*e*4+4*(e-h)+1],b[i+2]=a[g*e*4+4*(e-h)+2],b[i+3]=255):(b[i+0]=a[i+0],b[i+1]=a[i+1],b[i+2]=a[i+2],b[i+3]=255)}},i.mirror_half_bottom_rl=function(a,b,c){for(var d=(a.length,c.height),e=c.width,f=d/2,g=0;d>g;g++)for(var h=0;e>h;h++){var i=4*(g*e+h);g>f?(b[i+0]=a[g*e*4+4*(e-h)+0],b[i+1]=a[g*e*4+4*(e-h)+1],b[i+2]=a[g*e*4+4*(e-h)+2],b[i+3]=255):(a[i+0]=a[i+0],a[i+1]=a[i+1],a[i+2]=a[i+2],a[i+3]=255)}},i.flip_left_half=function(a,b,c){for(var d=(a.length,c.height),e=c.width,f=Math.round(e/2),g=0;d>g;++g)for(var h=0;e>h;++h){var i=4*(g*e+h);f>h?(b[i+0]=a[(d-g)*e*4+4*h+0],b[i+1]=a[(d-g)*e*4+4*h+1],b[i+2]=a[(d-g)*e*4+4*h+2],b[i+3]=255):(b[i+0]=a[i+0],b[i+1]=a[i+1],b[i+2]=a[i+2],b[i+3]=255)}},i.flip_right_half=function(a,b,c){for(var d=(a.length,c.height),e=c.width,f=Math.round(e/2),g=0;d>g;++g)for(var h=0;e>h;++h){var i=4*(g*e+h);h>f?(b[i+0]=a[(d-g)*e*4+4*h+0],b[i+1]=a[(d-g)*e*4+4*h+1],b[i+2]=a[(d-g)*e*4+4*h+2],b[i+3]=255):(b[i+0]=a[i+0],b[i+1]=a[i+1],b[i+2]=a[i+2],b[i+3]=255)}},i.flip_bottom_half=function(a,b,c){for(var d=c.height,e=c.width,f=d/2,g=(a.length,0);d>g;++g)for(var h=0;e>h;++h){var i=4*(g*e+h);g>f?(b[i+0]=a[g*e*4+4*(e-h)+0],b[i+1]=a[g*e*4+4*(e-h)+1],b[i+2]=a[g*e*4+4*(e-h)+2],b[i+3]=255):(b[i+0]=a[i+0],b[i+1]=a[i+1],b[i+2]=a[i+2],b[i+3]=255)}},i.flip_top_half=function(a,b,c){for(var d=c.height,e=c.width,f=d/2,g=(a.length,0);d>g;++g)for(var h=0;e>h;++h){var i=4*(g*e+h);f>g?(b[i+0]=a[g*e*4+4*(e-h)+0],b[i+1]=a[g*e*4+4*(e-h)+1],b[i+2]=a[g*e*4+4*(e-h)+2],b[i+3]=255):(b[i+0]=a[i+0],b[i+1]=a[i+1],b[i+2]=a[i+2],b[i+3]=255)}},i.flip=function(a,b,c){for(var c=c||{},d=(c.gamma||1,a.length),e=new Uint8Array(d),f=0;d>f;)e[d-f]=a[++f+5],e[d-f]=a[++f+3],e[d-f]=a[++f+3],e[d-f]=a[++f+3];for(var f=0;d>f;)a[f]=e[++f+1],a[f]=e[++f+2],a[f]=e[++f+3],a[f]=255},i.flop=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,e=0;g>e;e++)for(var f=0;h>f;f++){var i=4*(e*h+f),j=4*(f*h+e);a[i],a[i+1],a[i+2];b[i]=a[j],b[i+1]=a[j+1],b[i+2]=a[j+2],b[i+3]=255}},i.mirrorup=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,e=0;g>e;e++)for(var f=0;h>f;f++){var i=4*(e*h+f),j=4*((g-e)*h+(h-f));a[i],a[i+1],a[i+2];b[i]=a[j],b[i+1]=a[j+1],b[i+2]=a[j+2],b[i+3]=255}},i.mirrorleft=function(a,b,c,d){for(var e,f,g=c.height,h=c.width,e=0;g>e;e++)for(var f=0;h>f;f++){var i=4*(e*h+f),j=4*(e*h+(h-f));a[i],a[i+1],a[i+2];b[i]=a[j],b[i+1]=a[j+1],b[i+2]=a[j+2],b[i+3]=255}},i.sickness=function(a,b,c,d){for(var e=.7,d=d||a,f=a.length,g=0;f>g;)d[g]+d[g+1]+d[g+2]&1?(b[g++]=~(1&d[g])?a[g]^a[g]*e:a[g]*e,b[g++]=~(1&d[g])?a[g]^a[g]*e:a[g]*e,b[g++]=~(1&d[g])?a[g]^a[g]*e:a[g]*e,b[g++]=255):(b[g++]=1&d[g]?a[g]^a[g]*e:a[g]*e,b[g++]=1&d[g]?a[g]^a[g]*e:a[g]*e,b[g++]=1&d[g]?a[g]^a[g]*e:a[g]*e,b[g++]=255)},i.staticsplash=function(a,b,c){for(var d=c.depth||1,e=a.length,f=0;e>f;)a[f]+a[f+1]+a[f+2]&1?(a[f++]=1&a[f]?a[f]^a[f]*d:a[f]*d,a[f++]=1&a[f]?a[f]^a[f]*d:a[f]*d,a[f++]=1&a[f]?a[f]^a[f]*d:a[f]*d,a[f++]=255):(a[f++]=a[f]*d,a[f++]=a[f-1]*d,a[f++]=a[f-2]*d,a[f++]=255)},i.brucsh=function(a,c,d){for(var e=d.depth||1,f=b(d.color),g=f.r||255,h=f.g||255,i=f.b||255,j=a.length,k=0;j>k;)c[k++]=~(1&a[k])?a[k]^g*e:a[k]*e,c[k++]=~(1&a[k])?a[k]^h*e:a[k]*e,c[k++]=~(1&a[k])?a[k]^i*e:a[k]*e,c[k++]=255},i.curse=function(a,c,d){for(var e=d.depth||1,f=b(d.color),g=f.r||255,h=f.g||255,i=f.b||255,j=0,k=a.length;k>j;)a[j]+a[j+1]+a[j+2]&1?(c[j++]=1&a[j]?a[j]^g*e:a[j]*e,c[j++]=1&a[j]?a[j]^h*e:a[j]*e,c[j++]=1&a[j]?a[j]^i*e:a[j]*e,c[j++]=255):(c[j++]=a[j]+1&1?a[j]^g:Math.floor(a[j]*e),c[j++]=a[j]+1&1?a[j]^h:Math.floor(a[j]*e),c[j++]=a[j]+1&1?a[j]^i:Math.floor(a[j]*e),c[j++]=255)},i.church=function(a,c,d){for(var e=d.depth||1,f=a.length,g=0,h=b(d.color),i=h.r||255,j=h.g||255,k=h.b||255;f>g;)a[g]+a[g+1]+a[g+2]&1?(c[g++]=1&a[g]?a[g]^i*e:a[g]*e,c[g++]=1&a[g]?a[g]^j*e:a[g]*e,c[g++]=1&a[g]?a[g]^k*e:a[g]*e,c[g++]=255):(c[g++]=a[g]*e,c[g++]=a[g-1]*e,c[g++]=a[g-2]*e,c[g++]=255)},i.lazer=function(a,b,c,d){function e(b){return b>d[i+4]?b:255|a[i+4]}var f=a.length,d=d||a,g=Math.ceil(f/4),h=f%4,i=0;do{switch(h){case 0:b[++i]=e(a[i]);case 3:b[++i]=e(a[i]);case 2:b[++i]=e(a[i]);case 1:b[++i]=e(a[i])}h=0}while(--g>0)},i.flazer=function(a,b,c){function d(b){return b>a[h+4]?b:255|a[h+4]}var e=a.length,f=Math.ceil(e/4),g=e%4,h=0;do{switch(g){case 0:b[++h]=d(a[h]);case 3:b[++h]=d(a[h]);case 2:b[++h]=d(a[h]);case 1:b[++h]=d(a[h])}g=0}while(--f>0)},i.slazer=function(a,b,c){function d(b){return b>a[h+4]?b:255&~(a[h+4]-a[h])}var e=a.length,f=Math.ceil(e/4),g=e%4,h=0;do{switch(g){case 0:b[++h]=d(a[h]);case 3:b[++h]=d(a[h]);case 2:b[++h]=d(a[h]);case 1:b[++h]=d(a[h])}g=0}while(--f>0)},i.sorto=function(a,b,c){function d(b){return b>a[h+4]?b+a[h+4]/2:a[h+4]-a[h]}var e=a.length,f=Math.ceil(e/4),g=e%4,h=0;do{switch(g){case 0:b[h++]=d(a[h]);case 3:b[h++]=d(a[h]);case 2:b[h++]=d(a[h]);case 1:b[h++]=255}g=0}while(--f>0)},i.roloc=function(a,b,c){for(var d=[],e=0,f=0;e<a.length;)d[f++]=[a[e+0],a[e+1],a[e+2],a[e+3]],e+=4;var f=0;d.forEach(function(a,c,d){a[0]>d[c][0]?(b[f-4]=a[0],b[f-8]=a[0],b[f++]=a[0]):b[f++]=d[c][0],a[1]>d[c][1]?(b[f-4]=a[1],b[f-8]=a[1],b[f++]=a[1]):b[f++]=d[c][0],a[2]>d[c][2]?(b[f-4]=a[2],b[f-8]=a[2],b[f++]=a[2]):b[f++]=d[c][2],b[f++]=255})},i.posht=function(a,b,c,d){for(var e=c.height,f=c.width,d=d||a,g=0;e>g;g++)for(var h=0;f>h;h++){var i=g*f*4+4*h,j={r:d[i],g:d[i+1],b:d[i+2]},k=j.r+j.b+j.b;h%(f-1)!==0?k>100&&h>20&&f>h+21?(b[i+0]=(a[i-76+1]+a[i-16+0])/2,b[i+1]=(a[i+80+2]+a[i-76+1])/2,b[i+2]=(a[i-16+0]+a[i+80+2])/2,b[i+3]=255):k>50&&h>20&&f>h+21?(b[i+0]=(a[i-52+2]+a[i-52+2])/2,b[i+1]=(a[i+60+0]+a[i+16+1])/2,b[i+2]=(a[i+16+1]+a[i+60+0])/2,b[i+3]=255):h>11&&f>h+11?(b[i+0]=(a[i+28+2]+a[i+16+0])/2,b[i+1]=(a[i+16+0]+a[i+28+2])/2,b[i+2]=(a[i-40+1]+a[i-40+1])/2,b[i+3]=255):(b[i+0]=(a[i+0]+a[i+1])/2,b[i+1]=(a[i+1]+a[i+2])/2,b[i+2]=(a[i+2]+a[i+0])/2,b[i+3]=255):(b[i+0]=a[i+0],b[i+1]=a[i+1],b[i+2]=a[i+2],b[i+3]=255)}},i.losht=function(a,b,c,d){for(var e=c.height,f=c.width,d=d||a,g=0;e>g;g++)for(var h=0;f>h;h++){var i=4*(g*f+h),j={r:d[i],g:d[i+1],b:d[i+2]},k=j.r+j.b+j.b;h%(f-1)!==0?k>100&&h>20&&f>h+21?(b[i+0]=(a[i-76+1]+a[i-80+0])/2,b[i+1]=(a[i+80+2]+a[i-16+1])/2,b[i+2]=(a[i-16+0]+a[i+76+2])/2,b[i+3]=255):k>50&&h>20&&f>h+21?(b[i+0]=(a[i-52+2]+a[i-60+2])/2,b[i+1]=(a[i+60+0]+a[i+16+1])/2,b[i+2]=(a[i+16+1]+a[i+52+0])/2,b[i+3]=255):h>11&&f>h+11?(b[i+0]=(a[i+28+2]+a[i+16+0])/2,b[i+1]=(a[i+16+0]+a[i+40+2])/2,b[i+2]=(a[i-40+1]+a[i-28+1])/2,b[i+3]=255):(b[i+0]=(a[i+0]+a[i+1])/2,b[i+1]=(a[i+1]+a[i+2])/2,b[i+2]=(a[i+2]+a[i+0])/2,b[i+3]=255):(b[i+0]=a[i+0],b[i+1]=a[i+1],b[i+2]=a[i+2],b[i+3]=255)}},i.fosht=function(a,b,c,d){for(var e=c.height,f=c.width,d=d||a,g=0;e>g;g++)for(var h=0;f>h;h++){var i=4*(g*f+h),j={r:d[i],g:d[i+1],b:d[i+2]},k=j.r+j.b+j.b;h%(f-1)!==0?k>100&&h>20&&f>h+21?(b[i+0]=(a[i-76+1]+a[i-16+0])/2,b[i+1]=(a[i+80+2]+a[i-76+1])/2,b[i+2]=(a[i-16+0]+a[i+80+2])/2,b[i+3]=255):k>50&&h>20&&f>h+21?(b[i+0]=(a[i-52+2]+a[i+16+1])/2,b[i+1]=(a[i+60+0]+a[i-52+2])/2,b[i+2]=(a[i+16+1]+a[i+60+0])/2,b[i+3]=255):h>11&&f>h+10?(b[i+0]=(a[i+28+2]+a[i-40+1])/2,b[i+1]=(a[i+16+0]+a[i+28+2])/2,b[i+2]=(a[i-40+1]+a[i+16+0])/2,b[i+3]=255):(b[i+0]=(a[i+0]+a[i+2])/2,b[i+1]=(a[i+1]+a[i+0])/2,b[i+2]=(a[i+2]+a[i+1])/2,b[i+3]=255):(b[i+0]=a[i+0],b[i+1]=a[i+1],b[i+2]=a[i+2],b[i+3]=255)}},i.smosht=function(a,b,c,d){for(var e=c.height,f=c.width,d=d||a,g=0;e>g;g++)for(var h=0;f>h;h++){var i=g*f*4+4*h,j={r:d[i],g:d[i+1],b:d[i+2]},k=j.r+j.b+j.b;h%(f-1)!==0?k>100?(b[i+0]=a[i-76+1]||255,b[i+1]=a[i+80+2]||0,b[i+2]=a[i-16+0]||255,b[i+3]=255):k>50?(b[i+0]=a[i-52+2]||255,b[i+1]=a[i+60+0]||255,b[i+2]=a[i+16+1]||0,b[i+3]=255):(b[i+0]=a[i+28+2]||0,b[i+1]=a[i+16+0]||255,b[i+2]=a[i-40+1]||255,b[i+3]=255):(b[i+0]=a[i+0],b[i+1]=a[i+1],b[i+2]=a[i+2],b[i+3]=255)}},i.slosh=function(a,c,d){for(var e=d.height,f=d.width,g=b(d.color),h=(g.r||255,g.g||255,g.b||255,0);e>h;h++)for(var i=0;f>i;i++){var j=h*f*4+4*i,k={r:a[j],g:a[j+1],b:a[j+2]},l=k.r+k.b+k.b;i%(f-1)!==0?l>100?(c[j+0]=a[j-76+1]||255,c[j+1]=a[j+80+2]||0,c[j+2]=a[j-16+0]||255,c[j+3]=255):l>50?(c[j+0]=a[j-52+2]||255,c[j+1]=a[j+60+0]||255,c[j+2]=a[j+16+1]||0,c[j+3]=255):(c[j+0]=a[j+28+2]||0,c[j+1]=a[j+16+0]||255,c[j+2]=a[j-40+1]||255,c[j+3]=255):(c[j+0]=a[j+0],c[j+1]=a[j+1],c[j+2]=a[j+2],c[j+3]=255)}},i.smoshz=function(a,b,c){for(var d=c.height,e=c.width,f=0;d>f;++f)for(var g=0;e>g;++g){var h=f*e*4+4*g,i={r:a[h],g:a[h+1],b:a[h+2]},j=i.r+i.b+i.b;g%(e-1)!==0?j>100?(b[h+0]=a[h-76+0]||255,b[h+1]=a[h+80+1]||0,b[h+2]=a[h-16+2]||255,b[h+3]=255):j>50?(b[h+0]=a[h-52+0]||255,b[h+1]=a[h+60+1]||255,b[h+2]=a[h+16+2]||0,b[h+3]=255):(b[h+0]=a[h+28+0]||0,b[h+1]=a[h+16+1]||255,b[h+2]=a[h-40+2]||255,b[h+3]=255):(b[h+0]=a[h+0],b[h+1]=a[h+1],b[h+2]=a[h+2],b[h+3]=255)}},i.slip_stream=function(a,b,c){for(var d,e=c.height,f=c.width,g=0;e>g;++g)for(var h=0;f>h;++h)d=4*(g*f+h),b[d]=a[d-3]+5,b[d+1]=a[d-2]+5,b[d+2]=a[d-1]+5,b[d+3]=255},i.sleep=function(a,c,d){for(var e,f,g=d.height,h=d.width,i=b(d.color),j=i.r||255,k=i.g||255,l=i.b||255,m=0;g>m;++m)for(var n=0;h>n;++n)e=4*(m*h+n),f=a[e]+a[e+1]+a[2],f>100&&h>n+7?(c[e]=a[e+29]||100,c[e+1]=a[e+18]||100,c[e+2]=a[e+4]||100,c[e+3]=255):50>f&&h>n+7?(c[e]=a[e+21]||200,c[e+1]=a[e+10]||200,c[e+2]=a[e+4]||200,c[e+3]=255):(c[e]=a[e+30]||15,c[e+1]=a[e+16]||15,c[e+2]=a[e+6]||15,c[e+3]=255);for(var m=0;g>m;++m)for(var n=0;h>n;++n)e=4*(m*h+n),f=a[e]+a[e+1]+a[2],f>600?(c[e]=255,c[e+1]=255,c[e+2]=255,c[e+3]=255):f>400?(c[e]=j,c[e+1]=k,c[e+2]=l,c[e+3]=255):f>200?(c[e]=c[e-3]+5,c[e+1]=c[e-2]+5,c[e+2]=c[e-1]+5,c[e+3]=255):(c[e]=c[e+1]+1,c[e+1]=c[e+2]+1,c[e+2]=c[e+3]+1,c[e+3]=255)},i.stalt=function(a,c,d,e){for(var f=d.height,g=d.width,h=b(d.color),i=h.r||255,j=h.g||255,k=h.b||255,e=e||a,l=f;--l;)for(var m=g;--m;){var n=l*g*4+4*m,o=e[n+0]+e[n+1]+e[n+2];m%(g-1)!==0&&m!==g?o>600?(c[n+0]=0,c[n+1]=0,c[n+2]=0,c[n+3]=255):o>400?(c[n+0]=i,c[n+1]=j,c[n+2]=k,c[n+3]=255):o>200?(c[n+0]=a[n+28-3]||105,c[n+1]=a[n+16-2]||105,c[n+2]=a[n+4-1]||105,c[n+3]=255):o>100?(c[n+0]=a[n+28+1]||100,c[n+1]=a[n+16+2]||100,c[n+2]=a[n+4+0]||100,c[n+3]=255):o>50?(c[n+0]=a[n+12+2]||15,c[n+1]=a[n+20+0]||15,c[n+2]=a[n+36+1]||15,c[n+3]=255):(c[n+0]=a[n+28+2]||15,c[n+1]=a[n+16+0]||15,c[n+2]=a[n+4+2]||15,c[n+3]=255):(c[n+0]=a[n+0],c[n+1]=a[n+1],c[n+2]=a[n+2],c[n+3]=255)}},i.bonk=function(a,b,c){for(var d=[],e=a.length,f=0,g=0;e>f;)d[g++]=[a[f+0],a[f+1],a[f+2],a[f+3]],f+=4;var g=0;d.forEach(function(a,c,d){a[0]+a[1]+a[2]>100?(b[g++]=d[c+7]&&d[c+7][1]||100,b[g++]=d[c+4]&&d[c+4][2]||100,b[g++]=d[c+1]&&d[c+1][0]||100,b[g++]=255):a[0]+a[1]+a[2]>200?(b[g++]=d[c+5]&&d[c+5][1]||200,b[g++]=d[c+2]&&d[c+2][2]||200,b[g++]=d[c+1]&&d[c+1][0]||200,b[g++]=255):a[0]+a[1]+a[2]<50&&a[0]+a[1]+a[2]>400?(b[g++]=d[c+3]&&d[c+3][2]||15,b[g++]=d[c+5]&&d[c+5][0]||15,b[g++]=d[c+9]&&d[c+9][1]||15,b[g++]=255):(b[g++]=d[c+7]&&d[c+7][2]||15,b[g++]=d[c+4]&&d[c+4][0]||15,b[g++]=d[c+1]&&d[c+1][2]||15,b[g++]=255)})},i.blink=function(a,b,c){for(var d=[],e=a.length,f=0,g=0;e>f;)d[g++]=[a[f+0],a[f+1],a[f+2],a[f+3]],f+=4;var g=0;d.forEach(function(a,c,d){a[0]+a[1]+a[2]>100?(b[g++]=d[c+17]&&d[c+17][1]||100,b[g++]=d[c-14]&&d[c-14][2]||100,b[g++]=d[c+10]&&d[c+10][0]||100,b[g++]=255):a[0]+a[1]+a[2]>200?(b[g++]=d[c+20]&&d[c+20][1]||200,b[g++]=d[c-7]&&d[c-7][2]||200,b[g++]=d[c+12]&&d[c+12][0]||200,b[g++]=255):a[0]+a[1]+a[2]<50&&a[0]+a[1]+a[2]>400?(b[g++]=d[c+3]&&d[c+3][2]||15,b[g++]=d[c-5]&&d[c-5][0]||15,b[g++]=d[c+9]&&d[c+9][1]||15,b[g++]=255):(b[g++]=d[c+4]&&d[c+4][2]||15,b[g++]=d[c+4]&&d[c+4][0]||15,b[g++]=d[c+11]&&d[c+11][2]||15,b[g++]=255)})},i.blosh=function(a,d,e){for(var f=[],g=a.length,h=0,i=0,j=b(e.color),k=j.r||255,l=j.g||255,m=j.b||255;g>h;)f[++i]=[a[h+0],a[h+1],a[h+2],a[h+3]],h+=4;var i=0;f.forEach(function(a,b,e){var f=c(a);d[i]=f[2],d[i+1]=f[2],d[i+2]=f[2],d[i+3]=f[3],i+=4});for(var h=0,i=0;g>h;)f[++i]=[d[h+0],d[h+1],d[h+2],d[h+3]],h+=4;var i=0;f.forEach(function(a,b,c){a[0]+a[1]+a[2]>100?(d[i++]=a[0],d[i++]=a[0],d[i++]=a[0],d[i++]=a[3]):a[0]+a[1]+a[2]>200?(d[i++]=a[1],d[i++]=a[1],d[i++]=a[1],d[i++]=a[3]):a[0]+a[1]+a[2]<50&&a[0]+a[1]+a[2]>400?(d[i++]=a[0],d[i++]=a[0],d[i++]=a[0],d[i++]=a[3]):(d[i++]=a[2],d[i++]=a[2],d[i++]=a[2],d[i++]=a[3])});for(var h=0,i=0;g>h;)f[++i]=[d[h+0],d[h+1],d[h+2],d[h+3]],h+=4;var i=0;f.forEach(function(a,b,c){a[0]+a[1]+a[2]>100?(d[i++]=a[2],d[i++]=a[2],d[i++]=a[2],d[i++]=255):a[0]+a[1]+a[2]>200?(d[i++]=a[1],d[i++]=a[1],d[i++]=a[1],d[i++]=255):a[0]+a[1]+a[2]<50&&a[0]+a[1]+a[2]>400?(d[i++]=a[3],d[i++]=a[3],d[i++]=a[3],d[i++]=255):(d[i++]=a[2],d[i++]=a[2],d[i++]=a[2],d[i++]=255)});for(var h=0,i=0;g>h;)f[++i]=[d[h+0],d[h+1],d[h+2],d[h+3]],h+=4;var i=0,n=[0,0,0,0,0];f.forEach(function(a,b,c){a[0]+a[1]+a[2]>100?(n[0]++,d[i++]=c[b-19]&&c[b-19][1]||l,d[i++]=c[b+20]&&c[b+20][2]||k,d[i++]=c[b-4]&&c[b-4][0]||l,d[i++]=255):a[0]+a[1]+a[2]>200?(n[1]++,d[i++]=k,d[i++]=l,d[i++]=m,d[i++]=255):a[0]+a[1]+a[2]<50&&a[0]+a[1]+a[2]>400?(n[2]++,d[i++]=c[b+13]&&c[b+13][2]||k,d[i++]=c[b-15]&&c[b-15][0]||l,d[i++]=c[b+9]&&c[b+9][1]||k,d[i++]=255):a[0]+a[1]+a[2]>50&&a[0]+a[1]+a[2]<250?(n[3]++,d[i++]=c[b-13]&&c[b-13][2]||l,d[i++]=c[b+15]&&c[b+15][0]||l,d[i++]=c[b+4]&&c[b+4][1]||k,d[i++]=255):(n[4]++,d[i++]=c[b+7]&&c[b+7][1]||k,d[i++]=c[b+4]&&c[b+4][2]||l,d[i++]=c[b-10]&&c[b-10][0]||l,d[i++]=255)})},i.blish=function(a,b,d){for(var e=[],f=a.length,g=0,h=0;f>g;)e[++h]=[a[g+0],a[g+1],a[g+2],a[g+3]],g+=4;var h=0;e.forEach(function(a,d,e){var f=c(a);b[h]=f[2],b[h+1]=f[2],b[h+2]=f[2],b[h+3]=f[3],h+=4});for(var g=0,h=0;f>g;)e[++h]=[a[g+0],a[g+1],a[g+2],a[g+3]],g+=4;var h=0;e.forEach(function(a,c,d){a[0]+a[1]+a[2]>100?(b[h++]=a[0],b[h++]=a[0],b[h++]=a[0],b[h++]=a[3]):a[0]+a[1]+a[2]>200?(b[h++]=a[1],b[h++]=a[1],b[h++]=a[1],b[h++]=a[3]):a[0]+a[1]+a[2]<50&&a[0]+a[1]+a[2]>400?(b[h++]=a[0],b[h++]=a[0],b[h++]=a[0],b[h++]=a[3]):(b[h++]=a[2],b[h++]=a[2],b[h++]=a[2],b[h++]=a[3])});for(var g=0,h=0;f>g;)e[++h]=[a[g+0],a[g+1],a[g+2],a[g+3]],g+=4;var h=0;e.forEach(function(a,c,d){a[0]+a[1]+a[2]>100?(b[h++]=a[2],b[h++]=a[2],b[h++]=a[2],b[h++]=a[3]):a[0]+a[1]+a[2]>200?(b[h++]=a[1],b[h++]=a[1],b[h++]=a[1],b[h++]=a[3]):a[0]+a[1]+a[2]<50&&a[0]+a[1]+a[2]>400?(b[h++]=a[3],b[h++]=a[3],b[h++]=a[3],b[h++]=a[3]):(b[h++]=a[2],b[h++]=a[2],b[h++]=a[2],b[h++]=a[3])});for(var g=0,h=0;f>g;)e[++h]=[b[g+0],b[g+1],b[g+2],b[g+3]],g+=4;var h=0;e.forEach(function(a,c,d){a[0]+a[1]+a[2]<100?(b[h++]=a[0]>100&&a[0]<250?d[c-19]&&d[c-19][1]||255:d[c+13]&&d[c+13][2]||0,b[h++]=a[1]>100&&a[0]<250?d[c+20]&&d[c+20][2]||0:d[c-15]&&d[c-15][0]||255,b[h++]=a[2]>100&&a[0]<250?d[c-4]&&d[c-4][0]||255:d[c+9]&&d[c+9][1]||0,b[h++]=a[3]):a[0]+a[1]+a[2]<200?(b[h++]=255,b[h++]=255,b[h++]=255,b[h++]=a[3]):a[0]+a[1]+a[2]>50&&a[0]+a[1]+a[2]<400?(b[h++]=a[0]>100&&a[0]<250?d[c+13]&&d[c+13][2]||0:d[c-19]&&d[c-19][1]||255,b[h++]=a[1]>100&&a[0]<250?d[c-15]&&d[c-15][0]||255:d[c+20]&&d[c+20][2]||0,b[h++]=a[2]>100&&a[0]<250?d[c+9]&&d[c+9][1]||0:d[c-4]&&d[c-4][0]||255,b[h++]=a[3]):a[0]+a[1]+a[2]<50&&a[0]+a[1]+a[2]>250?(b[h++]=a[0]>100&&a[0]<250?d[c-13]&&d[c-13][2]||255:d[c-13]&&d[c-13][1]||255,b[h++]=a[1]>100&&a[1]<250?d[c+15]&&d[c+15][0]||255:d[c+15]&&d[c+15][2]||255,b[h++]=a[2]>100&&a[2]<250?d[c+4]&&d[c+4][1]||0:d[c+4]&&d[c+4][0]||0,b[h++]=a[3]):(b[h++]=d[c+7]&&d[c+7][1]||0,b[h++]=d[c+4]&&d[c+4][2]||255,b[h++]=d[c-10]&&d[c-10][0]||255,b[h++]=a[3])})},i.old_sharp=function(a,b,c){for(var d,e,f,g,h,i=c.height,j=c.width,k=0;i>k;++k)for(var l=0;j>l;++l)d=4*(k*j+l),f=a[d],g=a[d+1],h=a[d+2],e=f+g+h,e>100?(b[d]=h,b[d+1]=f,b[d+2]=g):(b[d]=g,b[d+1]=g,b[d+2]=g)},i.old_radioactive=function(a,b,c){for(var d,e,f,g,h,i=c.height,j=c.width,k=0;i>k;++k)for(var l=0;j>l;++l)d=4*(k*j+l),f=a[d],g=a[d+1],h=a[d+2],e=f+g+h,e>100?(b[d]=g,b[d+1]=g,b[d+2]=g):50>e?(b[d]=f,b[d+1]=f,b[d+2]=f):(b[d]=g,b[d+1]=f,b[d+2]=h)},i.old_colorizer=function(a,b,c){for(var d,e,f,g,h,i=c.height,j=c.width,k=0;i>k;++k)for(var l=0;j>l;++l)d=4*(k*j+l),f=a[d],g=a[d+1],h=a[d+2],e=f+g+h,(e>100||50>e)&&j>l+4?(b[d]=a[d+6],b[d+1]=a[d+10],b[d+2]=a[d+14]):(b[d]=g,b[d+1]=f,b[d+2]=h)},i.old_colorizer_high=function(a,b,c){for(var d,e,f,g,h,i=c.height,j=c.width,k=0;i>k;++k)for(var l=0;j>l;++l)d=4*(k*j+l),f=a[d],g=a[d+1],h=a[d+2],e=f+g+h,e>100&&j>l+8?(b[d]=a[d+29],b[d+1]=a[d+18],b[d+2]=a[d+4]):50>e&&j>l+10?(b[d]=a[d+14],b[d+1]=a[d+20],b[d+2]=a[d+37]):j>l+8?(b[d]=a[d+30],b[d+1]=a[d+16],b[d+2]=a[d+6]):(b[d]=f,b[d+1]=g,b[d+2]=h)},i.old_rainblo=function(a,b,c){for(var d,e,f,g,h,i=c.height,j=c.width,k=0;i>k;++k)for(var l=0;j>l;++l)d=4*(k*j+l),f=a[d],g=a[d+1],h=a[d+2],e=f+g+h,e>100&&0>l-8?(b[d]=a[d-29],b[d+1]=a[d-18],b[d+2]=a[d-4]):50>e&&0>l-10?(b[d]=a[d-14],b[d+1]=a[d-20],b[d+2]=a[d-37]):0>l-8?(b[d]=a[d-30],b[d+1]=a[d-16],b[d+2]=a[d-6]):(b[d]=f,b[d+1]=g,b[d+2]=h)},i.old_fishbowl=function(a,b,c){for(var d,e,f,g,h,i=c.height,j=c.width,k=0;i>k;++k)for(var l=0;j>l;++l)d=4*(k*j+l),f=a[d],g=a[d+1],h=a[d+2],e=f+g+h,e>100&&0>l-10&&j>l+8?(b[d]=a[d-29],b[d+1]=a[d+18],b[d+2]=a[d-40]):50>e&&0>l-5&&j>l+10?(b[d]=a[d+14],b[d+1]=a[d-20],b[d+2]=a[d+37]):(b[d]=h,b[d+1]=f,b[d+2]=g)},i.old_destabil_light=function(a,b,c){for(var d,e,f,g,h,i=c.height,j=c.width,k=0;i>k;++k)for(var l=0;j>l;++l)d=4*(k*j+l),f=a[d],g=a[d+1],h=a[d+2],e=f+g+h,e>100?(b[d]=g,b[d+1]=f,b[d+2]=h):50>e&&0>l-5&&j>l+10?(b[d]=a[d+14],b[d+1]=a[d-20],b[d+2]=a[d+46]):0>l-40&&j>l+8&&0>l-11?(b[d]=a[d+29],b[d+1]=a[d+18],b[d+2]=a[d-40]):(b[d]=f,b[d+1]=g,b[d+2]=h)},i.old_destabil_heavy=function(a,b,c){for(var d,e,f,g,h,i=c.height,j=c.width,k=0;i>k;++k)for(var l=0;j>l;++l)d=4*(k*j+l),f=a[d],g=a[d+1],h=a[d+2],e=f+g+h,e>100?(b[d]=g,b[d+1]=f,b[d+2]=h):50>e&&0>l-15&&j>l+14?(b[d]=a[d+54],b[d+1]=a[d-60],b[d+2]=a[d+37]):e>50&&0>l-14&&j>l+15?(b[d]=a[d-54],b[d+1]=a[d+60],b[d+2]=a[d+17]):0>l-11&&j>l+8?(b[d]=a[d+29],b[d+1]=a[d+18],b[d+2]=a[d-40]):(b[d]=h,b[d+1]=f,b[d+2]=g)},i.old_blainebow=function(a,b,c){for(var d,e,f,g,h,i=c.height,j=c.width,k=0;i>k;++k)for(var l=0;j>l;++l)d=4*(k*j+l),f=a[d],g=a[d+1],h=a[d+2],e=f+g+h,e>100&&0>l-20&&j>l+21?(b[d]=a[d-77],b[d+1]=a[d+82],b[d+2]=a[d-16]):50>e&&0>l-15&&j>l+14?(b[d]=a[d+54],b[d+1]=a[d-60],b[d+2]=a[d+37]):e>50&&0>l-14&&j>l+15?(b[d]=a[d-54],b[d+1]=a[d+60],b[d+2]=a[d+17]):0>l-10&&j>l+8?(b[d]=a[d+29],b[d+1]=a[d+18],b[d+2]=a[d-40]):(b[d]=h,b[d+1]=f,b[d+2]=g)},i.old_av=function(a,b,c){var e,f=a.length,g=0;for(e=d(a);f>g;)b[g]=Math.abs(a[g]-e[0]),b[g+1]=Math.abs(a[g+1]-e[1]),b[g+2]=Math.abs(a[g+2]-e[2]),g+=4},i.old_av_av=function(a,b,c){var e,f=a.length,g=0;for(e=d(a);f>g;)b[g]=Math.abs((a[g]+e[0])/2>>>0),b[g+1]=Math.abs((a[g+1]+e[1])/2>>>0),b[g+2]=Math.abs((a[g+2]+e[2])/2>>>0),g+=4},i.old_reverse_great_color=function(a,b,c){for(var d=a.length,e=0;d>e;)b[d-e]=a[e+4],b[d-e+1]=a[e+3],b[d-e+2]=a[e+4],e+=4},i.old_and_mix_great_color=function(a,b,c){for(var d=a.length,e=0;d>e;)b[e+2]=a[e+4],b[e+1]=1&e?a[e+2]:a[e-2],b[e+4]=1&e?a[e+6]:a[e-6],e+=4},i.old_and_mix_red_cyan=function(a,b,c){for(var d=a.length,e=0;d>e;)b[e]=a[e+1],b[e+1]=a[e+2],b[e+2]=1&e?a[e+1]:a[e+2],e+=4},i.old_and_mix_purple_green=function(a,b,c){for(var d=a.length,e=0;d>e;)b[e]=1&e?b[e+1]:a[e+2],b[e+1]=1&e?b[e+2]:b[e-1],b[e+2]=b[e+2],e+=4},i.old_and_mix_yellow_blue=function(a,b,c){for(var d=a.length,e=0;d>e;)b[e+1]=1&e?b[e+1]:b[e+2],b[e+2]=1&e?b[e+2]:b[e-1],e+=4},i.old_zoom_burn=function(b,c,d,e){function f(a){var b=255&a,c=a>>8&255,d=a>>16&255;return b=(b+16)%255,c=Math.abs(c-d),d=(c+d)%255,255<<24|d<<16|c<<8|b}function g(a){var b=255&a,c=a>>8&255,d=a>>16&255;return b=(b+105)%256,c=Math.abs(c-5),d=(d+1)%256,255<<24|d<<16|c<<8|b}function h(a){var b=a>>24&255,c=a>>16&255,d=a>>8&255;return b=(b+16)%256,c=Math.abs(c-d),d=(c+d)%256,b<<24|c<<16|d<<8|255}function i(a){var b=a>>24&255,c=a>>16&255,d=a>>8&255;return b=(b+105)%256,c=Math.abs(c-5),d=(d+1)%256,b<<24|c<<16|d<<8|255}var j=new Uint32Array(b.buffer),k=new Uint32Array(c.buffer),l=j.length,m=0,n=0;if(a())for(;l>n;)k[n++]=j[m],k[n++]=f(j[m]),k[n++]=g(j[m]),m++;else for(;l>n;)k[n++]=j[m],k[n++]=h(j[m]),k[n++]=i(j[m]),m++},i.old_zoom_twine=function(b,c,d,e){function f(a){var b=255&a,c=a>>8&255,d=a>>16&255;return b=(b+c)%256,c=(c+c)%256,d=(d+c)%256,255<<24|d<<16|c<<8|b}function g(a){var b=255&a,c=a>>8&255,d=a>>16&255;return b=(b+d)%256,c=Math.abs(c-b),d=(d+c)%256,255<<24|d<<16|c<<8|b}function h(a){var b=a>>24&255,c=a>>16&255,d=a>>8&255;return b=(b+c)%256,c=(c+c)%256,d=(d+c)%256,b<<24|c<<16|d<<8|255}function i(a){var b=a>>24&255,c=a>>16&255,d=a>>8&255;return b=(b+d)%256,c=Math.abs(c-b),d=(d+c)%256,b<<24|c<<16|d<<8|255}var j=new Uint32Array(b.buffer),k=new Uint32Array(c.buffer),l=j.length,m=0,n=0;if(a())for(;l>n;)k[n++]=j[m],k[n++]=f(j[m]),k[n++]=g(j[m]),m++;else for(;l>n;)k[n++]=j[m],k[n++]=h(j[m]),k[n++]=i(j[m]),m++},i.old_zoom_mash=function(b,c,d,e){function f(a){var b=255&a,c=a>>8&255,d=a>>16&255;return b=b-b/2>>>0,c=c-c/2>>>0,d=d-d/2>>>0,255<<24|d<<16|c<<8|b}function g(a){var b=255&a,c=a>>8&255,d=a>>16&255;return b=(b+b/2>>>0)%256,c=(b+b/2>>>0)%256,d=(b+b/2>>>0)%256,255<<24|d<<16|c<<8|b}function h(a){var b=a>>24&255,c=a>>16&255,d=a>>8&255;return b=b-b/2>>>0,c=c-c/2>>>0,d=d-d/2>>>0,b<<24|c<<16|d<<8|255}function i(a){var b=a>>24&255,c=a>>16&255,d=a>>8&255;return b=(b+b/2>>>0)%256,c=(b+b/2>>>0)%256,d=(b+b/2>>>0)%256,b<<24|c<<16|d<<8|255}var j=new Uint32Array(b.buffer),k=new Uint32Array(c.buffer),l=j.length,m=0,n=0;if(a())for(;l>n;)k[n++]=j[m],k[n++]=f(j[m]),k[n++]=g(j[m]),m++;else for(;l>n;)k[n++]=j[m],k[n++]=h(j[m]),k[n++]=i(j[m]),m++},i}!function(a,b,c){"use strict";function d(a){Ca.push(a)}function e(){Ca=[]}function f(a){ya=Uint8Array.from(a)}function g(a){za=Uint8Array.from(a)}function h(a){Aa=Uint8Array.from(a)}function i(a){Ba=Uint8Array.from(a)}function j(a){}function k(){var a=document.forms[0],b=document.querySelector("#ultros"),c={};return c.filename=a.imageloader.files[0].name,c.height=b.height,c.width=b.width,c.length=b.width*b.height*4,c.effect=a.effect.value,c.blend=a.blend.value,c.order=parseInt(a.order.value,10),c.channel=parseInt(a.channel.value,10),c.threshold=parseInt(a.threshold.value,10),c.depth=parseInt(a.depth.value,10),c.xspace=parseInt(a.xspace.value,10),c.yspace=parseInt(a.yspace.value,10),c.weight=parseInt(a.weight.value,10),c.stroke=parseInt(a.stroke.value,10),c.color=parseInt("ff"+a.color.value.slice(1),16),c}function l(a){return!isNaN(parseFloat(a))&&isFinite(a)}function m(a,b,c){return null===a||"number"!=typeof a||!l(a)||b>a||a>c}function n(a){return a.length<6||"string"!=typeof a||!!a.match(/[^0123456789ABCDEFabcdef]/gi)}function o(a){var d=document.forms[0],e=document.querySelector("#ultros"),a=a||{},f=!0;switch(!0){case a.filename!==d.imageloader.files[0].name:a.filename=d.imageloader.files[0].name,a.width=e.width,a.height=e.height;case null==a.effect||-1==Object.keys(b).indexOf(a.effect):a.effect="noop";case null==a.blend||-1==Object.keys(c).indexOf(a.blend):a.blend="copy";case m(a.order,0,6):a.order=0;case m(a.channel,0,7):a.channel=0;case m(a.channel,0,255):a.depth=1;case m(a.threshold,0,255):a.threshold=50;case m(a.xspace,0,255):a.xspace=10;case m(a.yspace,0,255):a.yspace=10;case m(a.weight,0,255):a.weight=5;case m(a.stroke,0,255):a.stroke=5;case n(a.color):a.color="FFFFFF";default:f=!1}}function p(a){for(var c,d=document.querySelector("#effect"),e=document.createElement("select"),f=Object.keys(b),g=0,h=f.length;h>g;++g)c=document.createElement("option"),c.value=f[g],c.text=f[g].slice(0,1).toUpperCase()+f[g].slice(1),e.add(c),c=null;d.parentNode.replaceChild(e,d),e.id="effect",e.name="effect"}function q(a){for(var b,d=document.querySelector("#blend"),e=document.createElement("select"),f=Object.keys(c),g=0,h=f.length;h>g;++g)b=document.createElement("option"),b.value=f[g],b.text=f[g].slice(0,1).toUpperCase()+f[g].slice(1),e.add(b),b=null;d.parentNode.replaceChild(e,d),e.id="blend",e.name="blend"}function r(a){var b=Da.width,c=Da.height,d=parseInt(Da.style.width.replace("px","")),e=parseInt(Da.style.height.replace("px",""));e+=Math.round(.1*c),Da.style.height=e+"px",d+=Math.round(.1*b),Da.style.width=d+"px"}function s(a){var b=Da.width,c=Da.height,d=parseInt(Da.style.width.replace("px","")),e=parseInt(Da.style.height.replace("px",""));e-=Math.round(.1*c),Da.style.height=e+"px",d-=Math.round(.1*b),Da.style.width=d+"px"}function t(a){var b=document.querySelector("#bablyos"),c=b.width,d=b.height,e=parseInt(b.style.width.replace("px","")),f=parseInt(b.style.height.replace("px",""));f+=Math.round(.1*d),b.style.height=f+"px",e+=Math.round(.1*c),b.style.width=e+"px"}function u(a){var b=document.querySelector("#babylos"),c=b.width,d=b.height,e=parseInt(b.style.width.replace("px","")),f=parseInt(b.style.height.replace("px",""));f-=Math.round(.1*d),b.style.height=f+"px",e-=Math.round(.1*c),b.style.width=e+"px"}function v(){var a=Da.width,b=Da.height;Da.style.width=a+"px",Da.style.height=b+"px"}function w(a){var d=document.querySelector("#ultros"),e=d.width,f=d.height,g=Ea.getImageData(0,0,e,f),h=g.data;if(void 0==ya||0==ya.length||void 0==za||0==za.length)return void j("No image data available");for(var i=0,k=Ca.length;k>i;++i){switch(o(Ca[i]),Ca[i].order){case 0:b[Ca[i].effect](ya,za,Ca[i]),c[Ca[i].blend](za,ya,Ca[i]);break;case 1:b[Ca[i].effect](za,ya,Ca[i]),c[Ca[i].blend](ya,za,Ca[i]);break;case 2:b[Ca[i].effect](ya,ya,Ca[i]);break;case 3:b[Ca[i].effect](za,za,Ca[i]);break;case 4:b[Ca[i].effect](Aa,ya,Ca[i]);break;case 5:b[Ca[i].effect](Aa,za,Ca[i]),c[Ca[i].blend](za,ya,Ca[i]);break;case 6:b[Ca[i].effect](Ba,za,Ca[i]),c[Ca[i].blend](za,ya,Ca[i]);default:b[Ca[i].effect](ya,za,Ca[i])}a()}for(var i=0,l=h.length;l>i;++i)h[i]=ya[i];Ea.putImageData(g,0,0)}function x(a,b){
for(var c=document.createElement("h3"),d=document.createElement("p"),e=document.createElement("p"),f=document.querySelector("#canvasstats"),g=f.cloneNode();g.firstChild;)g.removeChild(g.firstChild);c.innerText=document.querySelector("#imageloader").files[0].name,d.innerText="Height: "+b+"px",e.innerText="Width: "+a+"px",g.appendChild(c),g.appendChild(d),g.appendChild(e),f.parentNode.replaceChild(g,f),f=null}function y(){for(var a=document.querySelector("#queue"),b=document.createDocumentFragment(),c=Object.keys(k()),d=0,e=Ca.length;e>d;++d){var f,g,h,i,j=document.createElement("section"),l=document.createElement("figure"),m=document.createElement("figure"),n=document.createElement("p"),o=document.createElement("p"),p=document.createTextNode(">"),q=p.cloneNode(),r=document.createElement("button"),s=document.createTextNode("Delete"),t=document.createElement("button"),u=document.createTextNode("Edit"),v=document.createElement("div"),w=document.createElement("div"),x=document.createElement("dl");j.setAttribute("class","queue-wrap"),w.setAttribute("class","card"),v.setAttribute("class","card-action"),l.setAttribute("class","card-front"),m.setAttribute("class","card-back"),n.setAttribute("class","flip-button"),o.setAttribute("class","flip-button"),t.setAttribute("class","edit-queue"),r.setAttribute("class","delete-queue");for(var y=Ca[d],z=0,A=c.length;A>z;++z){var B=c[z];h=document.createElement("dt"),i=document.createElement("dd"),j.dataset[B]=y[c[z]],f=document.createTextNode(B[0].toUpperCase()+B.slice(1)),g=document.createTextNode(y[c[z]]),h.appendChild(f),i.appendChild(g),x.appendChild(h),x.appendChild(i)}n.appendChild(p),o.appendChild(q),l.appendChild(n),l.appendChild(x),m.appendChild(o),m.appendChild(v),t.appendChild(u),v.appendChild(t),r.appendChild(s),v.appendChild(r),w.appendChild(l),w.appendChild(m),j.appendChild(w),b.appendChild(j)}for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(b)}function z(a,b){var c=[];return c[0]=200,c[1]=Math.round(b/(a/200)),c}function A(){var a=document.querySelector("#ultros"),b=document.querySelector("#imagebar");a.toBlob(function(c){var d,e,f,g,h,i;e="glitcher"+(new Date).toISOString().slice(17,19)+Math.random().toString().slice(2)+".png";var j=document.createElement("a");j.setAttribute("data-saved","false"),h=a.height,i=a.width,f=z(i,h);var k=new Image;k.width=f[0],k.height=f[1],k.setAttribute("class","glitched-image"),d=a.toDataURL("image/png"),g=URL.createObjectURL(c),j.setAttribute("href",d),j.setAttribute("download",e),k.setAttribute("src",d),k.src=g,j.appendChild(k);var l,m,n,o,p,q,r,s,t,u,v,w,x;l=document.createElement("section"),l.setAttribute("class","img-wrap"),l.setAttribute("style","height:"+f[1]+"px; width:"+f[0]+"px;"),m=document.createElement("div"),m.setAttribute("class","card"),n=document.createElement("figure"),n.setAttribute("class","card-front"),o=document.createElement("figure"),o.setAttribute("class","card-back"),o.setAttribute("style","background: linear-gradient(rgba(0, 0, 0, 0.45), rgba(255, 16, 116, 0.45) ), url("+g+") no-repeat 50% 50%;"),u=document.createTextNode(">"),v=u.cloneNode(),p=document.createElement("p"),p.setAttribute("class","flip-button"),q=document.createElement("p"),q.setAttribute("class","flip-button"),r=document.createElement("div"),r.setAttribute("class","card-action"),x=document.createTextNode("Download"),s=document.createElement("button"),s.setAttribute("class","download-img"),w=document.createTextNode("Delete"),t=document.createElement("button"),t.setAttribute("class","delete-img"),s.appendChild(x),r.appendChild(s),t.appendChild(w),r.appendChild(t),p.appendChild(u),n.appendChild(p),n.appendChild(j),q.appendChild(v),o.appendChild(q),o.appendChild(r),m.appendChild(n),m.appendChild(o),l.appendChild(m),b.appendChild(l)})}function B(){var a=document.createElement("section");Array.prototype.forEach.call(document.forms[0],function(b){var c=b.type;switch(!0){case"range"===c:D(b,a);break;case"color"===c:C(b,a)}}),document.querySelector("#options").appendChild(a)}function C(a,b){var c=document.createElement("div"),d=document.createElement("label"),e=document.createElement("div"),f=document.createElement("div"),g=a.name,h=a.value;c.setAttribute("class","input-wrap"),d.setAttribute("for",g+"-div"),d.setAttribute("id",g+"-div-label"),d.setAttribute("class","div-label"),d.setAttribute("role","label"),d.innerText=g.slice(0,1).toUpperCase()+g.slice(1)+": "+h,e.setAttribute("role","input"),e.setAttribute("class","colorpicker"),e.setAttribute("name",g+"-div"),e.setAttribute("id",g+"-div"),e.dataset.type="color",e.dataset.value=h,f.setAttribute("class","color-thumb"),c.appendChild(d),e.appendChild(f),c.appendChild(e),b.appendChild(c)}function D(a,b){var c=document.createElement("div"),d=document.createElement("label"),e=document.createElement("div"),f=document.createElement("div"),g=a.name,h=a.value;c.setAttribute("class","input-wrap"),d.setAttribute("for",g+"-div"),d.setAttribute("id",g+"-div-label"),d.setAttribute("class","div-label"),d.setAttribute("role","label"),d.innerText=g.slice(0,1).toUpperCase()+g.slice(1)+": "+h,e.setAttribute("role","input"),e.setAttribute("class","range"),e.setAttribute("name",g+"-div"),e.setAttribute("id",g+"-div"),e.dataset.type="range",e.dataset.min=a.min,e.dataset.max=a.max,e.dataset.step=a.step,e.dataset.value=h,f.setAttribute("class","range-thumb"),c.appendChild(d),e.appendChild(f),c.appendChild(e),b.appendChild(c)}function E(a,b,c){var d=a/(b/c)||.1;return d}function F(a,b,c,d){var e=d/E(a,b,c);return e}function G(a,b){var c=a.replace("-div","");document.querySelector("#"+a+"-label").innerText=c.slice(0,1).toUpperCase()+c.slice(1)+": "+b}function H(a,b){var c=document.forms[0];c[a].value=b}function I(a,b){function c(){d=f[e].value,g.setAttribute("data-value",d),a.style="background-color:"+d+";",G(g.id,d),f[e].removeEventListener("change",c,!1)}var d,e,f=document.forms[0],g=a.parentNode;e=g.id.replace("-div",""),f[e].addEventListener("change",c,!1),f.color.click(b)}function J(a,b){var c,d,e,f=a.children[0];e=a.getBoundingClientRect(),d=b.x-e.left,c=parseFloat((Math.round(F(e.width,parseFloat(a.dataset.max),parseFloat(a.dataset.step),d))*a.dataset.step).toPrecision(2)),f.style.width=d+"px",f.innerText=d+" "+c,a.setAttribute("data-value",c),G(a.id,c),H(a.id.replace("-div",""),c)}function K(a,b){var c,d,e,f=a.parentNode;e=f.getBoundingClientRect(),d=b.x-e.left,c=parseFloat((Math.round(F(e.width,parseFloat(f.dataset.max),parseFloat(f.dataset.step),d))*f.dataset.step).toPrecision(2)),a.style.width=d+"px",a.innerText=d+" "+c,f.setAttribute("data-value",c),G(f.id,c),H(f.id.replace("-div",""),c)}function L(a,b,c){var d=document.querySelector(b),e=a.target.files[0],f=new FileReader;e?e.type.match("image.*")?(f.onload=function(a){var b=new Image;b.onload=function(){c(d,b)},b.src=a.target.result},f.readAsDataURL(e)):j(e.name+" is not a valid image file."):j("Failed to load file")}function M(a,b){var c,d=a.getContext("2d"),e=b.width,i=b.height;a.width=e,a.height=i,a.style.width=b.width+"px",a.style.height=b.height+"px",x(e,i),d.drawImage(b,0,0),c=d.getImageData(0,0,e,i),f(c.data),g(ya),h(ya),V(),la()}function N(a,b){var c,d=a.getContext("2d"),e=document.querySelector("#ultros"),f=b.height,g=b.width;a.height=e.height,a.width=e.width,d.drawImage(b,0,0,g,f,0,0,e.width,e.height),c=d.getImageData(0,0,a.width,a.height),i(c.data),V()}function O(a){for(var b,c=(a.target,document.forms[0]),d=a.target;d.toString().match(/svg/gi);)d=d.parentNode;d.classList.contains("box")&&(b=d.dataset.effect,c.effect.value=b)}function P(a){for(var b,c=(a.target,document.forms[0]),d=a.target;d.toString().match(/svg/gi);)d=d.parentNode;d.classList.contains("box")&&(b=d.dataset.blend,c.blend.value=b)}function Q(a){var b,c;b="#"+(a.dataset.toggle||a.parentNode.dataset.toggle),c=document.querySelector(b),c.classList.toggle("hidden")}function R(a){var b,c;b="#"+(a.dataset.hide||a.parentNode.dataset.hide),c=document.querySelector(b),c.classList.toggle("expand")}function S(a){var b=document.querySelector(a);b.classList.toggle("hidden")}function T(a){var b=a.target;b.classList.add("active")}function U(){btnBar=document.querySelector(".button-bar"),btn.querySelector(".active")&&btn.querySelector(".active").classList.remove("active")}function V(){S("#loader")}function W(a){a.preventDefault(),a.stopPropagation();var b=a.target.parentNode.parentNode;b.classList.contains("flipped")?b.classList.remove("flipped"):b.classList.add("flipped")}function X(b){var c=b.target,d=c.parentNode.parentNode.parentNode.parentNode,e=d.querySelector("img");(d.dataset.saved||a.confirm("Are you sure you want to delete this image?"))&&(URL.revokeObjectURL(e.src),d.parentNode.removeChild(d))}function Y(a){var b=a.target,c=b.parentNode.parentNode.parentNode.parentNode;c.querySelector("img");c.dataset.saved||(c.dataset.saved=!0),c.querySelector("a").click()}function Z(){for(var a=document.querySelector("#imagebar");a.firstElementChild;)a.firstElementChild.querySelector("img")&&(URL.revokeObjectURL(a.firstElementChild.querySelector("img").src),URL.revokeObjectURL(a.firstElementChild.querySelector("a").href)),a.removeChild(a.firstElementChild)}function $(a){V(),L(a,"#ultros",M)}function _(a){V(),L(a,"#bablyos",N)}function aa(a){r(),t()}function ba(a){s(),u()}function ca(a){a.preventDefault(),a.stopPropagation();var b=k();d(b),y(b)}function da(){V(),e(),U()}function ea(a){a.preventDefault(),a.stopPropagation(),V(),w(da)}function fa(a){a.preventDefault(),a.stopPropagation();var b=k();b.order=0,V(),T(a),d(b),y(b),w(da)}function ga(a){a.preventDefault(),a.stopPropagation();var b=k();b.order=5,b.effect="copy",b.blend="copy",V(),d(b),y(b),w(da)}function ha(a){a.preventDefault(),a.stopPropagation();var b=k();b.order=5,b.effect="copy",V(),d(b),y(b),w(da)}function ia(a){a.preventDefault(),a.stopPropagation();var b=k();b.order=6,V(),d(b),y(b),w(da)}function ja(a){a.preventDefault(),a.stopPropagation(),A()}function ka(){V(),S("#info")}function la(){S("#filechooser"),S("#effects")}function ma(){S("#effects"),S("#blends")}function na(){S("#blends")}function oa(a){a.preventDefault(),a.stopPropagation();var b=a.target;(b.dataset.toggle||b.parentNode.dataset.toggle)&&Q(b),(b.dataset.hide||b.parentNode.dataset.hide)&&R(b)}function pa(a){a.preventDefault(),a.stopPropagation();var b=a.target,c=b.id;switch(!0){case"filebutton"===c:document.querySelector("#imageloader").click();break;case"samplebutton"===c:document.querySelector("#sampleloader").click()}}function qa(a){a.preventDefault(),a.stopPropagation();var b=a.target;b.id;switch(!0){case b.classList.contains("range"):J(b,a);break;case b.parentNode.classList.contains("range"):K(b,a);break;case b.classList.contains("color-thumb"):I(b,a)}}function ra(a){var b=a.target,c=b.classList;switch(!0){case c.contains("img-wrap"):break;case c.contains("card"):break;case c.contains("card-front"):break;case c.contains("card-back"):break;case c.contains("flip-button"):W(a);break;case c.contains("delete-img"):X(a);break;case c.contains("download-img"):Y(a)}}function sa(a){var b=a.target,c=b.classList;switch(!0){case c.contains("queue-wrap"):break;case c.contains("card"):break;case c.contains("card-front"):break;case c.contains("card-back"):break;case c.contains("flip-button"):W(a);break;case c.contains("delete-queue"):break;case c.contains("edit-queue"):}}function ta(a,b){for(var c=a.target;c.toString().match(/svg/gi);)c=c.parentNode;c.classList.contains("box")&&(c.classList.contains("selected")?c.classList.toggle("selected"):(c.parentNode.querySelector(".selected")&&c.parentNode.querySelector(".selected").classList.toggle("selected"),c.classList.toggle("selected")),b())}function ua(a){ta(a,ma),O(a)}function va(a){ta(a,na),P(a)}function wa(){p(),q(),B(),document.querySelector("#toggle").addEventListener("mouseup",oa,!0),document.querySelector("#filechooser").addEventListener("mouseup",pa,!1),document.querySelector("#options").addEventListener("mouseup",qa,!1),document.querySelector("#imagebar").addEventListener("mouseup",ra,!1),document.querySelector("#queue").addEventListener("mouseup",sa,!1),document.querySelector("#effects").addEventListener("mouseup",ua,!1),document.querySelector("#blends").addEventListener("mouseup",va,!1),document.querySelector("#imageloader").addEventListener("change",$,!1),document.querySelector("#sampleloader").addEventListener("change",_,!1),document.querySelector("#zi").addEventListener("mouseup",aa,!1),document.querySelector("#zo").addEventListener("mouseup",ba,!1),document.querySelector("#q").addEventListener("mouseup",ca,!1),document.querySelector("#p").addEventListener("mouseup",ia,!1),document.querySelector("#s").addEventListener("mouseup",ja,!1),document.querySelector("#r").addEventListener("mouseup",ea,!1),document.querySelector("#i").addEventListener("mouseup",fa,!1),document.querySelector("#d").addEventListener("mouseup",ga,!1),document.querySelector("#b").addEventListener("mouseup",ha,!1),ka()}function xa(){var b=a.confirm("You have unsaved images, are you sure you want to exit?");if(b){var c=document.querySelector("#main");for(document.querySelector("#toggle").removeEventListener("mouseup",oa,!1),document.querySelector("#filechooser").removeEventListener("mouseup",pa,!1),document.querySelector("#options").removeEventListener("mouseup",qa,!1),document.querySelector("#imagebar").removeEventListener("mouseup",ra,!1),document.querySelector("#queue").removeEventListener("mouseup",sa,!1),document.querySelector("#effects").removeEventListener("mouseup",ua,!1),document.querySelector("#blends").removeEventListener("mouseup",va,!1),document.querySelector("#imageloader").removeEventListener("change",$,!1),document.querySelector("#sampleloader").removeEventListener("change",_,!1),document.querySelector("#zi").removeEventListener("mouseup",aa,!1),document.querySelector("#zo").removeEventListener("mouseup",ba,!1),document.querySelector("#q").removeEventListener("mouseup",ca,!1),document.querySelector("#p").removeEventListener("mouseup",ia,!1),document.querySelector("#s").removeEventListener("mouseup",ja,!1),document.querySelector("#r").removeEventListener("mouseup",ea,!1),document.querySelector("#i").removeEventListener("mouseup",fa,!1),document.querySelector("#d").removeEventListener("mouseup",ga,!1),document.querySelector("#b").removeEventListener("mouseup",ha,!1),Z();c.firstElementChild;)c.removeChild(c.firstElementChild)}}var ya,za,Aa,Ba,Ca=[],Da=(document.querySelector("#imageloader"),document.querySelector("#ultros")),Ea=Da.getContext("2d");document.querySelector("#canvasstats");HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(a,b,c){for(var d=atob(this.toDataURL(b,c).split(",")[1]),e=d.length,f=new Uint8Array(e),g=0;e>g;g++)f[g]=d.charCodeAt(g);a(new Blob([f],{type:b||"image/png"}))}}),a.resetQueue=e,a.toggleLoader=V,a.zoomOutCanvas=s,a.zoomInCanvas=r,a.zoomReset=v,a.teardown=xa,a.onload=wa,a.onunload=xa}(window,effectsCode(),blendsCode());
//# sourceMappingURL=videoglitcher.min.js.map/*! Attribution-NonCommercial 3.0 by Josef Aguilar */